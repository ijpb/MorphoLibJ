#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass scrreprt
\begin_preamble
\PassOptionsToPackage{usenames,dvipsnames}{xcolor}

\usepackage[usenames,dvipsnames]{xcolor}

%\usepackage{lstlinebgrd}
\usepackage[T1]{fontenc}

\usepackage{hyperref}


\definecolor{bl}{rgb}{0.0,0.2,0.6} 

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{lightgray}{rgb}{0.95,0.95,0.95}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\hypersetup{colorlinks=true, citecolor=blue, linkcolor=blue}


% package that modifies style of section headers
\addtokomafont{chapter}{\color{bl}\scshape \selectfont}
\addtokomafont{section}{\color{bl}\scshape \selectfont}
\addtokomafont{subsection}{\color{bl}\scshape \selectfont}
\addtokomafont{subsubsection}{\color{bl}\scshape \selectfont}
%\allsectionsfont{\color{bl}\scshape \selectfont }

% setup font style for different title elements
\setkomafont{title}{\color{bl} \bfseries \scshape}
\setkomafont{author}{\centering \small}
\setkomafont{date}{\centering \small}


% Change the abstract environment
\usepackage[runin]{abstract}			% runin option for a run-in title
\setlength\absleftindent{30pt}		% left margin
\setlength\absrightindent{30pt}		% right margin
\abslabeldelim{\quad }						% 
\setlength{\abstitleskip}{-10pt}
\renewcommand{\abstractname}{}
\renewcommand{\abstracttextfont}{\color{bl} \small \slshape }	% slanted text



% Custom headers and footers
\usepackage{fancyhdr}
% Enabling the custom headers/footers
\pagestyle{fancy}
\usepackage{lastpage}	
% Header (empty)
% left side of the header - page g : chapter (sl), page d : page (bf) - plain : nothing
\lhead[\fancyplain{}{\slshape\leftmark}]{\fancyplain{}{}}
% nothing in the center
\chead{}
% right side of the header - page g : page (bf), page d : section (sl) - plain : nothing
\rhead[\fancyplain{}{}]{\fancyplain{}{\slshape\rightmark}}

% Footer (you may change this to your own needs)
\lfoot{\footnotesize MorphoLibJ user manual}
\cfoot{}
\rfoot{\footnotesize page \thepage\ / \pageref{LastPage}}	% "Page 1 / 2"
\renewcommand{\headrulewidth}{0.0pt}
\renewcommand{\footrulewidth}{0.4pt}

% left chapter no number, nothing on the right
%\renewcommand{\chaptermark}[1]{\markboth{\textit{#1}}{}}
\renewcommand{\chaptermark}[1]{\markboth{\thechapter\ #1}{}}
% right section with number
\renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}
% Added by lyx2lyx
\usepackage[charter]{mathdesign}

% setup of figure captions 
\usepackage[format=plain,font=it,labelfont=bf]{caption}
%\captionsetup[figure]{name=Figure}
%\DeclareCaptionLabelSeparator{colon}{.}

% To add mini-TOC in the beginning of each chapter
% The 'nohints' option is to prevent a conflict with the lastpage package, 
% resulting in an extra empty page at the end of the document.
\usepackage[nohints]{minitoc}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "beramono" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format pdf2
\output_sync 0
\bibtex_command default
\index_command default
\float_placement h
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_title "MorphoLibJ user manual"
\pdf_author "David Legland and Ignacio Arganda-Carreras"
\pdf_keywords "ImageJ, mathematical morphology, image segmentation, image analysis"
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize a4paper
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 1
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle plain
\bullet 2 0 10 -1
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
lstset{numbers=left, tabsize=2, frame=single, breaklines=true, basicstyle=
\backslash
scriptsize
\backslash
ttfamily, aboveskip=5pt}
\end_layout

\begin_layout Plain Layout


\backslash
lstset{language=java, keywordstyle=
\backslash
bfseries, commentstyle=
\backslash
color{OliveGreen}
\backslash
itshape, stringstyle=
\backslash
color{BrickRed}, showspaces=false}
\end_layout

\end_inset


\end_layout

\begin_layout Title
MorphoLibJ user manual
\end_layout

\begin_layout Author
David Legland, Ignacio Arganda-Carreras
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
dominitoc 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Abstract
The 
\begin_inset Quotes cld
\end_inset

MorphoLibJ
\begin_inset Quotes crd
\end_inset

 library for ImageJ/Fiji contains a variety of plugins for processing and
 analyzing 2D or 3D images.
 It was originally designed for the study of plant cell images, but the
 algorithms are generic and can be applied to any type of image.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Some conventions:
\end_layout

\begin_layout Itemize
use american english
\end_layout

\begin_layout Itemize
use 
\begin_inset Quotes eld
\end_inset

grayscale images
\begin_inset Quotes erd
\end_inset

 (instead of gray level) 
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Overview
\end_layout

\begin_layout Standard
The library implements several functionalities that were missing in the
 ImageJ software (
\begin_inset CommandInset citation
LatexCommand citet
key "Schneider_2012_nmeth,Schindelin_2012_nmeth"
literal "true"

\end_inset

), and that were not or only partially covered by other plugins.
 
\end_layout

\begin_layout Itemize

\series bold
morphological filtering
\series default
 for 2D/3D and binary or grayscale images: erosion & dilation, closing &
 opening, morphological gradient & Laplacian, top-hat...
\end_layout

\begin_layout Itemize

\series bold
morphological reconstruction
\series default
, for 2D/3D and binary or grayscale images, allowing fast detection of regional
 or extended extrema, removing of borders, or hole filling
\end_layout

\begin_layout Itemize

\series bold
watershed segmentation
\series default
 + GUI, making it possible to segment 2D/3D images of cell tissues
\end_layout

\begin_layout Itemize

\series bold
2D/3D measurements
\series default
: volume, surface area, bounding boxes, equivalent ellipse/ellipsoid...
\end_layout

\begin_layout Itemize

\series bold
several utilities
\series default
 for the manipulation of binary and label images
\end_layout

\begin_layout Standard
The home page of the project is located at 
\begin_inset CommandInset href
LatexCommand href
target "http://ijpb.github.io/MorphoLibJ/"
literal "false"

\end_inset

, and the source code can be found on GitHub: 
\begin_inset CommandInset href
LatexCommand href
target "http://github.com/ijpb/MorphoLibJ"
literal "false"

\end_inset

.
 The exhaustive code documentation includes many use-case examples, and
 can be found online
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://ijpb.github.io/MorphoLibJ/javadoc/
\end_layout

\end_inset


\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
The reference publication for MorphoLibJ is 
\begin_inset CommandInset citation
LatexCommand citet
key "Legland_2016_bioinformatics"
literal "true"

\end_inset

.
\end_layout

\begin_layout Chapter
Installation instructions
\end_layout

\begin_layout Section
Installation in ImageJ
\end_layout

\begin_layout Standard
To install the MorphoLibJ toolkit in ImageJ, you only need to download the
 latest release (in the form of a JAR file) into ImageJ's plugins folder
 and restart ImageJ.
 
\end_layout

\begin_layout Standard
All released versions can be found at 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://github.com/ijpb/MorphoLibJ/releases
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Section
Installation in Fiji
\end_layout

\begin_layout Standard
If you use Fiji (
\begin_inset CommandInset citation
LatexCommand citet
key "Schindelin_2012_nmeth,Schneider_2012_nmeth"
literal "true"

\end_inset

), the MorphoLibJ toolkit can be easily installed by adding its update site
 to Fiji's list of update sites:
\end_layout

\begin_layout Enumerate
Open Fiji and select 
\emph on
Help > Update...

\emph default
 from the Fiji menu to start the updater.
\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename images/Fiji-updater-menu.png
	width 75text%

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Enumerate
When the updater is open, click on 
\emph on
Manage update sites
\emph default
.
\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename images/Fiji-updater-GUI.png
	width 75text%

\end_inset


\end_layout

\begin_layout Enumerate
This brings up a dialog where you can activate additional update sites:
\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename images/Fiji-updater-sites-manager.png
	width 75text%

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Enumerate
Activate the MorphoLibJ update site and close the dialog.
 Now you should see an additional jar file for download:
\begin_inset Newline newline
\end_inset


\begin_inset Graphics
	filename images/Fiji-updater-MorphoLibJ-jar.png
	width 75text%

\end_inset


\end_layout

\begin_layout Enumerate
Finally, click on 
\emph on
Apply changes
\emph default
 and restart Fiji.
 All the plugins should be available after restarting.
\end_layout

\begin_layout Chapter
Definitions and data types
\end_layout

\begin_layout Standard
This chapter recalls some principles from the ImageJ software, summarizes
 the vocabulary and definitions used within the library, and presents some
 generic concepts about image processing and associated data structures.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Digital images
\end_layout

\begin_layout Standard
Digital images may be defined by a mapping from a pair 
\begin_inset Formula $(i,j)$
\end_inset

 of integer coordinates to a value.
 The value may be an integer, a floating point number, a color...
 Image elements are usually refered to as 
\begin_inset Quotes eld
\end_inset


\series bold
pixels
\series default

\begin_inset Quotes erd
\end_inset

, for 
\begin_inset Quotes eld
\end_inset

picture element
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Subsection
Data types
\end_layout

\begin_layout Standard
Images are usually represented as 2D arrays of elementary data types.
 Within ImageJ, the pixels may be of different types, according to the bit
 depth:
\end_layout

\begin_layout Itemize
8-bits images contains pixels with (positive) integer values between 
\begin_inset Formula $0$
\end_inset

 and 
\begin_inset Formula $255$
\end_inset

.
\end_layout

\begin_layout Itemize
16-bits images contains pixels with (positive) integer values between 
\begin_inset Formula $0$
\end_inset

 and 
\begin_inset Formula $2^{16}=65536$
\end_inset

.
\end_layout

\begin_layout Itemize
24-bits images corresponds to
\series bold
 color images
\series default
.
 Pixels are represented as triplet of red, green and blue components, each
 of them ranging between 0 and 255.
\end_layout

\begin_layout Itemize
32-bits images contains pixels with floating-points values, possibly negative.
\end_layout

\begin_layout Standard
Note that other software may use additionnal data type for representation
 of images, such as 32-bits integers, complex values, booleans...
\end_layout

\begin_layout Subsection
Image types
\end_layout

\begin_layout Standard
Apart from the data type / bit depth, image data may be interpreted in different
 ways.
 The MorphoLibJ library focusses on the following image types:
\end_layout

\begin_layout Description
grayscale
\begin_inset space ~
\end_inset

images contains pixels with positive integer values.
 They can correspond to either 8-bits or 16-bits images.
\end_layout

\begin_layout Description
binary
\begin_inset space ~
\end_inset

images are expected to contain only two possible values.
 Within ImageJ, they are represented as 8-bits images containing only two
 values: 0 for the background, and 255 for the foreground (See chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Binary-Images"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 
\end_layout

\begin_layout Description
intensity
\begin_inset space ~
\end_inset

images may correspond to any types that can be interpreted as a single scalar
 value.
 They can be represented with 8-bits, 16-bits, or 32-bits images.
 
\end_layout

\begin_layout Description
label
\begin_inset space ~
\end_inset

images (also called 
\series bold
label maps
\series default
) contains values that can be interpreted as the label or index of a region
 (See chapter
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:label-images"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 The label 0 usually refer to the background (i.e., no region).
 Label images can be represented using 8-bits, 16-bits, or 32-bits images.
 Binary images can be seen as a special case of label images that contain
 only one label.
\end_layout

\begin_layout Subsection
3D images
\end_layout

\begin_layout Standard
Most algorithms from mathematical morphology (and more generally, many image
 processing algorithms) extends naturally from two dimensions to three dimension
s.
 Within ImageJ, 3D images are represented as 
\begin_inset Quotes eld
\end_inset


\series bold
image stacks
\series default

\begin_inset Quotes erd
\end_inset

, seen as stacks of 2D arrays.
 Elements of a 3D image are usually refered to as 
\begin_inset Quotes eld
\end_inset


\series bold
voxels
\series default

\begin_inset Quotes erd
\end_inset

, for volumetric picture element.
 
\end_layout

\begin_layout Section
Digital connectivity
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Digital-Connectivity"

\end_inset


\end_layout

\begin_layout Standard
When reconstructing structures or regions from digital images, it is often
 necessary to define an 
\series bold
adjacency relationship
\series default
, or 
\series bold
connectivity
\series default
, between pixels of voxels 
\begin_inset CommandInset citation
LatexCommand citep
key "Rosenfeld_1970_ACM,Serra_1982,Kong_1989_CVGIP,Soille_2003"
literal "false"

\end_inset

.
 The notion of connectivity determines the result of many algorithms such
 as connected component labeling (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Connected-Components-Labeling"
plural "false"
caps "false"
noprefix "false"

\end_inset

), or the result of image quantification based on Euler number (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Digital-Euler-Number"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Subsection
2D connectivities
\end_layout

\begin_layout Standard
For planar images, typical choices are the 4- and the 8-connectivities.
 The 4-connectivity considers only the orthogonal neighbors of a given pixel
 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Digital-connectivities-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

-a).
 The 8-connectivity also considers the diagonal pixels (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Digital-connectivities-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

-b).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/connectivity2D_C4.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
4-connectivity
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/connectivity2D_C8.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
8-connectivity
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Digital-connectivities-2D"

\end_inset

Digital connectivities for 2D images
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The discrete nature of images results in potential problems when considering
 geometric properties on reconstructed structures.
 A typical example is the Jordan curve theorem, which states than any curve
 of the plane that do not self-intersects divides the plane into exactly
 two regions: one interior and one exterior (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Jordan-Curve-Theorem"
plural "false"
caps "false"
noprefix "false"

\end_inset

-a).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/JordanCurve_continuous.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Continuous curve
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/JordanCurve_C4.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Digital curve using the 4-adjacency
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Jordan-Curve-Theorem"

\end_inset

Jordan curve theorem in continuous plane and in digital plane.
 The digitization of a 4-connected curve results in the creation of two
 inner regions that are not 4-connected.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
When choosing a digital connectivity and considering reconstructed curves,
 the theorem is not always true, as a 4-connected curve may create several
 disconnected interior regions (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Jordan-Curve-Theorem"
plural "false"
caps "false"
noprefix "false"

\end_inset

-b).
 The common solution is to consider pairs of adjacencies, one for the foreground
 (here the curve), and one for the background.
 One can check that the two interior regions are 8-connected, making the
 Jordan curve theorem valid for the (4,8)-adjacency pair.
\end_layout

\begin_layout Subsection
3D connectivities
\end_layout

\begin_layout Standard
In 3D, two connectivities are commonly used.
 The 6-connectivity considers only orthogonal neighbors of the center voxel
 along the three principal directions (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Digital-connectivities-3D"
plural "false"
caps "false"
noprefix "false"

\end_inset

-a).
 The 26-connectivity considers all the possible neighbors within a 
\begin_inset Formula $3\times3\times3$
\end_inset

 cube centered around the reference voxel (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Digital-connectivities-3D"
plural "false"
caps "false"
noprefix "false"

\end_inset

-b).
 As for the 2D case, one often considers pairs of complementary adjacencies
 for the foreground and for the background 
\begin_inset CommandInset citation
LatexCommand citep
key "Kong_1989_CVGIP,Ohser2009"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/connectivity3D_C6.png
	width 25text%

\end_inset


\begin_inset Graphics
	filename images/connectivity/connectivity3D_C26.png
	width 25text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Digital-connectivities-3D"

\end_inset

Digital connectivities for 3D images
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Morphological filtering
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:Morphological-Filtering"

\end_inset


\end_layout

\begin_layout Standard
Morphological filters are very common filters that can be combined together
 to provide large variety of solutions.
 They are local filters, in the sense they consider the neighborhood of
 each pixel/voxel.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Principles
\end_layout

\begin_layout Standard
The original idea was to define a methodology to describe shapes by using
 another shape as test probe 
\begin_inset CommandInset citation
LatexCommand citep
key "Serra_1982,Serra_1992_cssp"
literal "true"

\end_inset

.
 The test probe is usually referred to as 
\series bold
structuring element
\series default
.
 Common structuring element include squares, discrete disks and octagons.
 Linear structuring element of various orientations may also be used to
 assess local orientation of the structures.
 
\end_layout

\begin_layout Standard
The most basic morphological operators are the 
\series bold
morphological dilation
\series default
 and the 
\series bold
morphological erosion
\series default
.
 The principle of morphological dilation is to test for each point of the
 plane, if the structuring element centred on this point 
\series bold
intersects
\series default
 the structure of interest (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Principle-Dilation-Erosion"

\end_inset

).
 It results in a set larger than the original set.
 
\end_layout

\begin_layout Standard
The principle of morphological erosion is to test for each point of the
 plane if the structuring element centred on this point 
\series bold
is contained
\series default
 within the original set.
 It results in a set smaller than original set.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binarySet/binary-set.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Binary set X and structuring element B
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binarySet/binary-dilation-principle.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Dilation of X by B
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binarySet/binary-erosion-principle.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Erosion of X by B
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Principle-Dilation-Erosion"

\end_inset

Principle of morphological dilation and erosion on a binary set, using a
 disk-shaped structuring element.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Morphological dilation and erosion change the size and the resulting set.
 It may also change its topology: after a dilation, components may merge
 and holes be filled.
 After an erosion, components may disappear, or components be separated
 into several parts.
\end_layout

\begin_layout Section
Grayscale morphological filters
\end_layout

\begin_layout Standard
While originally defined for binary sets, morphological operators are of
 great interest when applied to grayscale images.
 They can be easily be applied for noise reduction (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Opening-Closing"

\end_inset

), detection of boundary structures (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Morphological-Gradient"

\end_inset

), or background removal (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Top-hats"

\end_inset

).
\end_layout

\begin_layout Subsection
Grayscale erosion and dilation
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Erosion-Dilation"

\end_inset


\end_layout

\begin_layout Standard
Morphological erosion and dilation may also be applied on grayscale images.
 In that case, the morphological dilation computes for each pixel the maximum
 within its neighborhood (defined by the structuring element), whereas the
 morphological erosion considers the minimum value within the neighborhood
 (Fig
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morpho-Dilation-Erosion"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-Dilation-Sq2.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Morphological dilation
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-Erosion-Sq2.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Morphological erosion
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Morpho-Dilation-Erosion"

\end_inset

Some examples of morphological filters on a grayscale image.
 Original image, result of dilation with a square structuring element, and
 result of erosion with the same structuring element.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Applying a  dilation or an erosion changes the size of the structures in
 the image: the grains in the result of the dilated image are larger.
 As for binary sets, these operations may also merge, separate, or make
 disappear some components of the image.
\end_layout

\begin_layout Subsection
Opening and closing
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Opening-Closing"

\end_inset


\end_layout

\begin_layout Standard
Morphological dilation and erosion are often used in combination for 
\series bold
removing noise within images
\series default
.
 For example, the result of a dilation followed by an erosion is called
 a 
\series bold
morphological closing
\series default
, and removes dark structures smaller than the structuring element (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morpho-Opening-Closing"

\end_inset

-b).
 It can also connect bright structures that were separated by a thin dark
 space.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains.png
	width 30text%

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-Closing-Sq2.png
	width 30text%

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Morphological closing
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-Opening-Sq2.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Morphological opening
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Morpho-Opening-Closing"

\end_inset

Grayscale morphological closing and opening.
 (a) Original image.
 (b) Result of morphological closing.
 (c) Result of morphological opening.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In a symmetric way, the result of an erosion followed by a dilation is called
 a 
\series bold
morphological
\series default
 
\series bold
opening
\series default
, and removes bright structures smaller than the structuring element (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morpho-Opening-Closing"

\end_inset

-c).
 
\end_layout

\begin_layout Standard
Note that even if opening and closing preserve the size of the structures
 in the original image, their shape is slightly altered.
 For example, the morphological closing on Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morpho-Opening-Closing"

\end_inset

-b creates artificial connections between grains, whereas the morphological
 opening (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morpho-Opening-Closing"

\end_inset

-c) tends to remove sharp corners of the grains.
 Choosing the best size for the structuring element is often a compromise
 between noise removal and preservation of shape structure.
 In some cases, attribute filtering operators (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Attribute-Filtering"

\end_inset

) may provide better results than morphological filters.
\end_layout

\begin_layout Standard
Morphological opening and closing are also often used as
\series bold
 post-processing
\series default
 operators to enhance segmentation results (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Post-Processing"

\end_inset

).
 Segmentation operators such as thresholding often results in many small
 components not corresponding to the structures of interest (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Post-Processing"

\end_inset

-b).
 Many holes may also be present within the structures.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/maizeBundles/m02g_crop.png
	lyxscale 50
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/maizeBundles/m02g_crop_seg_border.png
	lyxscale 50
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Raw segmentation
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/maizeBundles/m02g_crop_seg-Closing-border.png
	lyxscale 50
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Morphological closing
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/maizeBundles/m02g_crop_seg-Closing-Opening-border.png
	lyxscale 50
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Morphological opening
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Morphological-Post-Processing"

\end_inset

Enhancing segmentation with morphological filters.
 (a) Original image representing a section of maize tissue.
 (b) Binarisation by thresholding (inverted LUT).
 (c) Morphological closing removes most holes within the bundles (inverted
 LUT).
 (d) Morphological opening removes small dirts outside of vascular bundles
 (inverted LUT).
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The application of a morphological closing on the binary images allows to
 consolidate the structures of interest by removing small holes within them
 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Post-Processing"

\end_inset

-c).
 Then, a morphological opening removes the small particles that do not correspon
d to the vascular bundles (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Post-Processing"

\end_inset

-d).
 The result is a binary image showing only the vascular bundles.
\end_layout

\begin_layout Subsection
Morphological gradients
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Morphological-Gradient"

\end_inset


\end_layout

\begin_layout Standard
More complicated combinations of elementary operations can be used.
 The 
\series bold
morphological gradient
\series default
 (also known as the 
\series bold
Beucher gradient
\series default
) is obtained as the difference of the result of a morphological dilation
 with the result of a morphological erosion, both computed with the same
 structuring element.
 It reveals the 
\series bold
boundaries
\series default
 of the structures within the image (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morpho-Gradient"

\end_inset

-a).
 When applied to a binary image, the morphological gradient is a convenient
 way to obtain the boundaries of the structures of interest within the image
 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morpho-Gradient"

\end_inset

-b).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-Gradient-Sq2.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Morphological gradient
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/maizeBundles/m02g_crop_seg-Closing-Opening-Closing-Gradient.png
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Morphological gradient on a
\begin_inset Newline newline
\end_inset

binary image
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-Laplacian-Sq2.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Morphological Laplacian
\end_layout

\end_inset


\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Morpho-Gradient"

\end_inset

Some examples of morphological filters resulting from the combination of
 elementary morphological filters.
 (a) Morphological gradient on a grayscale image.
 (b) Morphological gradient on the binary image represented in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Post-Processing"

\end_inset

-d (inverted LUT).
 (c) Morphological Laplacian on a grayscale image.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
morphological Laplacian
\series default
 is defined as half the sum of a morphological dilation and a morphological
 erosion with the same structuring element, minus the original image.
 It results in enhancing the edges of the image (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morpho-Gradient"

\end_inset

-c).
 
\end_layout

\begin_layout Subsection
Top-hats
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Top-hats"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
white top-hat 
\series default
operator first computes a morphological opening (resulting in removing bright
 structures smaller than structuring elements), and removes the result from
 the original image.
 When applied with a large structuring element, the result is an homogenization
 of the background, making bright structures easier to segment (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:White-TopHat-Grains"

\end_inset

-c).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains_roiVLine.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-WhiteTopHat-Sq20_roiVLine.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
White Top-Hat
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-compareTopHatProfiles.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Profile plots along 
\begin_inset Newline newline
\end_inset

vertical line
\end_layout

\end_inset


\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:White-TopHat-Grains"

\end_inset

Top-hat filtering.
 (a) Original grayscale image, showing inhomogeneous background.
 (b) Result of the White Top-Hat operator using square with radius 20 as
 structuring element.
 (c) Profile plots along line region of interest for each image.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Similarly, the 
\series bold
dark top-hat
\series default
 can be used to enhance dark structures observed on an non-homogeneous backgroun
d.
\end_layout

\begin_layout Section
Directional filters
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Directional-Filters"

\end_inset


\end_layout

\begin_layout Standard
For images containing very thin curvilinear structures (for example blood
 vessels, cell wall sections...), the application of common filters may be
 difficult due to the small size of the structures.
 Even for small structuring elements, the application of a morphological
 opening or closing let the structure disappear (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Thin-Structure-Filtering"

\end_inset

-b, 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Thin-Structure-Filtering"

\end_inset

-c).
 Moreover, it may be difficult to preserve the whole thickness of the structure.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/appleCells/appleCells.tif
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/appleCells/appleCells-smooth2.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Gaussian filtering
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/appleCells/appleCells-median2.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Median filtering
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/appleCells/appleCells-Cl-DirFiltOp_L21_ND12.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Directional filtering
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Thin-Structure-Filtering"

\end_inset

Filtering of a thin structure.
 (a) Original image representing apple cells observed with confocal microscopy
 
\begin_inset CommandInset citation
LatexCommand citep
key "Legland2009"
literal "true"

\end_inset

.
 The application of a Gaussian filter (b) or median filter (c) results in
 noise reduction, but also in a loss of the signal along the cell walls.
 The directional filtering (d) better preserves the thickness of the structure.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
An alternative is to apply directional filtering.
 The principle is to consider an oriented structuring element such as a
 line segment of a given length, and to perform morphological operations
 for various orientations of the structuring element 
\begin_inset CommandInset citation
LatexCommand citep
key "Soille2001,Heneghan_2002_mia,LuengoHendriks2003"
literal "true"

\end_inset

.
 For example, applying a median filter or a morphological opening with horizonta
l direction results in the enhancement of horizontal parts of bright structures
 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Directional-Filtering"

\end_inset

-a).
 Similarly, using a vertical structuring element results in the enhancement
 of the vertical portions of the structures (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Directional-Filtering"

\end_inset

-b).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/appleCells/appleCells-Cl-Op_L21_T000.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Horizontal direction
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/appleCells/appleCells-Cl-Op_L21_T090.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Vertical direction
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/appleCells/appleCells-Cl-DirFiltOp_L21_ND2.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Two directions
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/appleCells/appleCells-Cl-DirFiltOp_L21_ND4.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Four directions
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Directional-Filtering"

\end_inset

Principle of directional filtering of a thin structure.
 (a) and (b): result of median filter using an horizontal and a vertical
 linear structuring element.
 (c) and (d): combination of the results obtained from two directions (horizonta
l and vertical) and four directions (by adding diagonal directions).
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The results of oriented filters for each direction can be combined by computing
 the maximum value over all orientations (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Thin-Structure-Filtering"

\end_inset

-d).
 Figures
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Directional-Filtering"

\end_inset

-c and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Directional-Filtering"

\end_inset

-d show the results obtained when combining two or four directions.
 Here, 32 orientations of line with length 25 were used.
 This results in the enhancement of the image while preserving the thickness
 of the bright structures.
\end_layout

\begin_layout Standard
Similar results may be obtained for enhancing dark curvilinear structures,
 by using morphological closing or median filters, and combining the results
 by computing the minimum over all directions.
 
\end_layout

\begin_layout Section
Plugin Usage
\end_layout

\begin_layout Standard
The collection of morphological filters is available in the 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ
\begin_inset Quotes erd
\end_inset

 menu.
 Filters are implemented for both 2D and 3D images, and work for binary,
 grayscale or color (RGB) images.
\end_layout

\begin_layout Subsection
Planar images
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Morphological-Filters"

\end_inset


\end_layout

\begin_layout Standard
Morphological filters for planar images are available 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Morphological filters
\begin_inset Quotes erd
\end_inset

.
 The dialog let the user choose the structuring element shape, radius, and
 eventually preview the result.
 The following operations can be chosen:
\end_layout

\begin_layout Description
erosion keeps the minimum value within the neighborhood defined by the structuri
ng element.
\end_layout

\begin_layout Description
dilation keeps the maximum value within the neighborhood defined by the
 structuring element.
\end_layout

\begin_layout Description
closing consists in the succession of a dilation with an erosion.
 Morphological closing makes dark structures smaller than the structuring
 element disappear.
\end_layout

\begin_layout Description
opening consists in the succession of an erosion with a dilation.
 Morphological opening makes bright structures smaller than the structuring
 element disappear.
\end_layout

\begin_layout Description
morphological
\begin_inset space ~
\end_inset

gradient is defined as the difference of a morphological dilation and a
 morphological erosion with the same structuring element, and enhances edges
 of the original images.
\end_layout

\begin_layout Description
morphological
\begin_inset space ~
\end_inset

Laplacian is defined as half the sum of a morphological dilation and a morpholog
ical erosion with the same structuring element, minus the original image,
 and enhances edges of the image.
\end_layout

\begin_layout Description
black
\begin_inset space ~
\end_inset

top-hat consists in subtracting the original image from the result of a
 morphological closing, and results in the enhancement of dark structures
 smaller than structuring element.
\end_layout

\begin_layout Description
white
\begin_inset space ~
\end_inset

top-hat consists in subtracting the result of a morphological opening from
 the original image, and results in the enhancement of bright structures
 smaller than structuring element.
\end_layout

\begin_layout Standard
The following structuring elements can be used for 2D images:
\end_layout

\begin_layout Itemize
disk 
\end_layout

\begin_layout Itemize
square
\end_layout

\begin_layout Itemize
octagon
\end_layout

\begin_layout Itemize
diamond
\end_layout

\begin_layout Itemize
line with angle of 0, 90, 45 or 135 degrees
\end_layout

\begin_layout Subsection
3D images
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Morphological-Filters-3D"

\end_inset


\end_layout

\begin_layout Standard
Morphological filters for 3D images are available under 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Morphological filters (3D)
\begin_inset Quotes erd
\end_inset

.
 The dialog let the user choose the structuring element shape and radius.
 The same list of operations as for planar images is provided.
 Planar structuring elements can be used (the operation is simply repeated
 on each slice), as well as a cubic or spherical structuring element.
 For most structuring elements, the size can be chosen for each direction.
\end_layout

\begin_layout Subsection
Directional Filters
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Directional-Filters"

\end_inset


\end_layout

\begin_layout Standard
Directional filtering is available from 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Directional Filtering
\begin_inset Quotes erd
\end_inset

.
 It requires a planar image.
 
\end_layout

\begin_layout Standard
The parameters are:
\end_layout

\begin_layout Description
Type to specify how to combine the results for each oriented filter
\end_layout

\begin_layout Description
Operation the operation to apply using each oriented structuring element
\end_layout

\begin_layout Description
Line
\begin_inset space ~
\end_inset

Length the approximated length of the structuring element.
 
\end_layout

\begin_layout Description
Direction
\begin_inset space ~
\end_inset

Number the number of oriented structuring elements to consider.
 To be increased if the length of line is large.
\end_layout

\begin_layout Chapter
Connected components operators
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:Connected-Operators"

\end_inset


\end_layout

\begin_layout Standard
The 
\begin_inset Quotes eld
\end_inset

classical
\begin_inset Quotes erd
\end_inset

 morphological filters presented in chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Morphological-Filtering"

\end_inset

 transform an input image by using the values of pixels or voxels located
 in a close neighborhood, defined by the structuring element.
 Such filters can be seen as 
\begin_inset Quotes eld
\end_inset

local
\begin_inset Quotes erd
\end_inset

, as the result in a given position does not depend on image values located
 at a sufficient distance.
 
\end_layout

\begin_layout Standard
Connected components operators are more general as they propagate information
 within the image based on connectivity between pixels or voxels.
 More details can be found in the review of 
\begin_inset CommandInset citation
LatexCommand citet
key "Breen_1996_cviu"
literal "true"

\end_inset

.
 Connected components operators encompass powerful operators, such as 
\series bold
morphological reconstruction
\series default
 that allows to reconstruct a marker image by constraining it to a mask
 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Morphological-Reconstruction"

\end_inset

).
 An extension of morphological reconstruction is the detection of 
\series bold
extended minima and maxima
\series default
, that can be useful as marker detection for segmentation (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Minima-Maxima"

\end_inset

).
 Finally, 
\series bold
attribute opening and filtering
\series default
 algorithms can filter images based on size or range properties, with better
 preservation of edges than classical filtering (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Attribute-Filtering"

\end_inset

).
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Morphological reconstruction
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Morphological-Reconstruction"

\end_inset


\end_layout

\begin_layout Standard
The morphological reconstruction is at the basis of many useful algorithms,
 such as border removing, hole filling, or detection of regional minima
 or maxima in grayscale images.
 It may be defined for binary as well as for grayscale images.
\end_layout

\begin_layout Subsection
Principle
\end_layout

\begin_layout Standard
The principle of morphological reconstruction canbe illustrated by applying
 
\series bold
conditional dilations or erosions
\series default
 until idempotence.
 Conditional dilation is the result of a dilation, combined with a mask
 image using a logical operation.
 Conditional dilations are repeated until no more modification occur (idempotenc
e condition).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/particles-Markers-ovr.png
	width 3cm

\end_inset


\begin_inset Graphics
	filename images/binary/particles-condDil01-ovr.png
	width 3cm

\end_inset


\begin_inset Graphics
	filename images/binary/particles-condDil02-ovr.png
	width 3cm

\end_inset


\begin_inset Graphics
	filename images/binary/particles-condDil03-ovr.png
	width 3cm

\end_inset


\begin_inset Graphics
	filename images/binary/particles-condDilIdemp-ovr.png
	width 3cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Morphological-Reconstruction-Principle"

\end_inset

Principle of the morphological reconstruction algorithm.
 Original image is represented in gray, with marker and result of conditional
 dilations with increasing sizes superimposed in black.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Reconstruction-Principle"

\end_inset

 shows several steps of a morphological reconstruction by dilation on a
 pair of binary images.
 The mask image is shown in gray, and the marker image is shown in black
 on the first image.
 The reconstructed images at each step are shown in black.
 The markers propagates within the mask until an additional conditional
 dilation will not modify the image any more.
 The result is the set of regions that contains the markers, with the same
 shape as in the original image.
\end_layout

\begin_layout Standard
In practice, morphological reconstruction is often implemented using more
 efficient algorithms based on queues, by a adding pixels or voxels to the
 queue based on the connectivity with processed elements (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Digital-Connectivity"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Subsection
Applications to binary images
\end_layout

\begin_layout Standard
By choosing the marker image, several operations may be automatized.
 For example, computing morphological reconstruction with image of borders,
 and combining with original image will 
\series bold
remove particles or regions touching the borders
\series default
 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Reconstruction-Binary"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/particles.tif
	width 4cm

\end_inset


\begin_inset Graphics
	filename images/binary/particles-killBorders.png
	width 4cm

\end_inset


\begin_inset Graphics
	filename images/binary/particles-fillHoles.png
	width 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Morphological-Reconstruction-Binary"

\end_inset

Some applications of morphological reconstruction.
 From left to right: original image, result of kill borders, result of fill
 holes.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In a similar way, computing morphological reconstruction by using the border
 of the complement of the image makes it possible to 
\series bold
fill holes
\series default
 that may appear in particles.
\end_layout

\begin_layout Subsection
Applications to grayscale images
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Morphological-Reconstruction-Grayscale"

\end_inset


\end_layout

\begin_layout Standard
Morphological reconstructions can be applied to grayscale images.
 By manually choosing binary markers such that they overlay specific structures,
 and after applying a Morphological reconstruction by dilation, it is possible
 to obtain a grayscale image containing only the chosen structures (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Reconstruction-Grayscale"

\end_inset

).
 The algorithms for morphological reconstruction on grayscale images are
 discussed in 
\begin_inset CommandInset citation
LatexCommand citet
key "Vincent_1993_tip,Robinson_2004_prl"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-binary-markers-ovr.png
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/grains/grains-geodRec-byDilation.png
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/grains/grains-killBorders.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Morphological-Reconstruction-Grayscale"

\end_inset

Some applications of morphological reconstruction on grayscale images.
 From left to right: original image with markers superimposed in red, result
 of morphological reconstruction by dilation, result of border kill operation.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
border kill 
\series default
operation can also be applied on grayscale images, making possible to rapidly
 remove structures touching the image borders, while keeping the intensity
 information within the structures.
\end_layout

\begin_layout Subsection
Application to the segmentation of chromocenters in a 3D image
\end_layout

\begin_layout Standard
An example of application is presented in figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Reconstruction-Grayscale-3d"

\end_inset

.
 The original 3D image represents the nucleus of a plant cell, with chromocenter
s appearing as bright structures (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Reconstruction-Grayscale-3d"

\end_inset

-a).
 In order to discriminate the chromocenters, the nucleus is first identified
 by manually selecting a region of interest (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Reconstruction-Grayscale-3d"

\end_inset

-b) used as a marker for a morphological reconstruction with the original
 image used as mask.
 The result of the morphological reconstruction retains the shape of the
 nucleus, while 
\begin_inset Quotes eld
\end_inset

clearing
\begin_inset Quotes erd
\end_inset

 the bright chromocenters (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Reconstruction-Grayscale-3d"

\end_inset

-c).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/nucleus/nucleus-gray8-z14.png
	height 3.5cm

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/nucleus/nucleus-gray8-z14-ovr.png
	height 3.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/nucleus/nucleus-geodRec-BG-z14.png
	height 3.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/nucleus/nucleus-subtract-geoRec-BG-z14-adjHist.png
	height 3.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/nucleus/nucleus-geodRecBG-3d3.png
	lyxscale 50
	height 3.5cm

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Morphological-Reconstruction-Grayscale-3d"

\end_inset

Application of 3D morphological reconstruction for isolating chromocenters
 within a nucleus.
 (a) Sample slice of a 3 image of nucleus with chromocenters represented
 as bright blobs.
 (b) Manual selection of a marker region within the nucleus.
 (c) Morphological reconstruction of 3D marker image using original 3D image
 as mask.
 (d) Difference of original image with the reconstruction.
 (e) 3D representation of the chromocenters within the nucleus.
 Image by courtesy of Kaori Sakai and Javier Arpon, INRA-Versailles.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
By computing the difference of the original image with the result of the
 morphological reconstruction, the chromocenters can be easily isolated
 and segmented (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Reconstruction-Grayscale-3d"

\end_inset

-d).
 
\end_layout

\begin_layout Subsection
Usage
\end_layout

\begin_layout Standard
The  reconstruction algorithm is often used within other operators.
 It is however provided as a plugin to allow its inclusion in user-designed
 macros or plugins:
\end_layout

\begin_layout Minisec
Morphological
\begin_inset space ~
\end_inset

Reconstruction 
\end_layout

\begin_layout Standard
Computes the  reconstruction by erosion or dilation using a marker image
 and a mask image, and a specified connectivity.
 
\end_layout

\begin_layout Minisec
Interactive
\begin_inset space ~
\end_inset

Morphological
\begin_inset space ~
\end_inset

Reconstruction
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Interactive-Morphological-Reconstruction"

\end_inset

Computes the  reconstruction by erosion or dilation taking the current 2D
 image as mask image, creating the marker image out of user-defined ROIs
 (for example with the point selection tool) and using a specified connectivity.
 The plugin allows previewing the result.
\end_layout

\begin_layout Minisec
Morphological
\begin_inset space ~
\end_inset

Reconstruction
\begin_inset space ~
\end_inset

3D 
\end_layout

\begin_layout Standard
Computes the  reconstruction by erosion or dilation on a 3D image (marker
 and mask images are defined by the user among the open ones).
\end_layout

\begin_layout Minisec
Interactive
\begin_inset space ~
\end_inset

Morphological
\begin_inset space ~
\end_inset

Reconstruction
\begin_inset space ~
\end_inset

3D
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Interactive-Morphological-Reconstruction-3d"

\end_inset

Computes the  reconstruction by erosion or dilation on using the current
 3D image as mask and creating the marker image from the user-defined point
 selections.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
The kill borders and fill holes operations are also provided as plugins.
 Both work for 2D and 3D images of 8, 16 or 32 bit-depth images.
\end_layout

\begin_layout Minisec
Kill
\begin_inset space ~
\end_inset

Borders 
\end_layout

\begin_layout Standard
Removes the particles touching the border of a binary or grayscale image.
 See also the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[op:Remove-Border-Labels]{Remove Border Labels Plugin}
\end_layout

\end_inset

 (Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "op:Remove-Border-Labels"
plural "false"
caps "false"
noprefix "false"

\end_inset

), that performs the same operation on label maps but without requiring
 reconstruction.
\end_layout

\begin_layout Minisec
Fill Holes 
\end_layout

\begin_layout Standard
Removes holes inside particles in binary images, or remove dark regions
 surrounded by bright crests in grayscale images.
\end_layout

\begin_layout Section
Regional and extended extrema
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Minima-Maxima"

\end_inset


\end_layout

\begin_layout Standard
Minima and maxima within images are important features because they often
 correspond to relevant structures within the image.
 In mathematical morphology, the terms minima and maxima correspond to regions,
 i.e.
 they are not restricted to single pixels or voxels.
\end_layout

\begin_layout Subsection
Regional minima and maxima
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Regional-Extrema"

\end_inset


\end_layout

\begin_layout Standard

\series bold
Regional minima 
\series default
are defined as connected regions of elements (pixels or voxels) with the
 same value, and whose neighboring elements all have values greater than
 that of the region.
 Similarly, 
\series bold
regional maxima 
\series default
are regions of connected pixels or voxels with the same value, and whose
 neighbors all have smaller value (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Regional-Maxima"

\end_inset

).
 In both cases, the result depends on the choice of the connectivity of
 the regions (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Digital-Connectivity"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-filtered-roiVLine.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-rmax-ovr.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Regional maxima
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-filtered-rmax-profile.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Profile of gray levels
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Regional-Maxima"

\end_inset

Regional maxima on a grayscale image.
 (a) Original image with a line ROI superimposed.
 (b) Result of regional maxima, showing many spurious maxima.
 (c) Gray-level profile along the line ROI shown in (a).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
MorphoLibJ uses the algorithm described in 
\begin_inset CommandInset citation
LatexCommand citet
key "Breen_1996_cviu"
literal "false"

\end_inset

 for computing regional minima and maxima.
\end_layout

\begin_layout Subsection
Extended minima and maxima
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Extended-Extrema"

\end_inset


\end_layout

\begin_layout Standard
One problem arising with regional minima or maxima is that they are very
 sensitive to noise.
 It is often more convenient to use so-called 
\series bold
extended extrema
\series default
, that allows filtering spurious extrema.
 
\end_layout

\begin_layout Standard
Extended minima and maxima are based on the 
\series bold
H-extrema transformations
\series default
, that remove extrema based on a contrast criterium denoted by 
\begin_inset Formula $h$
\end_inset

.
 For example, the H-maxima transformation of a function 
\begin_inset Formula $f$
\end_inset

 is obtained by performing a morphological reconstruction by dilation of
 the function 
\begin_inset Formula $f-h$
\end_inset

 (the marker) constrained by the original function 
\begin_inset Formula $f$
\end_inset

 (the mask).
 Extended maxima are obtained by computing the regional maxima of the reconstruc
tion result.
 An illustration on a 1D signal is provided on Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Extended-Maxima-1D"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/reconstruction/extendedMaxima.png
	width 60text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Extended-Maxima-1D"

\end_inset

Computation of extended maxima on a 1D function.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For images, 
\series bold
extended maxima
\series default
 are defined as a connected region containing elements such that the difference
 of the value of each element within the region with the maximal value within
 the region is lower than the tolerance, and such that the neighbors of
 the regions all have values smaller than the maximum within the region
 minus the tolerance.
 This definition allows the identification of larger extrema, that better
 takes into account the noise within the image (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Extended-Maxima"

\end_inset

).
 The 
\series bold
extended minima 
\series default
are defined in a similar way, and are efficiently used as pre-processing
 step for watershed segmentation.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-filtered-roiVLine.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-emax10-ovr.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Extended maxima
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-filtered-emax10-profile.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Profile of gray levels
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Extended-Maxima"

\end_inset

Extended maxima on a grayscale image.
 (a) Original image with a line ROI superimposed.
 (b) Result of extended maxima computed with a dynamic of 10.
 (c) Gray-level profile along the line ROI shown in (a).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Both extended maxima and minima are computed using the morphological reconstruct
ion algorithm.
 More details can be found in the book of 
\begin_inset CommandInset citation
LatexCommand citet
key "Soille_2003"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsection
Minima or maxima imposition
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Extrema-Imposition"

\end_inset


\end_layout

\begin_layout Standard
It is sometimes useful to transform an input grayscale image by 
\series bold
imposing minima or maxima 
\series default
specified by a binary image.
 Such process is at the basis of watershed-based morphological segmentation
 (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Morphological-Segmentation-Plugin"

\end_inset

).
 
\end_layout

\begin_layout Standard
The principle is to perform a morphological reconstruction using as a marker
 image a combination of the input image and the minima or maxima, and as
 mask image the original input image.
 The result is a grayscale image whose regional minima or maxima are the
 same as the specified ones.
\end_layout

\begin_layout Subsection
Plugins usage
\end_layout

\begin_layout Standard
The following operations are available in the 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Minima and Maxima
\begin_inset Quotes erd
\end_inset

 menu :
\end_layout

\begin_layout Minisec
Regional
\begin_inset space ~
\end_inset

Min
\begin_inset space ~
\end_inset

/
\begin_inset space ~
\end_inset

Max
\end_layout

\begin_layout Standard
Computes regional minima or extrema in grayscale or binary image, with specified
 connectivity
\end_layout

\begin_layout Minisec
Regional
\begin_inset space ~
\end_inset

Min
\begin_inset space ~
\end_inset

/
\begin_inset space ~
\end_inset

Max
\begin_inset space ~
\end_inset

3D 
\end_layout

\begin_layout Standard
Computes regional minima or extrema in 3D grayscale or binary image, with
 specified connectivity
\end_layout

\begin_layout Minisec
Extended
\begin_inset space ~
\end_inset

Min
\begin_inset space ~
\end_inset

/
\begin_inset space ~
\end_inset

Max
\end_layout

\begin_layout Standard
Computes extended minima or extrema in grayscale or binary image, with specified
 connectivity
\end_layout

\begin_layout Minisec
Extended
\begin_inset space ~
\end_inset

Min
\begin_inset space ~
\end_inset

/
\begin_inset space ~
\end_inset

Max
\begin_inset space ~
\end_inset

3D
\end_layout

\begin_layout Standard
Computes extended minima or extrema in 3D grayscale or binary image, with
 specified connectivity
\end_layout

\begin_layout Minisec
Impose
\begin_inset space ~
\end_inset

Min
\begin_inset space ~
\end_inset

/
\begin_inset space ~
\end_inset

Max
\end_layout

\begin_layout Standard
Imposes binary minima or maxima on a grayscale image.
\end_layout

\begin_layout Minisec
Impose
\begin_inset space ~
\end_inset

Min
\begin_inset space ~
\end_inset

/
\begin_inset space ~
\end_inset

Max
\begin_inset space ~
\end_inset

3D
\end_layout

\begin_layout Standard
Imposes binary minima or maxima on a 3D grayscale image.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Attribute filtering
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Attribute-Filtering"

\end_inset


\end_layout

\begin_layout Standard
Attribute filters aim at removing components of an image based on a certain
 size criterion, rather than on intensity.
 The most common and useful criterion is the number of pixels/voxels (i.e.,
 the area or volume).
 For example, a size opening operation with a threshold value equal to 20
 will remove all blobs containing fewer than 20 voxels.
 The length of the diagonal of the bounding box can also be of interest
 to discriminate elongated versus round component shapes.
 
\end_layout

\begin_layout Subsection
Application to binary images
\end_layout

\begin_layout Standard
When applied to a binary image, attribute opening consists in identifying
 each connected component, computing the attribute measurement of each component
, and retain only the connected components whose measurement is above a
 specified value (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Area-Opening-Binary"

\end_inset

).
 This kind of processing is often used to clean-up segmentation results.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-binary-crop-ext.png
	width 31text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-binary-crop-lbl-ext.png
	width 31text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Connected components
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-binary-crop-lbl-sizeOpening-ext.png
	width 31text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Size opening
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Area-Opening-Binary"

\end_inset

Example of area opening on a binary image.
 (a) Original binary image.
 (b) Identification of connected components.
 (c) Only the connected components with a sufficient size (defined by the
 area), have been retained.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Application to grayscale images
\end_layout

\begin_layout Standard
When applied to a grayscale image, attribute opening consists in generating
 a series of binary images by thresholding at each distinct gray level in
 the image.
 The binary attribute opening described above is then applied independently
 to each binary image and the grayscale output is computed as the union
 of the binary results.
 The final output is a grayscale image whose bright structures with the
 attribute below a given value have disappeared.
 A great advantage of this filter is that the contours of the structures
 area better preserved than opening with a structuring element (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Area-Opening-Gray"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/leaf/leaf_crop400.tif
	width 31text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/leaf/leaf_crop400-areaOpen.png
	width 31text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Area opening
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/leaf/leaf_crop400-OpeningSq1.png
	width 31text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Morphological opening
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Area-Opening-Gray"

\end_inset

Example of area opening on a grayscale image.
 (a) Original grayscale image of a leaf (image courtesy of Eric Biot, INRA
 Versailles).
 (b) Grayscale size opening making bright spots disappear.
 (c) Comparison with morphological closing using a square structuring element
 of radius 1: bright spots are removed, but some veins also disappear.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
As for classical morphological filters, grayscale attribute closing or tophat
 can be defined.
 Grayscale attribute closing consists in removing dark connected components
 whose size is smaller than a specified value.
 White [resp.
 Black] Attribute Top-Hat considers the difference of the attribute opening
 [resp.
 closing] with the original image, and can help identifying bright [resp.
 dark] structures with small size.
\end_layout

\begin_layout Subsection
Usage
\end_layout

\begin_layout Standard
So far, the following attribute filtering plugins are available within MorphoLib
J (under 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ
\begin_inset Quotes erd
\end_inset

):
\end_layout

\begin_layout Description
Gray
\begin_inset space ~
\end_inset

Scale
\begin_inset space ~
\end_inset

Attribute
\begin_inset space ~
\end_inset

Filtering opens a dialog to perform between attribute opening, closing,
 and black or white top-hat on a planar (2D) grayscale image.
 Two size criteria can be used: the area (number of pixels), or the diameter
 (length of the diagonal of the bounding box).
\end_layout

\begin_layout Description
Gray
\begin_inset space ~
\end_inset

Scale
\begin_inset space ~
\end_inset

Attribute
\begin_inset space ~
\end_inset

Filtering
\begin_inset space ~
\end_inset

3D opens a dialog to perform between attribute opening, closing, and black
 or white top-hat on a 3D grayscale image.
 The size criterion is the number of voxels.
\end_layout

\begin_layout Chapter
Watershed segmentation
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:Watershed-segmentation"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
watershed algorithm
\series default
 assimilates the grayscale image to a digital elevation model, and aims
 at detecting the different catchment basins.
 In the grayscale image, the catchment basins correspond to dark regions
 surrounded by bright structures (the 
\begin_inset Quotes eld
\end_inset

crests
\begin_inset Quotes erd
\end_inset

).
 It is a very popular technique specially used to segment touching objects.
 The MorphoLibJ suite contains several implementations and applications
 of the algorithm, described in the following sections.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Classic Watershed plugin
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Classic-Watershed"

\end_inset


\end_layout

\begin_layout Subsection
Introduction
\end_layout

\begin_layout Standard
Classic Watershed is an ImageJ/Fiji plugin to perform watershed segmentation
 of grayscale 2D/3D images using flooding simulations as described by 
\begin_inset CommandInset citation
LatexCommand citet
key "Soille_1990,Vincent_1991_pami"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
The basic idea consists of considering the input image as topographic surface
 and placing a water source in each regional minimum of its relief.
 Next the entire relief is flooded from the sources and dams are placed
 where the different water sources meet.
\end_layout

\begin_layout Standard
All points in the surface at a given minimum constitute the 
\series bold
catchment basin
\series default
 associated with that minimum.
 The 
\series bold
watersheds
\series default
 are the zones dividing adjacent catchment basins.
\end_layout

\begin_layout Standard
The first image points that are reached by water are the points at the lowest
 grayscale value 
\begin_inset Formula $h_{{min}}$
\end_inset

, then all image pixels are progressively reached up to the highest level
 
\begin_inset Formula $h_{{max}}$
\end_inset

 (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Schematic-overview-of-flooding"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/watershed-flooding-scheme.pdf
	lyxscale 50
	width 40text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Schematic-overview-of-flooding"

\end_inset

Schematic overview of watershed flooding in 1D
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Usage
\end_layout

\begin_layout Standard
The Classic Watershed plugin runs on any grayscale image (8, 16 and 32-bit)
 in 2D and 3D.
 At least one image needs to be open in order for the plugin to run.
 If that's the case, a dialog like the following will pop up: 
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename images/Classic-Watershed-dialog.png
	width 30text%

\end_inset


\end_layout

\begin_layout Standard
Let's have a look at the different parameters:
\end_layout

\begin_layout Itemize
Image parameters: 
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Input image
\series default
: grayscale image to flood, usually the gradient of an image.
 
\end_layout

\begin_layout Itemize

\series bold
Mask image
\series default
 (optional): binary image of the same dimensions as the input image which
 can be used to restrict the areas of application of the algorithm.
 Set to "None" to run the method on the whole input image.
\end_layout

\end_deeper
\begin_layout Itemize
Morphological parameters: 
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Use diagonal connectivity
\series default
: select to allow the flooding in diagonal directions (8-connectivity in
 2D and 26-connectivity in 3D, see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Digital-Connectivity"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 
\end_layout

\begin_layout Itemize

\series bold
Min h
\series default
: minimum grayscale value to start flooding from (by default, set to the
 minimum value of the image type).
 
\end_layout

\begin_layout Itemize

\series bold
Max h
\series default
: maximum grayscale value to reach with flooding (by default, set to the
 maximum value of the image type).
\end_layout

\end_deeper
\begin_layout Standard
Output: 
\end_layout

\begin_layout Itemize

\series bold
Labeled image
\series default
 containing the resulting catchment basins (with integer values 1, 2, 3...)
 and watershed lines (with 0 value).
\end_layout

\begin_layout Subsection
Over-segmentation
\end_layout

\begin_layout Standard
Normally, Classic Watershed will lead to an over-segmentation of the input
 image, especially for noisy images with many regional minima.
 In that case, it is recommended to either 
\series bold
pre-process the image before
\series default
 running the plugin, 
\series bold
or merge regions based on a similarity criterion afterwards
\series default
.
 Several de-noising methods are available in Fiji/ImageJ, namely: median
 filtering, Gaussian blur, bilateral filtering, etc.
\end_layout

\begin_layout Paragraph

\series bold
Example:
\end_layout

\begin_layout Standard
This short macro runs the plugin twice in the blobs sample, first without
 pre-processing and then after applying a Gaussian blur of radius 3:
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

// load the Blobs sample image
\end_layout

\begin_layout Plain Layout

run("Blobs (25K)"); 
\end_layout

\begin_layout Plain Layout

// invert LUT and pixel values to have dark blobs 
\end_layout

\begin_layout Plain Layout

run("Invert LUT"); 
\end_layout

\begin_layout Plain Layout

run("Invert"); 
\end_layout

\begin_layout Plain Layout

// run plugin on image 
\end_layout

\begin_layout Plain Layout

run("Classic Watershed", "input=blobs mask=None use min=0 max=150"); 
\end_layout

\begin_layout Plain Layout

// apply LUT to facilitate result visualization 
\end_layout

\begin_layout Plain Layout

run("3-3-2 RGB"); 
\end_layout

\begin_layout Plain Layout

// pre-process image with Gaussian blur selectWindow("blobs.gif"); 
\end_layout

\begin_layout Plain Layout

run("Gaussian Blur...", "sigma=3"); 
\end_layout

\begin_layout Plain Layout

rename("blobs-blur.gif"); 
\end_layout

\begin_layout Plain Layout

// apply plugin on pre-processed image 
\end_layout

\begin_layout Plain Layout

run("Classic Watershed","input=blobs-blur mask=None use min=0 max=150");
 
\end_layout

\begin_layout Plain Layout

// apply LUT to facilitate result visualization 
\end_layout

\begin_layout Plain Layout

run("3-3-2 RGB");
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs-blur.png
	width 32text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Gaussian-blurred blobs image used as input (radius = 3).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs-watershed-no-preprocessing.png
	width 32text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Watershed segmentation on original image (
\begin_inset Formula $h_{{min}}=0$
\end_inset

, 
\begin_inset Formula $h_{{max}}=150$
\end_inset

).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs-blur-watershed.png
	width 32text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Watershed segmentation on Gaussian-blurred original image (radius = 3, 
\begin_inset Formula $h_{{min}}=0$
\end_inset

, 
\begin_inset Formula $h_{{max}}=150$
\end_inset

).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Input and result images from the macro example.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Marker-controlled Watershed plugin
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Marker-Controlled-Watershed"

\end_inset


\end_layout

\begin_layout Subsection
Introduction
\end_layout

\begin_layout Standard
Marker-controlled Watershed is an ImageJ/Fiji plugin to segment grayscale
 images of any type (8, 16 and 32-bit) in 2D and 3D based on the marker-controll
ed watershed algorithm by 
\begin_inset CommandInset citation
LatexCommand citet
key "Meyer_1990_jvcir"
literal "true"

\end_inset

.
 As the previous method, this algorithm considers the input image as a topograph
ic surface (where higher pixel values mean higher altitude) but it simulates
 its flooding from
\series bold
 specific seed points or markers
\series default
.
 A common choice for the markers are the local minima of the gradient of
 the image, but the method works on any specific marker, either selected
 manually by the user or determined automatically by another algorithm (see
 Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-of-marker-controlled-watershed"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/arabidopsis-nucleus-segmentation.svg
	width 90text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-of-marker-controlled-watershed"

\end_inset

Example of marker-controlled watershed segmentation on nucleus of 
\emph on
Arabidopsis thaliana
\emph default
 (image by courtesy of Kaori Sakai and Javier Arpon, INRA-Versailles).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Usage
\end_layout

\begin_layout Standard
Marker-controlled Watershed needs at least two images to run.
 If that's the case, a dialog like the following will pop up:
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename images/Marker-controlled-Watershed-dialog.png
	width 40text%

\end_inset


\end_layout

\begin_layout Standard
Let's have a look at the different parameters:
\end_layout

\begin_layout Itemize
Image parameters:
\end_layout

\begin_deeper
\begin_layout Itemize
The 
\series bold
Input image
\series default
: a 2D or 3D grayscale image to flood, usually the gradient of an image.
 
\end_layout

\begin_layout Itemize
The 
\series bold
Marker image
\series default
: an image of the same dimensions as the input containing the seed points
 or markers as connected regions of voxels, each of them with a different
 label.
 They correspond usually to the local minima of the input image, but they
 can be set arbitrarily.
 
\end_layout

\end_deeper
\begin_layout Itemize
And it can optionally admit a third image:
\end_layout

\begin_deeper
\begin_layout Itemize
The 
\series bold
Mask image
\series default
: a binary image of the same dimensions as input and marker which can be
 used to restrict the areas of application of the algorithm.
 Set to "None" to run the method on the whole input image.
 
\end_layout

\end_deeper
\begin_layout Itemize
Rest of parameters:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Calculate dams
\series default
: select to enable the calculation of watershed lines.
 
\end_layout

\begin_layout Itemize

\series bold
Use diagonal connectivity
\series default
: select to allow the flooding in diagonal directions (more rounded objects
 are usually obtain by unchecking this option).
 
\end_layout

\end_deeper
\begin_layout Standard
Output:
\end_layout

\begin_layout Itemize

\series bold
Labeled image
\series default
 containing the catchment basins and (optionally) watershed lines (dams).
\end_layout

\begin_layout Section
Interactive Marker-controlled Watershed plugin
\begin_inset CommandInset label
LatexCommand label
name "sec:Interactive-Marker-controlled-WS"

\end_inset


\end_layout

\begin_layout Subsection
Introduction
\end_layout

\begin_layout Standard
Similar to the Marker-controlled Watershed plugin, this ImageJ/Fiji plugin
 segments grayscale images of any type (8, 16 and 32-bit) in 2D and 3D using
 the marker-controlled watershed algorithm by 
\begin_inset CommandInset citation
LatexCommand citet
key "Meyer_1990_jvcir"
literal "true"

\end_inset

.and it floods the image from specific seed points, but this time 
\series bold
the points are introduced interactively by the user
\series default
.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/Interactive-Marker-controlled-Watershed-plugin-overview.png
	width 90text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Overview of the Interactive Marker-controlled Watershed plugin.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Usage
\end_layout

\begin_layout Standard
Interactive Marker-controlled Watershed runs on any open grayscale image,
 single 2D image or (3D) stack.
 If no image is open when calling the plugin, an Open dialog will pop up.
\end_layout

\begin_layout Standard
The user can pan, zoom in and out, or scroll between slices (if the input
 image is a stack) in the main canvas as if it were any other ImageJ window.
 On the left side of the canvas there are three panels of parameters, one
 with the watershed parameters, one for the output (result) options and
 one for post-processing the result.
 All buttons, checkboxes and panels contain a short explanation of their
 functionality that is displayed when the cursor lingers over them.
\end_layout

\begin_layout Subsubsection
Interactive markers
\end_layout

\begin_layout Standard
In this plugin the markers are introduced interactively by the user using
 any of the selection tools.
 By default, the point selection tool will be enabled in the main ImageJ
 toolbar.
 To select markers on different slices, one option is to use the point selection
 tool and keep the SHIFT key pressed each time you click to set a new marker.
 Another possibility is to use the ROI Manager.
 In that case, all selected ROIs in the manager will be used as markers
 (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Interactive-Marker-controlled-WS"

\end_inset

for examples of selections used as markers).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/Interactive-Marker-controlled-Watershed-markers.png
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-of-interactive-markers"

\end_inset

Example of interactive markers introduced by the user.
 From left to right: point selections, rectangular selections and free-hand
 selections (stored in the ROI Manager).
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Watershed Segmentation panel
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename images/Interactive-Marker-controlled-Watershed-WS-panel.png
	width 40text%

\end_inset


\end_layout

\begin_layout Standard
This panel is reserved to the parameters involved in the segmentation pipeline:
\end_layout

\begin_layout Itemize

\series bold
Calculate dams
\series default
: un-check this option to produce segmentations without watershed lines.
 
\end_layout

\begin_layout Itemize

\series bold
Connectivity
\series default
: voxel connectivity (4-8 in 2D, and 6-26 in 3D).
 Selecting non-diagonal connectivity (4 or 6) usually provides more rounded
 objects.
 
\end_layout

\begin_layout Standard
Finally, 
\series bold
click on Run to launch the segmentation
\series default
.
 If your segmentation is taking too long or you want 
\series bold
to stop it
\series default
 for any reason, you can do so by clicking on the same button (which should
 read STOP during that process).
\end_layout

\begin_layout Subsubsection
Results panel
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename images/Morphological-segmentation-results-panel.png
	width 40text%

\end_inset


\end_layout

\begin_layout Standard
Only enabled after running the segmentation.
 
\end_layout

\begin_layout Itemize

\series bold
Display
\series default
: list of options to display the segmentation results (see Fig.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:MS-display-options"

\end_inset

).
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Overlaid basins
\series default
: colored objects overlaying the input image (with or without dams depending
 on the selected option in the Watershed Segmentation panel).
 
\end_layout

\begin_layout Itemize

\series bold
Overlaid dams
\series default
: overlay the watershed dams in red on top of the input image (only works
 if Calculate dams is checked).
 
\end_layout

\begin_layout Itemize

\series bold
Catchment basins
\series default
: colored objects.
 
\end_layout

\begin_layout Itemize

\series bold
Watershed lines
\series default
: binary image showing the watershed lines in black and the objects in white
 (only works if Calculate dams is checked).
 
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Show result overlay
\series default
: toggle result overlay.
 
\end_layout

\begin_layout Itemize

\series bold
Create image button
\series default
: create a new image with the results displayed in the canvas.
\end_layout

\begin_layout Subsubsection
Post-processing panel
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename images/Morphological-segmentation-post-processing-panel.png
	width 40text%

\end_inset


\end_layout

\begin_layout Standard
Similarly to the Results panel, this panel only gets enabled after running
 the segmentation pipeline.
\end_layout

\begin_layout Itemize

\series bold
Merge labels
\series default
: merge together labels selected by either the 
\series bold

\begin_inset Quotes eld
\end_inset

freehand
\begin_inset Quotes erd
\end_inset

 selection tool
\series default
 (on a single slice) 
\series bold
or the point tool
\series default
 (on single or multiple slices).
 The zero-value label belongs to the watershed dams, therefore it will ignored
 in case of being selected.
 The first selected label value will be assigned to the rest of selected
 labels, which will share its color.
 
\begin_inset Newline newline
\end_inset


\series bold
\color red
Note
\series default
\color inherit
: to select labels on different slices, use the point selection tool and
 keep the SHIFT key pressed each time you click on a new label.
\end_layout

\begin_layout Itemize

\series bold
Shuffle colors
\series default
: randomly re-assign colors to the labels.
 This is a very handy option whenever two adjacent labels present a similar
 color.
\end_layout

\begin_layout Section
Morphological Segmentation plugin
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Morphological-Segmentation-Plugin"

\end_inset


\end_layout

\begin_layout Subsection
Introduction
\end_layout

\begin_layout Standard
Morphological Segmentation is an ImageJ/Fiji plugin that combines morphological
 operations, such as extended minima and morphological gradient, with watershed
 flooding algorithms to segment grayscale images of any type (8, 16 and
 32-bit) in 2D and 3D.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/Morphological-segmentation-front.png
	lyxscale 50
	width 90text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Overview of the Morphological Segmentation plugin.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Usage
\end_layout

\begin_layout Standard
Morphological Segmentation runs on any open grayscale image, single 2D image
 or (3D) stack.
 If no image is open when calling the plugin, an Open dialog will pop up.
\end_layout

\begin_layout Standard
The user can pan, zoom in and out, or scroll between slices (if the input
 image is a stack) in the main canvas as if it were any other ImageJ window.
 On the left side of the canvas there are four panels of parameters, one
 for the input image, one with the watershed parameters, one for the output
 options and one for post-processing the resulting labels.
 All buttons, checkboxes and panels contain a short explanation of their
 functionality that is displayed when the cursor lingers over them.
\end_layout

\begin_layout Standard

\series bold
Image pre-processing
\series default
: some pre-processing is included in the plugin to facilitate the segmentation
 task.
 However, other pre-processing may be required depending on the input image.
 It is up to the user to decide what filtering may be most appropriate upstream.
\end_layout

\begin_layout Subsubsection
Input Image panel
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename images/Morphological-segmentation-input-image-panel.png
	width 40text%

\end_inset


\end_layout

\begin_layout Standard
First, you need to indicate the nature of the input image to process.
 This is a 
\series bold
key parameter
\series default
 since the watershed algorithm is expecting an image where the boundaries
 of objects present high intensity values (usually as a result of a gradient
 or edge detection filtering).
 
\end_layout

\begin_layout Standard
You should select:
\end_layout

\begin_layout Itemize

\series bold
Border Image
\series default
: if your input image has highlighted object boundaries.
 
\end_layout

\begin_layout Itemize

\series bold
Object Image
\series default
: if the borders of the objects do not have higher intensity values than
 the rest of voxels in the image.
 
\end_layout

\begin_layout Standard
When selecting Object Image, an additional set of options is enabled to
 choose the type of gradient and radius (in pixels) to apply to the input
 image before starting the morphological operations.
 Finally, a checkbox allows displaying the gradient image instead of the
 input image in the main canvas of the plugin (only after running the watershed
 segmentation).
\end_layout

\begin_layout Subsubsection
Watershed Segmentation panel
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename images/Morphological-segmentation-watershed-segmentation-panel.png
	width 40text%

\end_inset


\end_layout

\begin_layout Standard
This panel is reserved to the parameters involved in the segmentation pipeline.
 By default, only the tolerance can be changed.
 Clicking on Advanced options enables the rest of options.
\end_layout

\begin_layout Itemize

\series bold
Tolerance
\series default
: dynamic of intensity for the search of regional minima (in the extended-minima
 transform, which is the regional minima of the H-minima transform, value
 of h).
 Increasing the tolerance value reduces the number of segments in the final
 result, while decreasing its value produces more object splits.
 
\series bold
\color red

\begin_inset Newline newline
\end_inset

Note
\series default
\color inherit
: since the tolerance is an intensity parameter, it is sensitive to the
 input image type.
 A tolerance value of 10 is a good starting point for 8-bit images (with
 0-255 intensity range) but it should be drastically increased when using
 image types with larger intensity ranges.
 For example to ~2000 when working on a 16-bit image (intensity values between
 0 and 65535).
\end_layout

\begin_layout Itemize

\series bold
Calculate dams
\series default
: un-check this option to produce segmentations without watershed lines.
 
\end_layout

\begin_layout Itemize

\series bold
Connectivity
\series default
: voxel connectivity (4-8 in 2D, and 6-26 in 3D).
 Selecting non-diagonal connectivity (4 or 6) usually provides more rounded
 objects.
 
\end_layout

\begin_layout Standard
Finally, 
\series bold
click on Run to launch the segmentation
\series default
.
\end_layout

\begin_layout Standard
If your segmentation is taking too long or you want 
\series bold
to stop it
\series default
 for any reason, you can do so by clicking on the same button (which should
 read STOP during that process).
\end_layout

\begin_layout Subsubsection
Results panel
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename images/Morphological-segmentation-results-panel.png
	width 40text%

\end_inset


\end_layout

\begin_layout Standard
Only enabled after running the segmentation.
 
\end_layout

\begin_layout Itemize

\series bold
Display
\series default
: list of options to display the segmentation results.
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Overlaid basins
\series default
: colored objects overlaying the input image (with or without dams depending
 on the selected option in the Watershed Segmentation panel).
 
\end_layout

\begin_layout Itemize

\series bold
Overlaid dams
\series default
: overlay the watershed dams in red on top of the input image (only works
 if Calculate dams is checked).
 
\end_layout

\begin_layout Itemize

\series bold
Catchment basins
\series default
: colored objects.
 
\end_layout

\begin_layout Itemize

\series bold
Watershed lines
\series default
: binary image showing the watershed lines in black and the objects in white
 (only works if Calculate dams is checked).
 
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Show result overlay
\series default
: toggle result overlay.
 
\end_layout

\begin_layout Itemize

\series bold
Create image button
\series default
: create a new image with the results displayed in the canvas.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/Morphological-segmentation-result-examples.png
	lyxscale 50
	width 100text%

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:MS-display-options"

\end_inset

Examples of the 4 different display options.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Post-processing panel
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename images/Morphological-segmentation-post-processing-panel.png
	width 40text%

\end_inset


\end_layout

\begin_layout Standard
Similarly to the Results panel, this panel only gets enabled after running
 the segmentation pipeline.
\end_layout

\begin_layout Itemize

\series bold
Merge labels
\series default
: merge together labels selected by either the 
\series bold

\begin_inset Quotes eld
\end_inset

freehand
\begin_inset Quotes erd
\end_inset

 selection tool
\series default
 (on a single slice) 
\series bold
or the point tool
\series default
 (on single or multiple slices).
 The zero-value label belongs to the watershed dams, therefore it will ignored
 in case of being selected.
 The first selected label value will be assigned to the rest of selected
 labels, which will share its color.
 
\begin_inset Newline newline
\end_inset


\series bold
\color red
Note
\series default
\color inherit
: to select labels on different slices, use the point selection tool and
 keep the SHIFT key pressed each time you click on a new label.
\end_layout

\begin_layout Itemize

\series bold
Shuffle colors
\series default
: randomly re-assign colors to the labels.
 This is a very handy option whenever two adjacent labels present a similar
 color.
\end_layout

\begin_layout Subsection
Macro language compatibility
\end_layout

\begin_layout Standard
Morphological Segmentation is completely compatible with the popular ImageJ
 macro language
\begin_inset Foot
status open

\begin_layout Plain Layout
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://imagej.net/developer/macro/macros.html
\end_layout

\end_inset


\end_layout

\end_inset

.
 Each of the buttons in the GUI are macro-recordable and their commands
 can be reproduced later from a simple macro file.
\end_layout

\begin_layout Standard
The complete list of commands is as follows:
\end_layout

\begin_layout Itemize
Start the plugin:
\begin_inset Newline newline
\end_inset


\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

run("Morphological Segmentation");
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Select input image:
\begin_inset Newline newline
\end_inset


\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

// select as object image
\end_layout

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.setInputImageType", "object");
\end_layout

\begin_layout Plain Layout

// select as border image
\end_layout

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.setInputImageType", "border");
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Run segmentation with specific options:
\begin_inset Newline newline
\end_inset


\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.segment","tolerance=10", "calculat
eDams=true","connectivity=6");
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Toggle result overlay:
\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.toggleOverlay");
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Set option to display gradient image:
\begin_inset Newline newline
\end_inset


\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.setShowGradient", "true");
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Select display format:
\begin_inset Newline newline
\end_inset


\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

// Overlaid basins
\end_layout

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.setDisplayFormat", "Overlaid
 basins"); 
\end_layout

\begin_layout Plain Layout

// Overlaid dams
\end_layout

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.setDisplayFormat", "Overlaid
 dams");
\end_layout

\begin_layout Plain Layout

// Catchment basins
\end_layout

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.setDisplayFormat", "Catchment
 basins");
\end_layout

\begin_layout Plain Layout

// Watershed lines 
\end_layout

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.setDisplayFormat", "Watershed
 lines");
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
Create new image with the current result:
\begin_inset Newline newline
\end_inset


\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.createResultImage");
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Complete macro example
\end_layout

\begin_layout Standard
The following macro opens the Blobs sample image, applies the plugin with
 a tolerance value of 32 and displays the result as overlaid dams.
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

// load the Blobs sample image 
\end_layout

\begin_layout Plain Layout

run("Blobs (25K)"); 
\end_layout

\begin_layout Plain Layout

// run the plugin 
\end_layout

\begin_layout Plain Layout

run("Morphological Segmentation"); 
\end_layout

\begin_layout Plain Layout

// wait for the plugin GUI to load 
\end_layout

\begin_layout Plain Layout

wait(1000); 
\end_layout

\begin_layout Plain Layout

// select input image as "object" 
\end_layout

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.setInputImageType", "object");
 
\end_layout

\begin_layout Plain Layout

// set gradient radius as 1 
\end_layout

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.setGradientRadius", "1");
 
\end_layout

\begin_layout Plain Layout

// run segmentation with tolerance 32, calculating the watershed dams, 
 
\end_layout

\begin_layout Plain Layout

// 4-connectivity  
\end_layout

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.segment", "tolerance=32",
  "calculateDams=true", "connectivity=4"); 
\end_layout

\begin_layout Plain Layout

// display the overlaid dams 
\end_layout

\begin_layout Plain Layout

call("inra.ijpb.plugins.MorphologicalSegmentation.setDisplayFormat", "Overlaid
 dams");
\end_layout

\end_inset


\end_layout

\begin_layout Section
Distance Transform Watershed
\begin_inset CommandInset label
LatexCommand label
name "sec:Distance-Transform-Watershed"

\end_inset


\end_layout

\begin_layout Subsection
Introduction
\end_layout

\begin_layout Standard
A classic way of separating touching objects in binary images makes use
 of the distance transform and the watershed method.
 The idea is to create a border as far as possible from the center of the
 overlapping objects.
 This strategy works very well on rounded objects and it is called Distance
 Transform Watershed.
 It consists on calculating the distance transform of the binary image,
 inverting it (so the darkest parts of the image are the centers of the
 objects) and then applying watershed on it using the original image as
 mask (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:distance-transform-watershed"

\end_inset

).
 In our implementation, we include an option to use watershed with extended
 minima so the user can control the number of object splits and merges.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/NucleiDAPIConfocal/NucleiDAPIconfocal.png
	lyxscale 25
	width 24text%

\end_inset

 
\begin_inset Graphics
	filename images/NucleiDAPIConfocal/NucleiDAPIconfocal-binary-mask.png
	lyxscale 25
	width 24text%

\end_inset

 
\begin_inset Graphics
	filename images/NucleiDAPIConfocal/NucleiDAPIconfocal-inverse-dist-chessknight-32bit-normalized.png
	lyxscale 25
	width 24text%

\end_inset

 
\begin_inset Graphics
	filename images/NucleiDAPIConfocal/NucleiDAPIconfocal-distance-transform-watershed.png
	lyxscale 25
	width 24text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\series bold
\begin_inset CommandInset label
LatexCommand label
name "fig:distance-transform-watershed"

\end_inset

Basics of the Distance Transform Watershed algorithm
\series default
.
 From left to right: sample image of touching DAPI stained cell nuclei from
 a confocal laser scanning microscope, binary mask calculated after filtering
 and thresholding input image, inverse of the distance transform applied
 to the binary mask (Chamfer distance map using normalized Chessknight weights
 and 32-bit output) and resulting labeled image after applying watershed
 to the inverse distance image using the binary mask (dynamic of 1 and 4-connect
ivity).
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
MorphoLibJ provides two plugins under the 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Binary Images...
\begin_inset Quotes erd
\end_inset

 menu to apply this strategy on 2D and 3D images:
\end_layout

\begin_layout Subsection
Distance Transform Watershed
\begin_inset CommandInset label
LatexCommand label
name "subsec:Distance-Transform-Watershed"

\end_inset


\end_layout

\begin_layout Standard
Distance Transform Watershed needs one 2D 8-bit binary image to run.
 If that's the case, a dialog like the following will pop up:
\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename images/Distance-Transform-Watershed-2D-menu.png
	width 40text%

\end_inset


\end_layout

\begin_layout Standard
The plugin parameters are divided between the distance transform and the
 watershed options:
\end_layout

\begin_layout Itemize

\series bold
Distance map options
\series default
:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Distances
\series default
: allows selecting among a pre-defined set of weights that can be used to
 compute the distance transform using Chamfer approximations of the Euclidean
 metric (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Distance-Transform"

\end_inset

).
 They affect the location but specially the shape of the border in the final
 result.
 The options are:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Chessboard (1,1)
\series default
: weight equal to 1 for all neighbors.
\end_layout

\begin_layout Itemize

\series bold
City-Block (1,2)
\series default
: weights 1 for orthogonal neighbors and 2 for diagonal neighbors.
\end_layout

\begin_layout Itemize

\series bold
Quasi-Euclidean (1,1.41)
\series default
: weights 1 for orthogonal neighbors and 
\begin_inset Formula $\sqrt{2}$
\end_inset

 for diagonal neighbors.
\end_layout

\begin_layout Itemize

\series bold
Borgefors (3,4)
\series default
: weights 3 for orthogonal neighbors and 4 for diagonal neighbors (best
 approximation of Euclidean distance for 3-by-3 masks).
\end_layout

\begin_layout Itemize

\series bold
Weights (2,3)
\series default
: weights 2 for orthogonal neighbors and 3 for diagonal neighbors.
\end_layout

\begin_layout Itemize

\series bold
Weights (5,7)
\series default
: weights 5 for orthogonal neighbors and 7 for diagonal neighbors.
\end_layout

\begin_layout Itemize

\series bold
Chessknight (5,7,11)
\series default
: weights 5 for orthogonal neighbors and 7 for diagonal neighbors, and 11
 for chess-knight moves (best approximation for 5-by-5 masks).
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Output type
\series default
: 16 or 32-bit, to calculate distance with short or float precision.
\end_layout

\begin_layout Itemize

\series bold
Normalize weights
\series default
: indicates whether the resulting distance map should be normalized (divide
 distances by the first Chamfer weight).
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Watershed options
\series default
:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Dynamic
\series default
: same as in the Morphological Segmentation plugin, this is the dynamic
 of intensity for the search of regional minima in the inverse of the distance
 transform image.
 Basically, by increasing its value there will be more object merges and
 by decreasing it there will be more object splits.
\end_layout

\begin_layout Itemize

\series bold
Connectivity
\series default
: pixel connectivity (4 or 8).
 Selecting non-diagonal connectivity (4) usually provides more rounded objects.
 
\end_layout

\end_deeper
\begin_layout Standard
Finally, the result with the current plugin configuration can be visualized
 by clicking on the 
\series bold
Preview
\series default
 option.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard

\series bold
Result
\series default
: 2D 32-bit label image (one index value per object).
\end_layout

\begin_layout Subsection
Distance Transform Watershed (3D)
\begin_inset CommandInset label
LatexCommand label
name "subsec:Distance-Transform-Watershed-3d"

\end_inset


\end_layout

\begin_layout Standard
Distance Transform Watershed 3D needs one 3D 8-bit binary image to run.
 If that's the case, a dialog like the following will pop up:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Graphics
	filename images/Distance-Transform-Watershed-3D-menu.png
	width 45text%

\end_inset


\end_layout

\begin_layout Standard
The parameters are the same as in the 2D version but some of them are adapted
 for 3D images:
\end_layout

\begin_layout Itemize

\series bold
Distance map options
\series default
:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Distances
\series default
: Now the available options are:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Chessboard (1,1,1)
\series default
: weight equal to 1 for all neighbors.
\end_layout

\begin_layout Itemize

\series bold
City-Block (1,2,3)
\series default
: weights 1 for orthogonal neighbors, 2 for diagonal neighbors and 3 for
 cube-diagonals.
\end_layout

\begin_layout Itemize

\series bold
Quasi-Euclidean (1,1.41,1.73)
\series default
: weights 1 for orthogonal neighbors, 
\begin_inset Formula $\sqrt{2}$
\end_inset

 for diagonal neighbors and 
\begin_inset Formula $\sqrt{3}$
\end_inset

 for cube-diagonals.
\end_layout

\begin_layout Itemize

\series bold
Borgefors (3,4,5)
\series default
: weights 3 for orthogonal neighbors, 4 for diagonal neighbors and 5 for
 cube-diagonals (best approximation of Euclidean distance for 3-by-3-by-3
 masks).
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Output type
\series default
: 16 or 32-bit, to calculate distance with short or float precision.
\end_layout

\begin_layout Itemize

\series bold
Normalize weights
\series default
: indicates whether the resulting distance map should be normalized (divide
 distances by the first Chamfer weight).
\end_layout

\end_deeper
\begin_layout Itemize

\series bold
Watershed options
\series default
:
\end_layout

\begin_deeper
\begin_layout Itemize

\series bold
Dynamic
\series default
: same as in the 2D version, this is the dynamic of intensity for the search
 of regional minima in the inverse of the distance transform image.
 Basically, by increasing its value there will be more object merges and
 by decreasing it there will be more object splits.
\end_layout

\begin_layout Itemize

\series bold
Connectivity
\series default
: voxel connectivity (6 or 26).
 Selecting non-diagonal connectivity (6) usually provides more rounded objects.
\end_layout

\end_deeper
\begin_layout Standard
As it is usual in ImageJ, no preview is provided here since we are dealing
 with 3D images.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard

\series bold
Result
\series default
: 3D 32-bit label image (one index value per object).
\end_layout

\begin_layout Chapter
Measurements
\end_layout

\begin_layout Standard
MorphoLibJ contains several tools for quantifying the 
\series bold
size
\series default
, the 
\series bold
shape
\series default
, the 
\series bold
intensities
\series default
, or the 
\series bold
spatial organization
\series default
 of biological structures observed within images 2D or 3D images.
 
\end_layout

\begin_layout Standard
Sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Region-Analysis"

\end_inset

 and refer 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Region-Analysis-3D"

\end_inset

 to the analysis of 2D and 3D regions, respectively.
 Most region analysis operators of the MorphoLibJ library assume the input
 image to be either a binary image representing a single region, or a label
 image representing a collection of disjoint regions (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:label-images"

\end_inset

).
 The aim is to facilitate the management of label images, contrary to the
 built-in 
\begin_inset Quotes eld
\end_inset

Analyze Particles...
\begin_inset Quotes erd
\end_inset

 function that operates directly on a grayscale image.
 
\end_layout

\begin_layout Standard
The library also provides plugins for intensity measurements (section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Intensity-Measurements"

\end_inset

), the comparison of label images (section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Label-Overlap-measures"

\end_inset

), and the quantification of spatial organization (section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Region-Adjacency-Graph"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Region Analysis 
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Region-Analysis"

\end_inset


\end_layout

\begin_layout Standard
Region analysis usually refers to the quantification of features related
 to the 
\series bold
size
\series default
 and the 
\series bold
shape
\series default
 of regions identified within images 
\begin_inset CommandInset citation
LatexCommand citep
key "ArgandaCarreras_Andrey_2017"
literal "false"

\end_inset

.
\end_layout

\begin_layout Standard
Many region features have been proposed to describe morphology of regions.
 The MorphoLibJ library proposes plugins to quantify some of the most common
 ones:
\end_layout

\begin_layout Itemize

\series bold
intrinsic volumes
\series default
 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Intrinsic-Volumes-2D"
plural "false"
caps "false"
noprefix "false"

\end_inset

) encompass the area, the perimeter, and the Euler number, that quantify
 the topology of the region
\end_layout

\begin_layout Itemize
the computation of 
\series bold
moments of a region
\series default
 can be used to determine the centroid or equivalent ellipse (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Geometric-Moment-And-Equivalent-Ellipse"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\end_layout

\begin_layout Itemize
dimension extent may be determined by use of 
\series bold
Feret diameters
\series default
 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Feret-Diameter-And-Oriented-Box"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\end_layout

\begin_layout Itemize

\series bold
geodesic features
\series default
 allow to investigate the complexity of the region, in particular the tortuosity
 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Geodesic-Measurements"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\end_layout

\begin_layout Itemize
the use of the skeleton provide derived features such as the 
\series bold
average thickness
\series default
 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Average-Thickness"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\end_layout

\begin_layout Itemize
features describing the size may be combined to obtain
\series bold
 shape indices
\series default
 that describe the morphology of the regions independantly of their size
 and location (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Shape-Indices"
plural "false"
caps "false"
noprefix "false"

\end_inset

) 
\end_layout

\begin_layout Standard
The following sections will present these featuers.
 For each family of features, we first provide mathematical definitions
 of the implemented features, eventually completed by the methods used to
 measure them from discrete images.
 A final section (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Analyze-Regions-Plugins"
plural "false"
caps "false"
noprefix "false"

\end_inset

) presents the different plugins that allow to measure features from images.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
introduces question of discretisation
\end_layout

\begin_layout Subsection
Discrete images
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Intrinsic volumes
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Intrinsic-Volumes-2D"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
intrinsic volumes 
\series default
are a set of features with interesting mathematical properties that are
 commonly used for describing individual particles as well as binary microstruct
ures.
 In 2D, they correspond to the 
\series bold
area
\series default
, the 
\series bold
perimeter
\series default
 and the 
\series bold
Euler number
\series default
.
\end_layout

\begin_layout Subsubsection
Area
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Area"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
area
\series default
 of a set 
\begin_inset Formula $X$
\end_inset

 can be defined using integrals over the set:
\begin_inset Formula 
\begin{align}
A(X) & =\int_{X}dx
\end{align}

\end_inset


\end_layout

\begin_layout Standard
In image analysis, the 
\series bold
measurement of area 
\series default
of a region simply consists in counting the number of pixels that constitute
 it, and to multiply by the area of a single pixel.
\end_layout

\begin_layout Subsubsection
Perimeter
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Perimeter"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
perimeter
\series default
 of a region corresponds to the length of its boundary.
 Its formal definition involves computing an integral over its boundary
 
\begin_inset Formula $\partial X$
\end_inset

:
\begin_inset Formula 
\begin{align}
P(X) & =\int_{\partial X}dx
\end{align}

\end_inset


\end_layout

\begin_layout Standard
An intuitive approach for 
\series bold
measuring the perimeter
\series default
 of a binary region is to count the number of boundary pixels (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Perimeter-Estimation"

\end_inset

).
 However, this approach is rather inaccurate.
 For example, when counting the boundary pixels of a discretized disk, one
 obtain the same perimeter value as the length of the bounding rectangle,
 leading to a relative error of more than 25%
\begin_inset Foot
status open

\begin_layout Plain Layout
If 
\begin_inset Formula $d$
\end_inset

 is the diameter of the circle, the expected perimeter is 
\begin_inset Formula $\pi d$
\end_inset

.
 The number of boundary pixels measure the perimeter of the enclosing square,
 equal to 
\begin_inset Formula $4d$
\end_inset

.
 The relative error is 
\begin_inset Formula $(4d-\pi d)/\pi d\simeq27\%$
\end_inset


\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/perimeter-measure-boundaryCount.png
	lyxscale 50
	height 6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Boundary pixels count
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/perimeter-measure-Crofton.png
	lyxscale 50
	height 6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Crofton method
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Perimeter-Estimation"

\end_inset

Measurement of perimeter within a discrete image of a disk.
 (a) Counting the number of boundary pixels.
 (b) Counting the number of intersection with parallel lines.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The discrete version of Crofton formula can provide a better estimate of
 the perimeter than traditional boundary pixel count.
 The principle is to consider a set of parallel lines with a random orientation,
 and to count the number of intersections with the region of interest (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Perimeter-Estimation"

\end_inset

).
 The number of intersections is proportional to the line density and to
 the perimeter 
\begin_inset CommandInset citation
LatexCommand citep
key "Serra_1982,Legland2007,Ohser2009"
literal "true"

\end_inset

.
 By averaging over all possible directions, an unbiased estimate can be
 obtained.
\end_layout

\begin_layout Standard
Perimeter can be measured using either two directions (horizontal and vertical),
 or four directions (by adding the diagonals).
 Restricting the number of directions introduces an estimation bias, with
 known theoretical bounds 
\begin_inset CommandInset citation
LatexCommand citep
key "Moran1966,Legland2007"
literal "true"

\end_inset

.
 The error made by counting intersections is usually better than boundary
 pixel count 
\begin_inset CommandInset citation
LatexCommand citep
key "Lehmann_2012_ij"
literal "true"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Euler Number
\end_layout

\begin_layout Standard
The 
\series bold
Euler number
\series default
 is a feature that describes the 
\series bold
topology 
\series default
of a region.
 It corresponds to the number of connected components, minus the number
 of holes (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Euler-Number"

\end_inset

-a).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/euler-number-2d-horiz.png
	height 3.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Euler-Number"

\end_inset

Euler Number for 2D regions.
 Particle A is composed of a single component, its Euler number is 1.
 Particles B and C present one and two holes respectively.
 Their corresponding Euler numbers are equal to 
\begin_inset Formula $0=1-1$
\end_inset

 and 
\begin_inset Formula $-1=1-2$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In 2D, the Euler number of a region with smooth boundary also equals the
 
\series bold
integral of the curvature
\series default
 over the boundary of the set:
\begin_inset Formula 
\begin{equation}
\chi(X)=\frac{1}{2\pi}\int_{\partial X}\kappa(x)dx
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Digital-Euler-Number"

\end_inset


\end_layout

\begin_layout Standard
The measurement of Euler number from binary images is usually performed
 by considering a reconstruction of the 
\series bold
connected components
\series default
 that connects adjacent pixels or voxels (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Euler-Number-Computation-2D"

\end_inset

).
 The resulting reconstruction depends on the choice of the connectivity
 (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Digital-Connectivity"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 For planar images, typical choices are the 4-connectivity, corresponding
 to the orthogonal neighbors (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Euler-Number-Computation-2D"

\end_inset

-b), and the 8-connectivity, that also consider the diagonal neighbors (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Euler-Number-Computation-2D"

\end_inset

-b).
 The connectivity is also considered for computing morphological reconstructions
 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Morphological-Reconstruction"

\end_inset

), or for computing the connected component labeling of a binary image (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Connected-Components-Labeling"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/binaryImage12x8WithDigits.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Binary image
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/binaryImage12x8RecC4.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
4-connectivity
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/binaryImage12x8RecC8.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
8-connectivity
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Euler-Number-Computation-2D"

\end_inset

Determination of the Euler number from binary images.
 (a) Original binary images.
 (b) Euler number computed with 4-connectivity: five components are detected.
 (c) Euler number computed using the 8-connectivity: three components are
 detected, two of them having holes.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Depening on the chosen connectivity, the resulting Euler number may differ.
 For example, the reconstruction presented in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Euler-Number-Computation-2D"

\end_inset

 has Euler number equal to five (the number of connected components), whereas
 the Euler number of the reconstruction using the 8-connectivity is equal
 to 1: three connected components are obtained, minus two holes within them
 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Euler-Number-Computation-2D"

\end_inset

-c).
\end_layout

\begin_layout Subsection
Geometric moments and equivalent ellipse
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Geometric-Moment-And-Equivalent-Ellipse"

\end_inset


\end_layout

\begin_layout Standard
A binary region 
\begin_inset Formula $X$
\end_inset

 may be described mathematically by its
\series bold
 geometric moments
\series default
 
\begin_inset Formula $m_{pq}$
\end_inset

 of order 
\begin_inset Formula $(p,q)$
\end_inset

, which correspond to an integral of its indicator function 
\begin_inset Formula $I_{X}$
\end_inset

, with various degrees along the directions:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
m_{pq}(X) & =\int\int I_{X}(x,y)x^{p}y^{q}\cdot dx\cdot dy\label{eq:Moment-of-X-2D}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The moment of order 
\begin_inset Formula $(0,0)$
\end_inset

 simply corresponds to the area of 
\begin_inset Formula $X$
\end_inset

: 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
m_{00} & =\int\int I_{X}(x,y)\cdot dx\cdot dy\\
 & =A(X)
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The coordinates of the centroid of 
\begin_inset Formula $X$
\end_inset

 can be expressed from the first-order moments:
\begin_inset Formula 
\begin{align*}
x_{c} & =\frac{m_{10}}{m_{00}}=\frac{1}{Area(X)}\int\int I_{X}(x,y)\cdot x\cdot dx\cdot dy\\
y_{c} & =\frac{m_{01}}{m_{00}}=\frac{1}{Area(X)}\int\int I_{X}(x,y)\cdot y\cdot dx\cdot dy
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
It is often more convenient to work with 
\series bold
centered moments
\series default
, given by:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align}
\mu_{pq} & =\int\int I_{X}(x,y)\left(x-x_{c}\right)^{p}\left(y-yc\right)^{q}\cdot dx\cdot dy
\end{align}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/demoShape-ellipse.png
	height 4.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Inertia-ellipse"

\end_inset

Equivalent ellipse of a binary region.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The second order centered moments can be arranged into a matrix:
\begin_inset Formula 
\[
\left[\begin{array}{cc}
\mu_{20} & \mu_{11}\\
\mu_{11} & \mu_{02}
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
By computing the parameters of the ellipse that produces the same moments
 up to the second order, one obtains the 
\series bold
equivalent ellipse
\series default
 
\begin_inset CommandInset citation
LatexCommand citep
key "Burger_Burge_2008"
literal "true"

\end_inset

.
 In particular, the orientation 
\begin_inset Formula $\theta$
\end_inset

 of the equivalent ellipse is given by 
\begin_inset Formula $\theta=\frac{1}{2}\text{atan2}\left(2\cdot\mu_{11},\mu_{20}-\mu_{02}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Feret diameter and oriented box
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Feret-Diameter-And-Oriented-Box"

\end_inset


\end_layout

\begin_layout Standard
A popular way to assess the size of a region is to measure its 
\series bold
largest Feret diameter
\series default
.
 The maximum Feret diameter of a region is simply the maximum distance computed
 over all the pairs of points belonging to the region:
\begin_inset Formula 
\begin{align}
F_{\text{max}} & =\max_{\boldsymbol{x},\boldsymbol{y}\in X}d(\boldsymbol{x},\boldsymbol{y})
\end{align}

\end_inset


\end_layout

\begin_layout Standard
It is easy to realize that the search can be performed on the set of boundary
 points (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Feret-Diameter-And-Oriented-Box"

\end_inset

).
 In practice, the computation of Maximum Feret diameter can be accelerated
 by first computing the convex hull of the region.
 In MorphoLibJ, the maximal Feret diameter is computed over the corners
 of the regions.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/demoShape-maxFeret.png
	height 4.5cm

\end_inset


\begin_inset Graphics
	filename images/analysis/demoShape-orientedBox.png
	height 4.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Feret-Diameter-And-Oriented-Box"

\end_inset

Feret diameter and oriented box
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The Feret diameter can be performed on any direction.
 Typical choice is to measure the Feret diameter in the direction perpendicular
 to the direction of the maximum Feret diameter.
 The ratio of the largest Feret diameter and of the Feret diameter measured
 in the perpendicular direction gives an indication on the elongation of
 the region.
 
\end_layout

\begin_layout Standard
The notion of 
\series bold
object-oriented bounding box
\series default
 (sometimes denoted as 
\begin_inset Quotes eld
\end_inset

OOBB
\begin_inset Quotes erd
\end_inset

) is closely related to that of Feret diameter.
 One possible definition of oriented bounding box is the rectangle with
 smallest width that totally encloses the region.
 An example is illustrated on Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Feret-Diameter-And-Oriented-Box"

\end_inset

.
 Another definition is the rectangle with smallest area: the two resulting
 rectangles are often similar, but may differ in some cases.
 Note that in general, the orientation of the largest axis of the oriented
 box differs from both the direction of the largest Feret diameter, and
 the direction of the equivalent ellipse.
\end_layout

\begin_layout Subsection
Geodesic measurements
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Geodesic-Measurements"

\end_inset


\end_layout

\begin_layout Standard
For particles with complex shapes, the 
\series bold
geodesic diameter 
\series default
may be of interest.
 It corresponds of the largest geodesic distance between two points within
 a region, the geodesic distance being the length of the shortest path joining
 the two points while staying inside the region 
\begin_inset CommandInset citation
LatexCommand citep
key "Lantuejoul1981"
literal "true"

\end_inset

.
 An example is given on Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Geodesic-Diameter"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/demoShape-geodDiam.png
	height 4.5cm

\end_inset


\begin_inset Graphics
	filename images/analysis/36_manual1-geodiam.png
	lyxscale 75
	width 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Geodesic-Diameter"

\end_inset

Geodesic diameter.
 Left: illustration of the geodesic diameter on a simple particle.
 Right: computation of the geodesic diameter on a segmented image from the
 DRIVE database 
\begin_inset CommandInset citation
LatexCommand citep
key "Staal_2004_tmi"
literal "true"

\end_inset

.
 Each connected component was associated to a label, then the longest geodesic
 path within each connected component was computed and displayed as red
 overlay.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The implementation of geodesic diameter within MorphoLibJ relies on Chamfer
 distances propagation (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Geodesic-Distance-Transform"

\end_inset

).
 Hence, the actual value may be somewhat over-estimated due to the approximation
 in the measurements.
\end_layout

\begin_layout Subsection
Thickness
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Average-Thickness"

\end_inset


\end_layout

\begin_layout Standard
The thickness is also a convenient measure to describe a region.
 It may be evaluated by the diameter of the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[subsec:Largest-inscribed-circle-plugin]{largest inscribed circle}
\end_layout

\end_inset

 plugin (page
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Largest-inscribed-circle-plugin"
plural "false"
caps "false"
noprefix "false"

\end_inset

, Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Thickness"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 This method however often over-estimates the thickness, as it measures
 thickness at the largest point within the region.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/demoShape-inscrDisk.png
	height 4.5cm

\end_inset


\begin_inset Graphics
	filename images/analysis/sample_particle-distMap_skelOVR.tif
	height 4.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Thickness"

\end_inset

Evaluation of the thickness using two methods.
 On the left, computation of the largest inscribed circle.
 On the right, computation of the average thickness over the skeleton.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The MorphoLibJ library also proposes to measure 
\series bold
average thickness
\series default
 by first computing the skeleton of the region, and then to measure for
 each pixel of the skeleton the distance to the closest background point
 in the original image (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Thickness"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 This way, the thickness measure is integrated over the whole region skeleton
 and is more representative.
\end_layout

\begin_layout Subsection
Quantification by shape indices
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Shape-Indices"

\end_inset


\end_layout

\begin_layout Standard
It is often convenient to describe and 
\series bold
quantify the shape 
\series default
of regions independently of their location, orientation, or relative scaling.
 Several indices are commonly used to describe the shape of the particles,
 independently of their size.
 We present here the definitions used within the MorphoLibJ plugins.
\end_layout

\begin_layout Subsubsection
Circularity
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Circularity"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
circularity
\series default
 (or 
\begin_inset Quotes eld
\end_inset

shape factor
\begin_inset Quotes erd
\end_inset

, or 
\begin_inset Quotes eld
\end_inset

isperimetric deficit index
\begin_inset Quotes erd
\end_inset

) is defined as the ratio of area over the square of the perimeter, normalized
 such that the value for a disk equals one:
\begin_inset Formula 
\begin{eqnarray}
\mbox{circularity} & = & 4\pi\frac{A}{P^{2}}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
While the values of isoperimetric deficit index theoretically range within
 the interval 
\begin_inset Formula $[0;1]$
\end_inset

, the measurements errors of the perimeter may produce circularity values
 above 1 
\begin_inset CommandInset citation
LatexCommand citep
key "Lehmann_2012_ij"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Subsubsection
Convexity
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Convexity"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
convexity
\series default
 (also known as 
\begin_inset Quotes eld
\end_inset

solidity
\begin_inset Quotes erd
\end_inset

) is defined as the ratio of the area of the region over the area of its
 convex hull.
\begin_inset Formula 
\begin{align*}
\text{convexity} & =\frac{A(X)}{A(\text{ConvHull}(X))}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/demoShape-convexity.png
	height 4.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Convexity"

\end_inset

Convexity of a planar region.
 The convex area is the union of the blue and yellow regions.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[op:Convexify]{Convexify Plugin}
\end_layout

\end_inset

 (Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "op:Convexify"
plural "false"
caps "false"
noprefix "false"

\end_inset

) also allows to compute the convex image corresponding to a binary region.
 
\end_layout

\begin_layout Subsubsection
Elongation
\end_layout

\begin_layout Standard
The MorphoLibJ library provides several shape indices describing the elongation
 of the regions.
 Their values is 1 for a disk, and increase for elongated regions.
\end_layout

\begin_layout Description
The
\begin_inset space ~
\end_inset

ellipse
\begin_inset space ~
\end_inset

elongation
\begin_inset space ~
\end_inset

factor, defined as the ratio of the largest over the smallest axis lengths,
 can be used to quantify the shape of the region.
\end_layout

\begin_layout Description
The
\series bold

\begin_inset space ~
\end_inset


\series default
oriented
\begin_inset space ~
\end_inset

box
\begin_inset space ~
\end_inset

elongation, defined as the ratio of the length of the oriented bounding
 box over its width
\end_layout

\begin_layout Description
The
\begin_inset space ~
\end_inset

geodesic
\begin_inset space ~
\end_inset

elongation, defined as the ratio of the geodesic diameter of the diameter
 of the largest inscribed disk.
\end_layout

\begin_layout Subsubsection
Tortuosity
\end_layout

\begin_layout Standard
The 
\series bold
tortuosity
\series default
 is defined as the ratio of the geodesic diameter over the largest Feret
 diameter.
 
\end_layout

\begin_layout Standard
It describes the complexity of the region.
 Its theroretical value is 1 for convex regions, and increases for regions
 with complex geometries.
\end_layout

\begin_layout Subsection
Plugins
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Analyze-Regions-Plugins"

\end_inset


\end_layout

\begin_layout Standard
Most MorphoLibJ plugins consider the current image as input, that must be
 either binary (only one region is considered), or label (typically the
 result of a connected components labeling, see section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Connected-Components-Labeling"

\end_inset

).
 The output is a results table (ImageJ 
\emph on
ResultsTable
\emph default
) containing one row for each label actually present within the image.
 The spatial calibration of the image is taken into account for most measurement
s.
 All plugins can be found under the 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Analyze
\begin_inset Quotes erd
\end_inset

 menu.
\end_layout

\begin_layout Subsubsection
Analyze Regions
\end_layout

\begin_layout Standard
The 
\series bold
global geometry
\series default
 of particles in 2D images can be characterized with the 
\series bold
Analyze Regions
\series default
 plugin (under 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Analyze\SpecialChar menuseparator
Analyze Regions
\begin_inset Quotes erd
\end_inset

).
 For 2D particles, the area, the perimeter and derived features are implemented.
 
\end_layout

\begin_layout Standard
The options of the dialog correspond to the parameters that can be computed:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Area the area of the regions
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Perimeter the perimeter, measured using discrete version of Crofton formula
 (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Intrinsic-Volumes-2D"

\end_inset

)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Circularity the normalized ratio of the area by the square of the perimeter:
 
\begin_inset Formula $4\pi\cdot A/p^{2}$
\end_inset

.
 Values superior to 1 may appear due to discretization effect.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Equivalent
\begin_inset space ~
\end_inset

Ellipse the position, size and orientation of the equivalent ellipse (see
 section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Geometric-Moment-And-Equivalent-Ellipse"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipse_Elong.
 the elongation of the equivalent ellipse (ratio of axis lengths)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Convexity the convexity, as defined in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Convexity"

\end_inset


\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Max.
\begin_inset space ~
\end_inset

Feret
\begin_inset space ~
\end_inset

Diameter the value of the largest Feret diameter
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Oriented
\begin_inset space ~
\end_inset

Box the position, size and orientation of the oriented box with smallest
 width
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Oriented
\begin_inset space ~
\end_inset

Box
\begin_inset space ~
\end_inset

Elong.
 the elongation of the bounding box (ratio of length over width)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Geodesic
\begin_inset space ~
\end_inset

Diameter the length of the geodesic diameter
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Tortuosity the tortuosity, as the ratio of geodesic diameter over largest
 Feret diameter
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Max
\begin_inset space ~
\end_inset

inscribed
\begin_inset space ~
\end_inset

disc the position and the radius of the largest circle that can be inscribed
 within the region
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Geodesic
\begin_inset space ~
\end_inset

Elong.
 the ratio of geodesic diameter over diameter of inscribed circle.
\end_layout

\begin_layout Standard
The first columns of the resulting ResultsTable contain the label of the
 regions, to facilitate their identification.
\end_layout

\begin_layout Subsubsection
Bounding Box
\end_layout

\begin_layout Standard
The 
\series bold
Bounding Box plugin
\series default
 computes the minimum and maximum 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 coordinates of each region within a binary or label image.
 The result of the plugin comprises the following features:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Label the label of the region measured on the current line (equal to 255
 for binary images)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Box2D.XMin the minimum x coordinate
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Box2D.XMax the maximum x coordinate
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Box2D.YMin the minimum y coordinate
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Box2D.YMax the maximum y coordinate
\end_layout

\begin_layout Standard
It is also possible to draw the resulting bounding box(es) onto another
 image (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Regions-Analysis-Output-1"

\end_inset

-a).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-bbox-ext.png
	width 4.6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Bounding Box
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-ellipse-ext.png
	width 4.6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Equivalent Ellipse
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-maxFeret-ext.png
	width 4.6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Feret Diameter
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Regions-Analysis-Output-1"

\end_inset

Examples of graphical outputs of region analysis plugins.
 (a) Bounding box.
 (b) Equivalent ellipse.
 (c) Max Feret diameter.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Equivalent Ellipse
\end_layout

\begin_layout Standard
The 
\series bold
Equivalent Ellipse plugin
\series default
 computes the equivalent ellipse for each region within a binary or label
 image.
 The result of the plugin comprises the following features:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Label the label of the region measured on the current line (equal to 255
 for binary images)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipse.Center.X the x coordinate of ellipse center
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipse.Center.X the y coordinate of ellipse center
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipse.Radius1 the length of the largest semi-axis
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipse.Radius2 the length of the smallest semi-axis
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipse.Orientation the orientation of the ellipse, in degrees from the horizonta
l.
\end_layout

\begin_layout Standard
It is also possible to draw the resulting ellipse(s) onto another image
 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Regions-Analysis-Output-1"

\end_inset

-b).
\end_layout

\begin_layout Subsubsection
Max Feret Diameter 
\end_layout

\begin_layout Standard
The 
\series bold
Max Feret Diameter plugin
\series default
 computes the length of the largest Feret diameter of each region within
 a binary or label image, as well as the position of the extreme points.
 The result of the plugin comprises the following features:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Label the label of the region measured on the current line (equal to 255
 for bionary images)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Diameter the length of the Feret diameter
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Orientation the orientation of the diameter, in degrees from the horizontal
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
P1.X the x-coordinate of the first extremity
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
P1.Y the y-coordinate of the first extremity
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
P2.X the x-coordinate of the second extremity
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
P2.Y the y-coordinate of the second extremity
\end_layout

\begin_layout Standard
It is also possible to draw the resulting diameter as a line segment onto
 another image (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Regions-Analysis-Output-1"

\end_inset

-c).
\end_layout

\begin_layout Subsubsection
Oriented Box
\end_layout

\begin_layout Standard
The 
\series bold
Oriented Box plugin
\series default
 computes the minimal width oriented bounding box of each region within
 a binary or label image.
 The result of the plugin comprises the following features:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Label the label of the region measured on the current line (equal to 255
 for bionary images)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
OBox.Center.X the x coordinate of oriented box center
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
OBox.Center.X the y coordinate of oriented center
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
OBox.Length the length of the oriented box
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
OBox.Width the width of the oriented box
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
OBox.Orientation the orientation of the box, in degrees from the horizontal.
\end_layout

\begin_layout Standard
It is also possible to draw the resulting oriented boxe(s) onto another
 image (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Regions-Analysis-Output-2"

\end_inset

-a).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-obox-ext.png
	width 4.6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Oriented box
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-geodDiam-ext.png
	width 4.6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Geodesic diameter
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-inscrCircle-ext.png
	width 4.6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Inscribed circle
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Regions-Analysis-Output-2"

\end_inset

Examples of graphical output of region analysis plugins.
 (a) Oriented bounding box.
 (b) Largest geodesic diameter.
 (c) Largest inscribed circle.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Geodesic Diameter
\end_layout

\begin_layout Standard
The 
\series bold
Geodesic Diameter plugin
\series default
 computes several geodesic measures for each particle in a label image.
 The result of the plugin comprises the following features:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Label the label of the region measured on the current line (equal to 255
 for binary images)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Geod.
\begin_inset space ~
\end_inset

Diam.
 the value of the geodesic diameter.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Radius the radius of the largest inscribed circle, which is computed during
 the algorithm.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Geod.
\begin_inset space ~
\end_inset

Elong.
 the ratio of geodesic diameter over the diameter of the largest inscribed
 circle.
 The values range from 1 for nearly round particles and increases for elongated
 particles.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
xi,
\begin_inset space ~
\end_inset

yi coordinates of the largest inscribed circle.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
x1,
\begin_inset space ~
\end_inset

y1 coordinates of one of the geodesic extremities of the particle.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
x2,
\begin_inset space ~
\end_inset

y2 coordinates of another geodesic extremity of the particle.
\end_layout

\begin_layout Standard
It is also possible to draw the resulting geodesic paths onto another image
 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Regions-Analysis-Output-2"

\end_inset

-b).
\end_layout

\begin_layout Subsubsection
Largest inscribed circle
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Largest-inscribed-circle-plugin"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
largest inscribed circle plugin 
\series default
computes for each label the largest disk that can be enclosed within the
 corresponding particle.
 The plugin opens a dialog that allows to choose the label image to characterize
, the choice of the method for computing distance, and eventually the image
 on which overlaid circles can be drawn.
 The output of the plugin includes the following information:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Label the label of the region measured on the current line (equal to 255
 for bionary images)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
inscrCircle.Center.X the x-coordinate of the inscribed circle.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
inscrCircle.Center.Y the y-coordinate of the inscribed circle.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
inscrCircle.Radius the radius of the inscribed circle.
\end_layout

\begin_layout Standard
It is also possible to draw the resulting circle(s) onto another image (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Regions-Analysis-Output-2"

\end_inset

-c).
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Region Analysis 3D
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Region-Analysis-3D"

\end_inset


\end_layout

\begin_layout Standard
Region analysis may also be performed on 3D images.
 As for 2D images, input images may be either binary (corresponding to a
 single region), or contain the labels of the different regions to analyze.
\end_layout

\begin_layout Subsection
Intrinsic volumes
\end_layout

\begin_layout Standard
For 3D particles, intrinsic volumes correspond to the 
\series bold
volume
\series default
, the
\series bold
 surface area
\series default
, the 
\series bold
mean breadth
\series default
 and the 
\series bold
3D Euler number
\series default
.
 While the volume and the surface area are rather common, the latter two
 are less intuitive.
 Both the mean breadth and the 3D Euler number can be related to the curvatures
 that can be measured on smooth surfaces.
\end_layout

\begin_layout Subsubsection
Volume
\end_layout

\begin_layout Standard
The 
\series bold
volume
\series default
 and the 
\series bold
surface area
\series default
 of a set 
\begin_inset Formula $X$
\end_inset

 with smooth surface 
\begin_inset Formula $\partial X$
\end_inset

 can be defined using integrals over the set, or over its boundary:
\begin_inset Formula 
\begin{align}
V(X) & =\int_{X}dx
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The measurement of 
\series bold
volume of 3D region
\series default
 is as straightforward as in 2D: it consists in counting the voxels that
 belong to the 3D region, multiplied by the volume of an individual voxel.
 
\end_layout

\begin_layout Subsubsection
Surface area
\end_layout

\begin_layout Standard
The 
\series bold
surface area
\series default
 of a set 
\begin_inset Formula $X$
\end_inset

 with smooth surface 
\begin_inset Formula $\partial X$
\end_inset

 can be defined using integral over its boundary:
\begin_inset Formula 
\begin{align}
S(X) & =\int_{\partial X}dx
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
measurement of surface area 
\series default
from 3D binary images follows the same principle as the estimation of perimeter.
 One considers the intersections of the region with straight lines, and
 averages over all possible directions 
\begin_inset CommandInset citation
LatexCommand citep
key "Lang2001,Legland2007"
literal "true"

\end_inset

.
 The number of directions is typically chosen equal to 3 (the three main
 axes in image), or 13 (by considering also diagonals).
 As for perimeter estimation, surface area estimation is usually biased,
 but is usually more precise than measuring the surface area of the polygonal
 mesh reconstructed from binary images 
\begin_inset CommandInset citation
LatexCommand citep
key "Lehmann_2012_ij"
literal "true"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsubsection
Mean breadth
\end_layout

\begin_layout Standard
The 
\series bold
mean breadth
\series default
, also known as the mean width or the mean diameter, is a feature that quantifie
s the size of a set as an average diameter.
 In the case of a convex set, the average breadth corresponds to the average
 of the caliper diameter (or Feret diameter) measured over all directions
 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Mean-breadth"
plural "false"
caps "false"
noprefix "false"

\end_inset

-a).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/convexShape-projDiameter.png
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convex set.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/demoShape-projDiameter.png
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Non-Convex Set
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Mean-breadth"

\end_inset

Mean breadth of a convex (a) and of a non convex (b) set.
 In the case of a non-convex set, the concavities are taken into account
 for measuring the diameters.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the case of a non-convex set, the concavities are taken into account
 for measuring the diameters, resulting in 
\begin_inset Quotes eld
\end_inset


\series bold
total projected diameter
\series default

\begin_inset Quotes erd
\end_inset

 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Mean-breadth"
plural "false"
caps "false"
noprefix "false"

\end_inset

-b).
 For 3D sets, the measurements of total projected diameter consists in measuring
 the (2D) Euler number of the intersection of the set with planes orthogonal
 to the direction 
\begin_inset CommandInset citation
LatexCommand citep
key "Serra_1982"
literal "false"

\end_inset

.
 The average of total projected diameter over 
\begin_inset Formula $\Omega$
\end_inset

, the set of all directions, results in the mean breadth 
\begin_inset Formula $\bar{b}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{b}(X)=\int_{\Omega}D_{\omega}(X)\,d\omega
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For a three-dimensional set 
\begin_inset Formula $X$
\end_inset

 with smooth boundary 
\begin_inset Formula $\partial X$
\end_inset

, an alternative definition of the mean breadth is based on integral geometry
 
\begin_inset CommandInset citation
LatexCommand citep
key "Serra_1982,Ohser2009"
literal "true"

\end_inset

.
 For each point 
\begin_inset Formula $x$
\end_inset

 of the boundary 
\begin_inset Formula $\partial X$
\end_inset

, two curvatures 
\begin_inset Formula $\kappa_{1}(x)$
\end_inset

 and 
\begin_inset Formula $\kappa_{2}(x)$
\end_inset

 can be defined.
 The integral of their average over the surface, known as the 
\series bold
integral of the mean curvature
\series default
, is proportional to the mean breadth: 
\begin_inset Formula 
\begin{align}
\bar{b}(X) & =\frac{1}{2\pi}\int_{\partial X}\frac{\kappa_{1}(x)+\kappa_{2}(x)}{2}dx
\end{align}

\end_inset


\end_layout

\begin_layout Standard
In practice, the mean breadth may be computed from digital binary images
 by considering elementary configurations of 
\begin_inset Formula $2\times2\times2$
\end_inset

 voxels, identifying the contribution of this configuration to the total
 mean breadth, and combining with the histogram of binary configuration
 within the image 
\begin_inset CommandInset citation
LatexCommand citep
key "Ohser2009,Legland2007"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Euler number 
\end_layout

\begin_layout Standard
As in 2D, the 
\series bold
3D Euler number 
\series default
also quantifies the topology of a set.
 It corresponds to the number of connected components, minus the number
 of 
\begin_inset Quotes eld
\end_inset

handles
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

tunnels
\begin_inset Quotes eld
\end_inset

 through the structure, plus the number of bubbles within the particles
\begin_inset CommandInset citation
LatexCommand citep
key "Serra_1982,Ohser2009"
literal "true"

\end_inset

, see Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Euler-Number-3d"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/euler-number-3d.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Euler-Number-3d"

\end_inset

Euler Number of a 3D particle.
 The Euler number equals -1, corresponding to the subtraction of 1 connected
 components minus two handles.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For a set 
\begin_inset Formula $X$
\end_inset

 with smooth boundary 
\begin_inset Formula $\partial X$
\end_inset

, the 3D Euler number is proportionnal to the integral of the 
\series bold
gaussian curvature
\series default
, corresponding to the product of the curvatures:
\begin_inset Formula 
\begin{align}
\chi(X) & =\frac{1}{4\pi}\int_{\partial X}\kappa_{1}(x)\cdot\kappa_{2}(x)dx
\end{align}

\end_inset


\end_layout

\begin_layout Standard
As for 2D images, the measurement of Euler number from 3D images also relies
 on the choice of a connectivity between adjacent voxels.
 In 3D, the 6-connectivity considers the neighbors in the three main directions
 within the image, whereas the 26 connectivity also considers the diagonals.
 Other connectivities have been proposed but are not implemented in MorphoLibJ
 
\begin_inset CommandInset citation
LatexCommand citep
key "Ohser2009"
literal "true"

\end_inset

.
 Note that depending on the choice of connectivity, very different results
 may be obtained.
 Such differences may result from the small irregularities arising in images
 after segmentation.
 A typical work-around is to regularize the binary or label image, for example
 by applying 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[subsec:Opening-Closing]{
\end_layout

\end_inset

morphological opening and / or closing
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Geometric moments and equivalent Ellipsoid
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Geometric-Moments-3D"

\end_inset


\end_layout

\begin_layout Standard
The mathematical definition of the
\series bold
 geometric moments
\series default
 for 3D regions is similar to the 2D case:
\begin_inset Formula 
\begin{align}
m_{pqr}(X) & =\int\int\int I_{X}(x,y,z)x^{p}y^{q}z^{r}\cdot dx\cdot dy\cdot dz\label{eq:Moment-of-X-3D}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The first moment 
\begin_inset Formula $m_{000}(X)$
\end_inset

 corresponds to the volume of the particle.
 The normalization of the first-order moments by the volume leads to the
 3D centroid of the particle.
 The second-order moments can be used to compute an equivalent ellipsoid,
 defined as the ellipsoid with the same moments up to the second order as
 the region of interest (see appendix
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "chap:Equivalent-Ellipsoid-Computation"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Minisec
Equivalent Ellipsoid plugin
\end_layout

\begin_layout Standard
Returns the parameters of the equivalent ellipsoid into a ResultsTable with
 the following columns:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipsoid.Center.X the x-coordinate of the center of gravity
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipsoid.Center.Y the y-coordinate of the center of gravity
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipsoid.Center.Z the z-coordinate of the center of gravity
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipsoid.Radius1 the length of the largest semi-axis
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipsoid.Radius2 the length of the medium semi-axis
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipsoid.Radius3 the length of the smallest semi-axis
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipsoid.Phi the azimut of the projection of the major axis on the XY plane,
 in degrees (
\begin_inset Quotes eld
\end_inset

yaw
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipsoid.Theta the elevation of the major axis on the XY plane, in degrees
 (
\begin_inset Quotes eld
\end_inset

pitch
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Ellipsoid.Psi the rotation of the ellipsoid around the main axis (
\begin_inset Quotes eld
\end_inset

roll
\begin_inset Quotes erd
\end_inset

), in degrees
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/ellipsoid-angles.png
	width 60text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Ellipsoid-Angles"

\end_inset

Definition of angles for representing the orientation of equivalent ellipsoid.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The three angles correspond to a succession of three rotations (see Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Ellipsoid-Angles"

\end_inset

):
\end_layout

\begin_layout Enumerate
a rotation 
\begin_inset Formula $R_{x}(\psi)$
\end_inset

 about the 
\begin_inset Formula $x$
\end_inset

-axis by 
\begin_inset Formula $\psi$
\end_inset

 degrees (positive when the 
\begin_inset Formula $y$
\end_inset

-axis moves towards the 
\begin_inset Formula $z$
\end_inset

-axis)
\end_layout

\begin_layout Enumerate
a rotation 
\begin_inset Formula $R_{y}(\theta)$
\end_inset

 about the 
\begin_inset Formula $y$
\end_inset

-axis by 
\begin_inset Formula $\theta$
\end_inset

 degrees (positive when the 
\begin_inset Formula $z$
\end_inset

-axis moves towards the 
\begin_inset Formula $x$
\end_inset

-axis)
\end_layout

\begin_layout Enumerate
a rotation 
\begin_inset Formula $R_{z}(\varphi)$
\end_inset

 about the 
\begin_inset Formula $z$
\end_inset

-axis by 
\begin_inset Formula $\varphi$
\end_inset

 degrees (positive when the 
\begin_inset Formula $x$
\end_inset

-axis moves towards the 
\begin_inset Formula $y$
\end_inset

-axis)
\end_layout

\begin_layout Standard
The global rotation matrix is assimilated to the product 
\begin_inset Formula $R_{z}(\varphi)\cdot R_{y}(\theta)\cdot R_{x}(\psi)$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
3D Shape indices
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Shape-Indices-3D"

\end_inset


\end_layout

\begin_layout Standard
In 3D, shape indices can be also defined to quantify the shape of the regions
 independently of their size.
\end_layout

\begin_layout Minisec
Sphericity
\end_layout

\begin_layout Standard
The 
\series bold
sphericity index
\series default
 is the generalisation of the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[subsec:Circularity]{
\end_layout

\end_inset

circularity
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 to 3D.
 It can be defined as the ratio of the squared volume over the cube of the
 surface area, normalized such that the value for a ball equals one:
\begin_inset Formula 
\begin{eqnarray}
\mbox{sphericity} & = & 36\pi\frac{V^{2}}{S^{3}}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Other shape factors may be obtained by computing normalized ratios of volume
 with mean breadth, or surface with mean breadth.
 Their interpretation is however often not obvious.
\end_layout

\begin_layout Minisec
Elongation
\end_layout

\begin_layout Standard
It is also possible to compute elongation factors from ratio of the radiuses
 if the equivalent ellipsoid.
 With three radius values, three ratios can be computed.
 In MorphoLibJ, the largest radius is used as numerator, resulting in the
 following ratios:
\begin_inset Formula 
\[
e_{12}=\frac{r_{1}}{r_{2}},\,e_{23}=\frac{r_{2}}{r_{3}},\,e_{13}=\frac{r_{1}}{r_{3}},\text{ with }r_{1}\ge r_{2}\ge r_{3}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Plugins
\end_layout

\begin_layout Minisec
Analyze Regions 3D
\end_layout

\begin_layout Standard
The plugin 
\begin_inset Quotes eld
\end_inset

Analyze Regions 3D
\begin_inset Quotes erd
\end_inset

 gathers most 3D measures implemented within the MorphoLibJ library.
 It can be found under 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Analyze\SpecialChar menuseparator
Analyze Regions 3D
\begin_inset Quotes erd
\end_inset

.
 The results are provided in an ImageJ 
\emph on
ResultsTable
\emph default
, whose name contains the name of the original image.
\end_layout

\begin_layout Minisec
Interface surface area
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Interface-Surface-Area"

\end_inset

The
\series bold
 Interface Surface Area
\series default
 plugin allows to measure the surface area of the interface between two
 labels within a 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[sec:label-images]{
\end_layout

\end_inset

3D label image
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

.
 The different options are:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Label
\begin_inset space ~
\end_inset

1 the first label
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Label
\begin_inset space ~
\end_inset

2 the second label
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Method the number of directions to use for the computation (either 3 or
 13).
\end_layout

\begin_layout Standard
One of the two labels can have the value 0.
 In this case, the interface of the other label with the background is measured.
\end_layout

\begin_layout Standard
If the two regions do not touch anywhere, the resulting value will be 0.
 The 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[sec:Region-Adjacency-Graph]{
\end_layout

\end_inset

region adjacency graph
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Region-Adjacency-Graph"
plural "false"
caps "false"
noprefix "false"

\end_inset

) can be used to identify neighbor regions.
\end_layout

\begin_layout Section
Intensity measurements
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Intensity-Measurements"

\end_inset


\end_layout

\begin_layout Standard
Other measurements are provided for pairs of grayscale and label 2D or 3D
 images (
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Analyze\SpecialChar menuseparator
Intensity Measurements 2D/3D
\begin_inset Quotes erd
\end_inset

).
 The label image can correspond to a segmented particle, or to a more generic
 region of interest.
\end_layout

\begin_layout Standard
The plugin calculates the mean, standard deviation, maximum, minimum, median,
 mode, skewness and kurtosis of the intensity value distribution of each
 labeled region in the grayscale image as well as the same statistics of
 the neighboring (adjacent) regions of each of the labels.
 If a regions has no adjacent labels, their measurements will appear as
 NaN (not a number).
 The results are displayed in an ImageJ 
\emph on
ResultsTable
\emph default
.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Label Overlap measures
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Label-Overlap-measures"

\end_inset


\end_layout

\begin_layout Standard
Given two label images, there are different measures that allow us to evaluate
 the overlap agreement (or error) between the labels.
 Following 
\begin_inset CommandInset citation
LatexCommand citet
key "tustison2009introducing"
literal "true"

\end_inset

, and given a source image 
\begin_inset ERT
status open

\begin_layout Plain Layout

$S$
\end_layout

\end_inset

 and a target image 
\begin_inset ERT
status open

\begin_layout Plain Layout

$T$
\end_layout

\end_inset

, this plugin provides the following overlap measurements in two different
 result tables (one with the total values for all labels and one with values
 for individual labels):
\end_layout

\begin_layout Itemize
Target Overlap for each individual labeled region 
\begin_inset ERT
status open

\begin_layout Plain Layout

$r$
\end_layout

\end_inset

:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
\ensuremath{TO_{r}=\frac{|S_{r}\cap T_{r}|}{|T_{r}|}}
\]

\end_inset


\end_layout

\begin_layout Itemize
Total Overlap (for all regions):
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
\ensuremath{TO=\frac{\sum_{r}{|S_{r}\cap T_{r}|}}{\sum_{r}{|T_{r}|}}}
\]

\end_inset


\end_layout

\begin_layout Itemize
Jaccard Index or Union Overlap for each individual labeled region 
\begin_inset ERT
status open

\begin_layout Plain Layout

$r$
\end_layout

\end_inset

:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
UO_{r}=\frac{|S_{r}\cap T_{r}|}{|S_{r}\cup T_{r}|}
\]

\end_inset


\end_layout

\begin_layout Itemize
Jaccard Index or Union Overlap for all regions:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
UO=\frac{\sum_{r}|S_{r}\cap T_{r}|}{\sum_{r}|S_{r}\cup T_{r}|}
\]

\end_inset


\end_layout

\begin_layout Itemize
Dice Coefficient or Mean Overlap for each individual labeled region 
\begin_inset ERT
status open

\begin_layout Plain Layout

$r$
\end_layout

\end_inset

:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
MO_{r}=2\frac{|S_{r}\cap T_{r}|}{|S_{r}|+|T_{r}|}
\]

\end_inset


\end_layout

\begin_layout Itemize
Dice Coefficient or Mean Overlap for all regions:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
MO=2\frac{\sum_{r}|S_{r}\cap T_{r}|}{\sum_{r}\left(|S_{r}|+|T_{r}|\right)}
\]

\end_inset


\end_layout

\begin_layout Itemize
Volume Similarity for each individual labeled region 
\begin_inset ERT
status open

\begin_layout Plain Layout

$r$
\end_layout

\end_inset

:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
VS_{r}=2\frac{|S_{r}|-|T_{r}|}{|S_{r}|+|T_{r}|}
\]

\end_inset


\end_layout

\begin_layout Itemize
Volume Similarity for all regions:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
VS=2\frac{\sum_{r}\left(|S_{r}|-|T_{r}|\right)}{\sum_{r}\left(|S_{r}|+|T_{r}|\right)}
\]

\end_inset


\end_layout

\begin_layout Itemize
False Negative Error for each individual labeled region 
\begin_inset ERT
status open

\begin_layout Plain Layout

$r$
\end_layout

\end_inset

:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
FN_{r}=\frac{|T_{r}\setminus S_{r}|}{|T_{r}|}
\]

\end_inset


\end_layout

\begin_layout Itemize
False Negative Error for all regions:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
FN=\frac{\sum_{r}|T_{r}\setminus S_{r}|}{\sum_{r}|T_{r}|}
\]

\end_inset


\end_layout

\begin_layout Itemize
False Positive Error for each individual labeled region 
\begin_inset ERT
status open

\begin_layout Plain Layout

$r$
\end_layout

\end_inset

:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
FP_{r}=\frac{|S_{r}\setminus T_{r}|}{|S_{r}|}
\]

\end_inset


\end_layout

\begin_layout Itemize
False Positive Error for all regions:
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\[
FP=\frac{\sum_{r}|S{}_{r}\setminus T{}_{r}|}{\sum_{r}|S_{r}|}
\]

\end_inset


\end_layout

\begin_layout Section
Microstructure analysis
\end_layout

\begin_layout Standard
In some cases, the content of the image to analyze is better seen as a represent
ative observation of a stationnary binary process.
 This context arise frequently in material sciences or in the study of porous
 media such as bone material 
\begin_inset CommandInset citation
LatexCommand citep
key "Lang2001,Ohser2009,Doube2010"
literal "true"

\end_inset

.
 An example of such image (obtained from a dairy gel) is represented in
 Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Binary-Microstructure"

\end_inset

-a.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/microstructure/gel-seg-crop2-inv.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Sample image
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/microstructure/gel-crop-ovrBlue.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Perimeter density
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Binary-Microstructure"

\end_inset

Analysis of binary microstrucure.
 (a) Original binary image.
 (b) Estimation of perimeter density.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
To analyze such images, the notion of particle analysis is not relevant
 anymore.
 One possibility is to adapt the definitions of intrinsic volumes, by considerin
g that the image corresponds to a sampling window.
 This induces the two modifications:
\end_layout

\begin_layout Enumerate
the integral over boundaries are restricted to the boundary 
\series bold
within the sampling window
\series default
 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Binary-Microstructure"

\end_inset

-b)
\end_layout

\begin_layout Enumerate
the result is normalized by the area (or the volume) of the sampling window.
\end_layout

\begin_layout Standard
For the planar case, one obtains the following definitions:
\begin_inset Formula 
\begin{align}
A_{A}(X) & =\frac{\int_{X\cap W}dx}{A(W)}\\
P_{A}(X) & =\frac{\int_{\partial X\cap W}dx}{A(W)}\\
\chi_{A}(X) & =\frac{\int_{\partial X\cap W}\kappa(x)dx}{A(W)}
\end{align}

\end_inset


\end_layout

\begin_layout Standard
The plugins are available in 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Analyze\SpecialChar menuseparator
Microstructure Analysis
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Analyze\SpecialChar menuseparator
Microstructure 3D
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
covariance
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Section
Texture analysis
\end_layout

\begin_layout Plain Layout
Think about incorporating gray level granulometries
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Binary images
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:Binary-Images"

\end_inset


\end_layout

\begin_layout Standard
Binary and label images are a convenient way of representing the result
 of segmentation algorithms.
 The MorphoLibJ library provides several plugins for the processing and
 the management of binary and label images.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Distance transforms
\end_layout

\begin_layout Subsection
Distance transform
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Distance-Transform"

\end_inset


\end_layout

\begin_layout Standard
When analyzing images, it is often necessary to compute distances to a particula
r structure or position.
 A convenient operator for binary images is the
\series bold
 distance transform
\series default
.
 Its principle is to compute, for each foreground pixel, the distance to
 the nearest background pixel (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Distance-Transform"

\end_inset

).
 The result is commonly referred to as 
\series bold
Distance Map
\series default
.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/leaf/IJ-leaf-bin.tif
	width 43text%

\end_inset

 
\begin_inset Graphics
	filename images/leaf/IJ-leaf-bin-dist_FireRGB.png
	width 43text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Distance-Transform"

\end_inset

Binary image, and result of computation of the distance transform.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Chamfer distances
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Chamfer-Distances"

\end_inset


\end_layout

\begin_layout Standard
Several methods exist for computing distance maps.
 The MorphoLibJ library implements distance transforms based on 
\series bold
chamfer masks
\series default
, that are simpler to compute than exact Euclidean distance 
\begin_inset CommandInset citation
LatexCommand citep
key "Rosenfeld1968,Borgefors1984,Borgefors1986"
literal "true"

\end_inset

.
 The principle is to update the distance associated to each pixel by considering
 the distances within a small neighborhood, and adding a weight depending
 on the relative location of the neighbor (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Mask-Neighborhoods"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/chamferMask_neighborhoods.png
	lyxscale 50
	width 55text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Chamfer-Mask-Neighborhoods"

\end_inset

Computation of distance maps using chamfer masks.
 The distance associated to each pixel is updated according to the distances
 associated to the neighbor pixels.
 Left: 3x3 neighborhood.
 Right: 5x5 neighborhood.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In practice, using integer weights may result in faster computations.
 This also allows to store the resulting distance map within 16-bits grayscale
 images, resulting in more efficient memory usage than floating point computatio
n.
\end_layout

\begin_layout Standard
Several typical choices for chamfer weights are illustrated on Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Weights-2D"

\end_inset

:
\end_layout

\begin_layout Itemize
The simplest one is the 
\series bold

\begin_inset Quotes eld
\end_inset

Chessboard
\begin_inset Quotes erd
\end_inset

 mask
\series default
, that considers distance equal to 1 for both orthogonal and diagonal neighbors
 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Weights-2D"

\end_inset

-a).
 The propagation of distances from a center pixel follow a square pattern.
 
\end_layout

\begin_layout Itemize
The 
\series bold
City-block
\series default
 or 
\series bold
Manhattan mask
\series default
 uses a weight equal to 2 for diagonal neighbord, resulting in diamond-like
 propagation of distance (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Weights-2D"

\end_inset

-b).
 
\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset


\series bold
Borgefors
\series default

\begin_inset Quotes erd
\end_inset

 distance uses the weight 3 for orthogonal pixels and 4 for diagonal pixels
 
\begin_inset CommandInset citation
LatexCommand citep
key "Borgefors1986"
literal "false"

\end_inset

.
 It was claimed to be best integer approximation when considering the 3-by-3
 neighborhood (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Weights-2D"

\end_inset

-c).
 
\end_layout

\begin_layout Itemize
The 
\begin_inset Quotes eld
\end_inset


\series bold
Chess-knight
\series default

\begin_inset Quotes erd
\end_inset

 distance 
\begin_inset CommandInset citation
LatexCommand citep
key "Das_1988_PRL"
literal "false"

\end_inset

 also takes into account the pixels located at a distance from 
\begin_inset Formula $(\pm1,\pm2)$
\end_inset

 in any direction (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Weights-2D"

\end_inset

-d).
 It is usually the best choice, as it considers a larger neighborhood.
\end_layout

\begin_layout Itemize
The MorphoLibJ library also provides chamfer masks with four weights, as
 proposed by 
\begin_inset CommandInset citation
LatexCommand citet
key "Verwer_1989_PAMI"
literal "false"

\end_inset

.
 The fourth weight corresponds to pixels located at a distance of 
\begin_inset Formula $(\pm1,\pm3)$
\end_inset

 from the reference pixel, in any direction.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/distMap_11_digits_fire.png
	lyxscale 75
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Chessboard (1,1)
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/distMap_12_digits_fire.png
	lyxscale 75
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
City-block (1,2)
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/distMap_34_digits_fire.png
	lyxscale 75
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Borgefors (3,4)
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/distMap_5711_digits_fire.png
	lyxscale 75
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Chess-knight (5,7,11)
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Chamfer-Weights-2D"

\end_inset

Several examples of distance maps computed with different chamfer masks.
 For each image, the distance to the lower-left pixel is represented both
 with numeric value and with color code.
 Numbers in brackets correspond to the weights associated with orthogonal
 and diagonal directions.
 For chess-knight weights, the weight 11 corresponds to a shift of 
\begin_inset Formula $(\pm1,\pm2)$
\end_inset

 pixels in any direction.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
As chamfer masks are only an approximation of the real Euclidean distance,
 some differences are expected compared to the actual Euclidean distance
 map.
 Using larger weights reduces the relative error, but the largest possible
 distance (that depends on the bit-depth of the output image) may be reached
 faster, leading to 
\begin_inset Quotes eld
\end_inset

saturation
\begin_inset Quotes erd
\end_inset

 of the distance map.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsubsection
Chamfer distance computation
\end_layout

\begin_layout Standard
A great advantage of chamfer masks is that they allow fast computation of
 distance maps by dividing the process into two passes.
 During the first pass (in 
\begin_inset Quotes eld
\end_inset

forward
\begin_inset Quotes erd
\end_inset

 direction), pixels are iterated from left to right and from top to bottom.
 The distance associated to each pixel is updated based on pixels already
 updated, located upper and on the left (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Masks"
plural "false"
caps "false"
noprefix "false"

\end_inset

-a).
 During the second pass, pixels are iterated 
\begin_inset Quotes eld
\end_inset

backward
\begin_inset Quotes erd
\end_inset

 (from right to left and from bottom to top), and the distance map is updated
 based on the pixels located bottom and on the right (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Masks"
plural "false"
caps "false"
noprefix "false"

\end_inset

-b).
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/chamferMask_fwd.png
	lyxscale 50
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Forward mask
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/chamferMask_bwd.png
	lyxscale 50
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Backward mask
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Chamfer-Masks"

\end_inset

Implementation of two-passes chamfer distances.
 The 5x5 chamfer mask is decomposed into two 
\begin_inset Quotes eld
\end_inset

half-masks
\begin_inset Quotes erd
\end_inset

, one for each pass.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
3D chamfer masks
\end_layout

\begin_layout Standard
For 3D images, chamfer distance maps can be computed using the same principle.
 Three different chamfer weights can be associated to the 6 orthogonal neighbors
, to the 12 neighbor voxel sharing an edge with reference voxel, and to
 the 8 neighbor voxel sharing only a corner with reference voxel.
 The results can be represented via the discrete ball, obtained by applying
 a threshold on the distance map computed from a single voxel located in
 the center of the image (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Masks-3D-1"

\end_inset

).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/ball3d_r20_d111.png
	lyxscale 50
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Chessboard (1,1,1)
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/ball3d_r20_d123.png
	lyxscale 50
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
City-block (1,2,3)
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/ball3d_r20_dBorgefors.png
	lyxscale 50
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Borgefors (3,4,5)
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Chamfer-Masks-3D-1"

\end_inset

Discrete 3D balls resulting from different chamfer distances.
 The distance map is computed to the center voxel, then the result is thresholde
d and represented in 3D.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Several 3D chamfer distances can be used:
\end_layout

\begin_layout Itemize
The (3D) chessboard distance uses the same weight for all the 26 neighbors.
 This results in distance propagation in a cubic shape pattern (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Masks-3D-1"

\end_inset

-a).
\end_layout

\begin_layout Itemize
The (3D) Manhattan distance considers weights triplet equal to 
\begin_inset Formula $(1,2,3)$
\end_inset

, resulting in octagon-like distance propagation (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Masks-3D-1"

\end_inset

-b).
\end_layout

\begin_layout Itemize
The Borgefors weights (3,4,5) usually give a good approximation of the Euclidean
 distance when considering only the 3-by-3-by-3 neighborhood (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Masks-3D-1"

\end_inset

-c).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/ball3d_r100_W4.png
	lyxscale 50
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Svensson (3,4,5,7)
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/ball3d_r100_W5.png
	lyxscale 50
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Five weights
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/ball3d_r100_W6.png
	lyxscale 50
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Six weights
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Chamfer-Masks-3D-2"

\end_inset

Enhancement of 3D distance maps when using larger chamfer masks.
 Masks are based on (a) four, (b) five, or (c) six weights.
 Using All images represent the threshold of the distance 100 from image
 center.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Larger neighborhood may be considered, resulting in a better approximation
 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Chamfer-Masks-3D-2"
plural "false"
caps "false"
noprefix "false"

\end_inset

):
\end_layout

\begin_layout Itemize
Svensson and Borgefors found that adding a fourth weight for voxels shifted
 by 
\begin_inset Formula $(\pm1,\pm1,\pm2)$
\end_inset

 in any direction results in a substantial error reduction while preserving
 a low complexity of the algorithm 
\begin_inset CommandInset citation
LatexCommand citep
key "Svensson_Borgefors_2002_prl,Svensson_Borgefors_2002_cviu"
literal "true"

\end_inset

.
 
\end_layout

\begin_layout Itemize
Starting from version 1.5, MorphoLibJ allows using up to six weights (correspondi
ng to the complete 5by5-by5 neighborhood).
\end_layout

\begin_layout Standard
As for the 2D case, the choice of the chamfer distance is compromise between
 the accuracy (larger neighborhood and weights are usually more accurate)
 and the largest distance that can be represented.
\end_layout

\begin_layout Subsubsection
Case of label images
\end_layout

\begin_layout Standard
The distance transform algorithm may also be applied to label images.
 However, as regions corresponding to each label may be continuous, the
 algorithm need to be adapted.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-basins.png
	width 35text%

\end_inset

 
\begin_inset Graphics
	filename images/blobs/blobs-basins-distmap-fire.png
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Distance-Transform-Label-Image"

\end_inset

An example of a label image containing contiguous regions, and result of
 the distance transform applied on the label image.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For label image, distances are computed between each foreground (greater
 than zero) pixel and the nearest pixel with a different value : either
 0 (the background) or another label.
 Distances are propagated as for binary images, using a pair of forward
 and backward passes.
 An example of result is provided on Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Distance-Transform-Label-Image"

\end_inset

.
\end_layout

\begin_layout Subsubsection
Plugin usage
\end_layout

\begin_layout Standard
The MorphoLibJ library provides two plugins for computing chamfer distance
 maps for 2D or 3D binary images:
\end_layout

\begin_layout Minisec
Chamfer Distance Map 
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Chamfer-Distance-Map"

\end_inset

computes a chamfer distance map from a binary or label image, between each
 foreground pixel to the nearest pixel with a different value (either background
 or another label).
\end_layout

\begin_layout Minisec
Chamfer Distance Map 3D
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Chamfer-Distance-Map-3d"

\end_inset

computes a chamfer distance map from a 3D binary image between each foreground
 voxel to the nearest voxel with a different value (either background or
 another label).
 Input image is assumed to have cubic voxels.
\end_layout

\begin_layout Standard
For each plugin, a dialog opens and allows to select the following parameters:
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Distances the weights of the chamfer mask used for computing the distance
 map
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Output
\begin_inset space ~
\end_inset

Type specify if the result should be stored in 16-bits image (uses less
 memory), or 32-bits image (larger distances can be computed).
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Normalize specify if the resulting map should be divided by the weight associate
d with orthogonal pixels or voxels.
 This may be useful for masks with large weights to have resulting distances
 comparable to Euclidean ones.
\end_layout

\begin_layout Labeling
\labelwidthstring 00.00.0000
Preview (2D only) enable the preview of the result
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Subsection
Geodesic distance transform
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Geodesic-Distance-Transform"

\end_inset


\end_layout

\begin_layout Standard
In some cases it may be useful to restrict the propagation of distances
 to a specific region or mask.
 For example, one may be interested in the distance between two points in
 a vasculature network, while staying within the network.
 The 
\series bold
geodesic distance transform
\series default
 consists in computing the distance from a given binary marker, while constraini
ng the propagation of the distance within a binary mask.
 An illustration is given in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Geodesic-Distance-Map"

\end_inset

, and a 3D example is shown in Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Geodesic-Distance-Map-3d"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/36_manual1-ovr.png
	lyxscale 50
	width 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/36_manual1-geoddist-rgb.png
	lyxscale 50
	width 5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Geodesic distance map
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Geodesic-Distance-Map"

\end_inset

Computation of the geodesic distance map on a binary image from the DRIVE
 database 
\begin_inset CommandInset citation
LatexCommand citep
key "Staal_2004_tmi"
literal "true"

\end_inset

.
 (a) Original image with marker superimposed in red.
 (b) Color representation of the geodesic distance map: hot colors correspond
 to large distances, cold colors correspond to small distances.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Geodesic distance maps are computed by propagating chamfer weights, as for
 the computation of distance maps.
 As chamfer weights are only an approximation of the real Euclidean distance,
 some differences are expected compared to the actual geodesic distance.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/batCochlea-geoddist3d-rgb2.png
	lyxscale 50
	width 6cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Geodesic-Distance-Map-3d"

\end_inset

Computation of the geodesic distance map on a 3D binary image.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Minisec
Geodesic Distance Map
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Geodesic-Distance-Map"

\end_inset

Computes the geodesic distance between each foreground pixel of a binary
 mask image to the closest pixel of a marker image, while staying within
 the particle represented by the mask image (See Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Geodesic-Distance-Map"

\end_inset

).
\end_layout

\begin_layout Minisec
Interactive Geodesic Distance
\begin_inset space ~
\end_inset

Map
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Interactive-Geodesic-Distance-Map"

\end_inset

Computes the geodesic distance between each foreground pixel of a the currently
 selected image (considered the mask image) to the closest pixel of a marker
 image defined by the user ROIs, while staying within the particle represented
 by the mask image.
\end_layout

\begin_layout Minisec
Geodesic Distance Map 3D
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Geodesic-Distance-Map-3d"

\end_inset

Computes the 3D geodesic distance between each foreground pixel of a binary
 mask image to the closest pixel of a marker image, while staying within
 the particle represented by the mask image (See Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Geodesic-Distance-Map-3d"

\end_inset

).
 Binary image is assumed to have cubic voxels.
\end_layout

\begin_layout Section
Connected component labeling
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Connected-Components-Labeling"

\end_inset


\end_layout

\begin_layout Standard
The different structures within a binary images can be individualised by
 using a connected 
\series bold
component labeling algorithm
\series default
.
 The result is an image containing integer label, each label corresponding
 to a set of connected pixels or voxels (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Connected-component-labeling"

\end_inset

).
 Label images can be represented with colored LUT to help distinguish adjacent
 labels (see section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Visualization-of-Label-Images"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-binary-crop-ext.png
	width 28text%

\end_inset

 
\begin_inset Graphics
	filename images/grains/grains-binary-crop-lbl-ext.png
	width 28text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Connected-component-labeling"

\end_inset

Binary image, and result of connected components labeling.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The result of a connected component labeling depends on the chosen 
\series bold
connectivity
\series default
, that corresponds to the convention used to decide wether two pixels or
 voxels are connected or not (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Connectivity-2D"

\end_inset

).
 See also Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Digital-Connectivity"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
For planar images, a typical choice is the 4-connectivity, that considers
 only the orthogonal neighbors of a given pixel (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Connectivity-2D"

\end_inset

-b).
 When two components touch only via a corner, they are not considered as
 the same one.
 The 8-connectivity is an alternative that also considers the diagonal pixels
 as neighbors (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Connectivity-2D"

\end_inset

-c).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/binaryImage12x8WithDigits.png
	lyxscale 75
	width 30col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Binary image
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/binaryRegions12x8C4.png
	lyxscale 75
	width 30col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
4-connectivity
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/connectivity/binaryRegions12x8C8.png
	lyxscale 75
	width 30col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
8-connectivity
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Connectivity-2D"

\end_inset

Impact of the connectivity on the result of connected component labeling.
 (a) Original binary images.
 (b) Connected component labeling using the 4-connectivity.
 (c) Connected component labeling using the 8-connectivity.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For 3D images, the 6-connectivity considers only orthogonal neighbors in
 the three main directions, whereas the 26-connectivity considers all the
 neighbors of a given voxel in its 3-by-3-by-3 surrounding.
 The connectivity is also considered for computing 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[sec:Morphological-Reconstruction]{
\end_layout

\end_inset

morphological reconstructions
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Morphological-Reconstruction"

\end_inset

), or for computing the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[subsec:Digital-Euler-Number]{
\end_layout

\end_inset

Euler number
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 of binary or label images (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Digital-Euler-Number"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
The number of labels that can be represented within a label map depends
 on the image type: 255 for byte images, 65535 for short images, and around
 16 millions for 32-bit floating point images (only the 24 bits of the mantissa
 are used for label representation, leading to a maximum number of labels
 equal to 
\begin_inset Formula $2^{24}$
\end_inset

).
\end_layout

\begin_layout Minisec
Connected Components Labeling
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Connected-Components-Labeling"

\end_inset

transforms the binary image into a label image by assigning a specific number
 (label) to each connected component
\end_layout

\begin_layout Section
Binary images processing
\end_layout

\begin_layout Subsection
Convexification
\end_layout

\begin_layout Standard
When processing a binary region, it can sometimes be useful to consider
 the binary region corresponding to the convex hull of the original region
 (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Convexification"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 For example, the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[subsec:Convexity]{convexity measure}
\end_layout

\end_inset

 (section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Convexity"
plural "false"
caps "false"
noprefix "false"

\end_inset

) is based on the convex hull.
 The Convexify plugin allows to generate the smallest convex region containing
 a binary region.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/batCochlea-z40-inv.png
	width 30col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Binary image.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/batCochlea-z40-convex-inv.png
	width 30col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Convexification.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/binary/batCochlea-z40-convex-inv-ovr.png
	width 30col%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original image over its convex hull.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Convexification"

\end_inset

Convexification of a binary image containing several disjoint components.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Minisec
Convexify
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Convexify"

\end_inset

for a binary image, generate the smallest convex region containing a region
 in the image.
\end_layout

\begin_layout Subsection
Selection of binary regions
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Binary-Images-Selection"

\end_inset


\end_layout

\begin_layout Standard
The MorphoLibJ library offers several tools for automatically selecting
 binary regions based on size or position criteria.
 Some of them are illustrated on Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Binary-Images-Utilities"

\end_inset

.
 As the algorithms usually requires connected component labeling, it is
 often more convenient to use corresponding methods for label images (Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Label-Images-Selection"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-binary-crop-ext.png
	width 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/grains/grains-binary-crop-largest-ext.png
	width 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/grains/grains-binary-crop-killLargest-ext.png
	width 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/grains/grains-binary-crop-areaOpen-ext.png
	width 3.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Binary-Images-Utilities"

\end_inset

Utilities for binary images.
 From left to right: original image, keep largest region, remove largest
 region, apply size opening for keeping only regions with at least 150 pixels.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Minisec
Keep Largest Region 
\end_layout

\begin_layout Standard
Identifies the largest connected component, and remove all other regions.
\end_layout

\begin_layout Minisec
Remove Largest Region 
\end_layout

\begin_layout Standard
Identifies the largest connected component, and remove it from image.
\end_layout

\begin_layout Minisec
Size Opening
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Size-Opening"

\end_inset

computes the size (area in 2D, volume in 3D) of each connected component,
 and remove all particles whose size is below the value specified by the
 user.
 Algorithms work for both 2D or 3D images.
 Default connectivity 4 (resp.
 6) is used for 2D (resp.
 3D) images.
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Chapter
Label images
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:label-images"

\end_inset


\end_layout

\begin_layout Standard
When several structures or components are present within an image, it may
 be convenient to work with 
\series bold
label images
\series default
, or 
\series bold
label maps
\series default
.
 Within a label map, each pixel or voxel of a label image corresponds to
 the integer index of the particle it belongs to.
 By convention, the value 0 corresponds to the background.
 Label images are typically computed from binary images by connected component
 algorithms (section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Connected-Components-Labeling"

\end_inset

).
 Segmentation algorithms such as the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[sec:Morphological-Segmentation-Plugin]{Watershed}
\end_layout

\end_inset

 may also return their result as a label image.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
minitoc
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Visualization of label images
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Visualization-of-Label-Images"

\end_inset


\end_layout

\begin_layout Standard
Label images can be represented either using shades of gray, or using color
 maps to better distinguish the different regions.
 It may also be convenient to overlay the region label on the image to associate
 it to values within a table.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-WTH-areaOpen-lbl2-border.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Using Colormap
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-drawLabels.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Draw Labels as Overlay
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-OverlayLabels.png
	lyxscale 60
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Overlay Label Image
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Label-Images-Visualization"

\end_inset

Various visualization modes of label images.
 (a) Display regions using appropriate colormap.
 (b) The label associated to each region is overlaid on another image.
 (c) Label map or binary images can be overlaid on another grayscale image
 using user-defined opacity.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Color maps
\end_layout

\begin_layout Standard
When the number of labels within a label image is large, it may be difficult
 to differentiate regions whose labels are close.
 The Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ColorMaps"
plural "false"
caps "false"
noprefix "false"

\end_inset

 presents various combinations of colormaps and background colors.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-gt50_Glasbey_Black.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Glasbey, Black
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-gt50_GlasbeyBright_Dark.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
GlasbeyBright, White
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-gt50_GlasbeyDark_White.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
GlasbeyDark, White
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-gt50_GoldenAngle_Black.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Golden Angle, Black
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:ColorMaps"

\end_inset

Several choices of colormap for visualization of a label image.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\begin_inset Quotes eld
\end_inset

Glasbey
\begin_inset Quotes erd
\end_inset

 colormap, included within ImageJ, generates colors that are perceptually
 contrasted (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ColorMaps"
plural "false"
caps "false"
noprefix "false"

\end_inset

-a).
 It however generates black and white colors, making them difficult to distingui
sh from background (on the example from Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ColorMaps"
plural "false"
caps "false"
noprefix "false"

\end_inset

-a, the region in the top-right corner is not visible anymore).
 Therefore, the 
\begin_inset Quotes eld
\end_inset

Glasbey Bright
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

Glasbey Dark
\begin_inset Quotes erd
\end_inset

 colormaps were made available, to provide good contrast both between labels
 and with background 
\begin_inset CommandInset citation
LatexCommand citep
key "Glasbey_2007,Kovesi_2015"
literal "false"

\end_inset

.
 The choice of these colormaps was inspired by the colorcet library
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://colorcet.holoviz.org/index.html
\end_layout

\end_inset


\end_layout

\end_inset

.
 The Golden Angle colormap is an alternative to the Glasbey family, that
 provides more saturated colors (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ColorMaps"
plural "false"
caps "false"
noprefix "false"

\end_inset

-d).
 The contrast between colors is less than for Glasbey colormaps, making
 adjacent region potentially more difficult to distinguish.
\end_layout

\begin_layout Subsection
Plugins
\end_layout

\begin_layout Standard
Several plugins allow to control the appearance of label images.
 It is possible to choose a given color map, or to transform a label image
 into a color image.
 In both cases, the background color can be specified, and the color order
 can be shuffled to facilitate the discrimination of neighbor regions with
 similar labels.
\end_layout

\begin_layout Minisec
Set
\begin_inset space ~
\end_inset

Label
\begin_inset space ~
\end_inset

Map
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Set-Label-Map"

\end_inset

allows to choose the color map used to display a label image (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Label-Images-Visualization"
plural "false"
caps "false"
noprefix "false"

\end_inset

-a).
 In particular, shuffling the color map and/or choosing a specific color
 for background allows better visualization than with only gray levels.
 Note that when the number of regions is large, regions with small labels
 will be associated to the same color as background, and will therefore
 not be visible!
\end_layout

\begin_layout Minisec
Label
\begin_inset space ~
\end_inset

To
\begin_inset space ~
\end_inset

RGB
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Label-To-RGB"

\end_inset

converts a label image to a true RGB image.
 Similar to ImageJ native conversion, but this plugin avoids confusion between
 background pixels and labels with small values when the number of labels
 is large.
\end_layout

\begin_layout Minisec
Draw
\begin_inset space ~
\end_inset

Labels
\begin_inset space ~
\end_inset

As
\begin_inset space ~
\end_inset

Overlay
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Draw-Labels-As-Overlay"

\end_inset

Choose another image, and display the label associated to each region as
 a text overlay (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Label-Images-Visualization"
plural "false"
caps "false"
noprefix "false"

\end_inset

-b).
 The position of the overlay is the centroid of each region, and a small
 shift can be specified.
\end_layout

\begin_layout Minisec
Overlay
\begin_inset space ~
\end_inset

Binary
\begin_inset space ~
\end_inset

Or
\begin_inset space ~
\end_inset

Label
\begin_inset space ~
\end_inset

Image
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Overlay-Binary-Or-Label-Image"

\end_inset

Opens a dialog to choose a reference/background image, and an image to overlay,
 that can be either a binary image or a label map (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Label-Images-Visualization"
plural "false"
caps "false"
noprefix "false"

\end_inset

-c).
 User can specifiy the opacity of the overlay, and generate a new Color
 image for the result.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Visualization of region features
\end_layout

\begin_layout Standard
When images contain many labels, it is may be difficult to interpret together
 the localisation and the features describing the regions.
 The 
\begin_inset Quotes eld
\end_inset

Assign Measure To Label
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

Draw Label Values
\begin_inset Quotes erd
\end_inset

 plugins provide some help to facilitate this exploration.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-WTH-areaOpen-lbl2-border-drawLabelValues.png
	lyxscale 60
	height 4cm

\end_inset


\begin_inset Graphics
	filename images/grains/grains-lbl2-ElongMap.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Display-Region-Feature"

\end_inset

Various possibilities to graphically visualize region feature.
 On the left, the table used for display.
 Center, overlay of the elongation feature using the 
\begin_inset Quotes eld
\end_inset

Draw Label Values
\begin_inset Quotes erd
\end_inset

 plugin.
 On the right, color representation of the elongation using a color code:
 between dark purple (circular, compact) to white (very elongated).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Minisec
Draw
\begin_inset space ~
\end_inset

Label
\begin_inset space ~
\end_inset

Values
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Draw-Label-Values"

\end_inset

draws the value of a feature measured on each label of an image using two
 coordinates (bounding box, centroid...) also stored in a ResultsTable.
 An example is shown on Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Display-Region-Feature"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 
\end_layout

\begin_layout Minisec
Assign
\begin_inset space ~
\end_inset

Measure
\begin_inset space ~
\end_inset

To
\begin_inset space ~
\end_inset

Label
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Colorize-Labels"

\end_inset

combines a label image with a results table, and creates a new 32-bits image
 for which each pixel/voxel is assigned the measurement value corresponding
 to the label it belongs to (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Display-Region-Feature"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Background pixels/voxels are associated to NaN (Not-A-Number) value.
 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Label image processing
\end_layout

\begin_layout Subsection
Region and label selection
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "subsec:Label-Images-Selection"

\end_inset


\end_layout

\begin_layout Standard
It is often convenient to select regions in a label image based on their
 size or their location (e.g.
 removing the regions touching the border).
 The MorphoLibJ library offers several utility tools for automatically selecting
 or removing specific regions, or to edit the label images.
 Some of them are illustrated on Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Label-Images-Utilities"

\end_inset

.
 The 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[sec:Label-Edition-plugin]{Label Edition Plugin}
\end_layout

\end_inset

 (Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Label-Edition-plugin"
plural "false"
caps "false"
noprefix "false"

\end_inset

) provides some of these operators integrated into a graphical user interface.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-binary-crop-lbl-ext.png
	width 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/grains/grains-binary-crop-lbl-killBorders-ext.png
	width 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/grains/grains-binary-crop-lbl-killLargest-ext.png
	width 3.5cm

\end_inset

 
\begin_inset Graphics
	filename images/grains/grains-binary-crop-lbl-sizeOpening-ext.png
	width 3.5cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Label-Images-Utilities"

\end_inset

Utilities for label images.
 From left to right: original label image, remove border labels, remove
 largest region, apply size opening for keeping only regions with at least
 150 pixels.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Minisec
Remove Border Labels 
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Remove-Border-Labels"

\end_inset

Similar to the 
\begin_inset Quotes eld
\end_inset

kill borders
\begin_inset Quotes erd
\end_inset

 function, but operates faster as no morphological reconstruction is required.
\end_layout

\begin_layout Minisec
Select Label(s) 
\end_layout

\begin_layout Standard
Enters a set of labels, and creates a new label image containing only the
 selected labels.
\end_layout

\begin_layout Minisec
Keep / Remove Largest Label 
\end_layout

\begin_layout Standard
Identifies the largest label, and keep it or remove it
\end_layout

\begin_layout Minisec
Label Size Filtering 
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Label-Size-Filtering"

\end_inset

Filters the labels according to their size (area in 2D, volume in 3D), by
 specifying a comparison operator and a threshold value.
\begin_inset Note Note
status collapsed

\begin_layout Description
Label
\begin_inset space ~
\end_inset

Size
\begin_inset space ~
\end_inset

Opening 
\begin_inset CommandInset label
LatexCommand label
name "op:Label-Size-Opening"

\end_inset

computes the size (area in 2D, volume in 3D) of each region, and remove
 all labels whose size is below the value specified by the user.
 [Note: deprecated, replaced by Label Size Filtering]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Morphological filtering
\end_layout

\begin_layout Standard
Several morpological filters have been adapted to process label maps.
 
\end_layout

\begin_layout Minisec
Label Morphological Filtering
\end_layout

\begin_layout Standard
Applies morphological filtering operators on the label map, by choosing
 the type of operation (dilation, erosion, opening or closing), and the
 radius of the operation.
 The principle is the same as morphological filtering on grayscale images,
 but using label values instead of gray levels, and avoiding 
\begin_inset Quotes eld
\end_inset

collisions
\begin_inset Quotes erd
\end_inset

 between labels:
\end_layout

\begin_layout Itemize
when applying a dilation, only background pixels or voxels are updated,
 according to the closest label within the neighborhood (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Filtering-Label"
plural "false"
caps "false"
noprefix "false"

\end_inset

-b).
 When two regions are adjacent without background pixel between them, the
 application of dilation do not transform nor move their boundary.
 
\end_layout

\begin_layout Itemize
when applying an erosion, label pixels or voxels are removed depending on
 the labels within the neighborhood and on the 
\begin_inset Quotes eld
\end_inset

any Label
\begin_inset Quotes erd
\end_inset

 option:
\end_layout

\begin_deeper
\begin_layout Itemize
if true, current label is removed if any other label (background or another
 region) is contained within the neighborhood 
\end_layout

\begin_layout Itemize
if false, current label is removed if and only if a background pixel or
 voxel is contained within the neighborhood (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Filtering-Label"
plural "false"
caps "false"
noprefix "false"

\end_inset

-c).
 
\end_layout

\end_deeper
\begin_layout Standard
When the 
\begin_inset Quotes eld
\end_inset

Any Label
\begin_inset Quotes erd
\end_inset

 option is set to false, performing a morphological closing results in a
 label map with more regular regions, with less gaps between regions, and
 preserved boundaries between adjacent regions (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Morphological-Filtering-Label"
plural "false"
caps "false"
noprefix "false"

\end_inset

-d).
\end_layout

\begin_layout Standard
The computation of the neighborhood, and of the closest label, is based
 on chamfer masks (see Section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Distance-Transform"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/arabidopsisEmbryo/arabidopsis-embryo_watershedC4Tol06_lbl2_z061.png
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Label image
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/arabidopsisEmbryo/arabidopsis-embryo_watershedC4Tol06_lbl2_z061-Dilation.png
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Dilation
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/arabidopsisEmbryo/arabidopsis-embryo_watershedC4Tol06_lbl2_z061-Erosion.png
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Erosion
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/arabidopsisEmbryo/arabidopsis-embryo_watershedC4Tol06_lbl2_z061-Closing.png
	width 23text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Closing
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Morphological-Filtering-Label"

\end_inset

Morphological filtering of label images.
 Morphological dilation (b) and erosion (c) take care of adjacent regions.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Minisec
Fill Label Holes 
\end_layout

\begin_layout Standard
Fills the holes within regions.
 Only the holes that are adjacent to a single region are filled, using a
 fill corresponding to the label of the adjacent region.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Edition of label maps
\end_layout

\begin_layout Standard
Several plugins allow for basic edition of filtering of label images.
 They result in another label image.
\end_layout

\begin_layout Minisec
Crop Label 
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Crop-Label"

\end_inset

creates a new binary image containing only the label specified by the user.
 The size of the new image is fitted to the region.
\end_layout

\begin_layout Minisec
Replace Value 
\end_layout

\begin_layout Standard
replaces the value of a region by another value.
 Can be used to 
\begin_inset Quotes eld
\end_inset

clear
\begin_inset Quotes erd
\end_inset

 a label, by replacing its value by 0, or to merge to adjacent regions,
 by replacing the value of a label by the value of its neighbor.
\end_layout

\begin_layout Minisec
Remap Labels 
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "op:Remap-Labels"

\end_inset

re-computes the label of each region such that the largest label is equal
 to the number of labels (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Remap-Labels"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 This tool can be useful to remove 
\begin_inset Quotes eld
\end_inset

empty labels
\begin_inset Quotes erd
\end_inset

 that could occur after removal of one or several labels (merge labels,
 remove labels...).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-WTH-areaOpen-lbl2-border.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Label image
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-lbl2-hist.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Original histogram
\end_layout

\end_inset


\end_layout

\end_inset

 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/grains/grains-lbl2-trim-hist.png
	height 4cm

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Remapped histogram
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Remap-Labels"

\end_inset

Illustration of the 
\begin_inset Quotes eld
\end_inset

Remap Labels
\begin_inset Quotes erd
\end_inset

 plugin.
 (a) Original label image.
 (b) Histogram of original label image, showing missing labels.
 (c) Histogram of the remapped label image, without missing labels.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Remap-Labels"

\end_inset

 presents a use case of the 
\series bold
Remap Labels
\series default
 plugin.
 The left image is a label image in which small labels as well as labels
 touching image borders have been removed (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Remap-Labels"

\end_inset

-a).
 The histogram of the image presents some 
\begin_inset Quotes eld
\end_inset

holes
\begin_inset Quotes erd
\end_inset

, corresponding to the labels that have been removed (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Remap-Labels"

\end_inset

-b).
 The application of the plugin results in a similar images, without missing
 labels (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Remap-Labels"

\end_inset

-c).
 The number of labels in the image corresponds to the maximal value in the
 image (in this case, 71).
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Region adjacencies
\end_layout

\begin_layout Standard
It may sometimes be useful to consider the adjacency relationships between
 regions.
 This can be useful for post-processing of segmentation results (using e.g.
 graph processing algorithms), or for exploring collections of cells within
 cellular tissues 
\begin_inset CommandInset citation
LatexCommand citep
key "Florindo_2016_botanique"
literal "true"

\end_inset

.
 Several plugins are available within the library.
 The definition of adjacency is not totally consistent between the plugins,
 and results may greatly differ when applied on the same input label image.
\end_layout

\begin_layout Subsection
Region Adjacency Graph
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Region-Adjacency-Graph"

\end_inset


\end_layout

\begin_layout Standard
The 
\series bold
region adjacency graph 
\series default
plugin gives access to the neighborhood relationship between adjacent regions
 (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Region-Adjacency-Graph"

\end_inset

).
 
\end_layout

\begin_layout Minisec
Region Adjacency Graph
\end_layout

\begin_layout Standard
The plugin works for both 2D and 3D images, and requires a label image as
 input.
 The output of the plugin is a results table with as many rows as the number
 of pairs of adjacent regions, containing the labels of the two adjacent
 regions.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/analysis/maize-clsm.png
	lyxscale 60
	width 31text%

\end_inset

 
\begin_inset Graphics
	filename images/analysis/maize-clsm-watDyn10.png
	lyxscale 60
	width 31text%

\end_inset

 
\begin_inset Graphics
	filename images/analysis/maize-clsm-rag.png
	lyxscale 60
	width 31text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Region-Adjacency-Graph"

\end_inset

Computation of the Region Adjacency Graph (RAG) on a microscopy image of
 plant tissue.
 Left: original image.
 Middle: result of watershed segmentation.
 Right: overlay of edges representing adjacent regions.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the current implementation, MorphoLibJ considers that two regions are
 adjacent if they are separated by 0 or 1 pixel (or voxel) in one of the
 two (or three) main directions.
 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Adjacent region boundaries
\end_layout

\begin_layout Standard
It may sometimes be useful to visualize the boundaries between adjacent
 regions (Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Region-Boundary-Labeling"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-lbl-killBorders-gt50-Dil17.png
	width 25text%

\end_inset

 
\begin_inset Graphics
	filename images/blobs/blobs-lbl-killBorders-gt50-Dil17-bnd.png
	width 25text%

\end_inset


\begin_inset Graphics
	filename images/blobs/blobs-lbl-killBorders-gt50-Dil17-bnd2.png
	width 25text%

\end_inset


\begin_inset Graphics
	filename images/blobs/blobs-lbl-killBorders-gt50-Dil17-bnd2-log.png
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Region-Boundary-Labeling"

\end_inset

Example use of the plugin 
\begin_inset Quotes eld
\end_inset

Label Region Boundaries
\begin_inset Quotes erd
\end_inset

 plugin.
 Left: a label image containing regions with various adjacencies.
 Right: a new label map was created, where each label corresponds to the
 boundary between two or more regions within the original image.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\begin_inset Quotes eld
\end_inset

Label Boundaries
\begin_inset Quotes erd
\end_inset

 plugin generates a binary image of the boundaries between regions.
 The 
\begin_inset Quotes eld
\end_inset

Region Boundaries Labeling
\begin_inset Quotes erd
\end_inset

 considers similar boundaries, but in addition it associates a label to
 each boundary.
 
\end_layout

\begin_layout Minisec
Label Boundaries
\end_layout

\begin_layout Standard
Creates a new binary image containing value 255 for pixels/voxels having
 a neighbor with a different value.
 The background is taken into account for computing boundaries.
 Only the bottom-left neighborhood is checked during image iteration, to
 generate a thinner boundary image.
\end_layout

\begin_layout Minisec
Region Boundaries Labeling
\end_layout

\begin_layout Standard
Computes a new label map, where each label corresponds to the boundary between
 two (or more) regions.
 The background is also considered as a region.
 The list of identified boundaries together with their label and bounding
 regions is displayed in the log window.
 Most boundaries are adjacent to two regions, but the junctions between
 boundaries may be adjacent to three or more regions.
 Label map of boundaries is represented using floating point numbers, leading
 to a maximum number of 
\begin_inset Formula $2^{23}$
\end_inset

 (around 
\begin_inset Formula $8.3$
\end_inset

 millions) boundaries.
 The number of boundaries is usually much larger than the number of regions,
 and the maximum number of label may be reached quickly.
\end_layout

\begin_layout Standard
See also the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[subsec:Interface-Surface-Area]{
\end_layout

\end_inset

Interface Surface Area
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 plugin (section
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "op:Interface-Surface-Area"
plural "false"
caps "false"
noprefix "false"

\end_inset

), that measures the surface area between adjacent 3D regions.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Region adjacencies
\end_layout

\begin_layout Standard
Another usage of adjacencies is to select regions around a given one.
 
\end_layout

\begin_layout Minisec
Select Region Neighbors 
\end_layout

\begin_layout Standard
Extracts the neighbor regions within a label image from a region label,
 or a list of region labels (See Fig.
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Extract-Neighbor-Labels"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/blobs/blobs-basins.png
	width 30text%

\end_inset

 
\begin_inset Graphics
	filename images/blobs/blobs-basins-selectNeighbors.png
	width 30text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Extract-Neighbor-Labels"

\end_inset

An example of a label image containing contiguous regions, and result of
 the selection of the neighbors of two regions (keeping the original regions).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Section
Label Edition plugin
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Label-Edition-plugin"

\end_inset


\end_layout

\begin_layout Standard
To ease the processing of label images, MorphoLibJ provides the Label Edition
 plugin (available under 
\begin_inset Quotes eld
\end_inset

Plugins\SpecialChar menuseparator
MorphoLibJ\SpecialChar menuseparator
Labels\SpecialChar menuseparator
Label Edition
\begin_inset Quotes erd
\end_inset

).
 This plugin contains a graphical user interface (GUI) where the users can
 perform the following set of editing tasks (Figure
\begin_inset space ~
\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Label-Edition-plugin"

\end_inset

):
\end_layout

\begin_layout Itemize
Manually merge labels after their selection using the point selection tool
 (in 2D and 3D).
\end_layout

\begin_layout Itemize
Apply morphological erosion, dilation, opening and closing with a square/cube
 of radius 1 as structuring element.
\end_layout

\begin_layout Itemize
Remove labels by area or volume (size opening operation), largest size,
 manual selection or border location.
\end_layout

\begin_layout Standard
All operations are performed 
\begin_inset Quotes eld
\end_inset

in place
\begin_inset Quotes erd
\end_inset

, i.e., the input image gets directly modified.
 However, the initial status of the label image can be recovered by clicking
 on 
\begin_inset Quotes eld
\end_inset

Reset
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/Label-Edition-plugin.png
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Label-Edition-plugin"

\end_inset

Label Edition plugin.
 From left to right and from top to bottom: overview of the plugin GUI on
 a 2D label image, result of label merging by manual selection, removal
 of selected labels, label erosion and removal of largest label (in this
 case, the largest label corresponds to the background).
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Library interoperability
\end_layout

\begin_layout Standard
A key design concept was the modularity of the implementation to facilitate
 its reusability.
 Three layers with different programming abstraction can be identified:
\end_layout

\begin_layout Itemize
For final users, plugins provide graphical display and intuitive tuning
 of parameters.
 Such plugins can easily be incorporated into a macro:
\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

// Calls the Regional Min/Max plugin on current ImagePlus instance
\end_layout

\begin_layout Plain Layout

run("Regional Min & Max", "operation=[Regional Maxima] connectivity=4");
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
For plugins developers, operators are available through collections of static
 methods, making it possible to apply most operations with a single line
 of code.
 Example:
\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

// Computes regional maxima using the 4-connectivity
\end_layout

\begin_layout Plain Layout

ImageProcessor maxima = MinimaAndMaxima.regionalMaxima(image, 4);
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
For core developers, algorithms are implementations of abstract interfaces,
 making it possible to choose or develop the most appropriate one, and to
 monitor execution events.
\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

// choose and setup the appropriate algorithm
\end_layout

\begin_layout Plain Layout

RegionalExtremaAlgo algo = new RegionalExtremaByFlooding(); 
\end_layout

\begin_layout Plain Layout

algo.setExtremaType(ExtremaType.MAXIMA);
\end_layout

\begin_layout Plain Layout

algo.setConnectivity(4);
\end_layout

\begin_layout Plain Layout

// add algorithm monitoring
\end_layout

\begin_layout Plain Layout

algo.addAlgoListener(new DefaultAlgoListener());
\end_layout

\begin_layout Plain Layout

// compute result on a given ImageProcessor
\end_layout

\begin_layout Plain Layout

ImageProcessor result = algo.applyTo(image);
\end_layout

\end_inset


\end_layout

\begin_layout Standard
In total, the library provides nearly two hundred classes and interfaces.
 
\end_layout

\begin_layout Section
Library organization
\end_layout

\begin_layout Standard
The library follows a logic structure of folders divided by topics aiming
 at their re-usability from other plugins or scripts, among others:
\end_layout

\begin_layout Description
inra.ijpb.data contains generic data structures for manipulating 2D or 3D
 images
\end_layout

\begin_layout Description
inra.ijpb.binary contains the set of utilities for working on binary images
 (connected component labeling, distance transform, geodesic distance transform...)
\end_layout

\begin_layout Description
inra.ijpb.geometry contains utility functions for geometric computing, and
 several classes for representing geometric primitives (ellipse, point pair...)
\end_layout

\begin_layout Description
inra.ijpb.label contains the utilities for label images (cropping, size opening,
 remove border labels, etc)
\end_layout

\begin_layout Description
inra.ijpb.measure contains the tools for geometric and gray level characterization
 of 2D or 3D images
\end_layout

\begin_layout Description
inra.ijpb.morphology contains the collection of mathematical morphology operators
\end_layout

\begin_layout Description
inra.ijpb.watershed contains the classes implementing the different versions
 of the watershed algorithm
\end_layout

\begin_layout Description
inra.ijpb.plugins contains the set of plugins that is accessible from ImageJ/Fiji
 Plugins menu
\end_layout

\begin_layout Standard
All major methods have a general class with static methods that allow calling
 the methods on 2D and 3D images in a transparent way.
 This modularity permitted to develop other plugins devoted to the analysis
 of nucleus images 
\begin_inset CommandInset citation
LatexCommand citep
key "Poulet_2015_bmc"
literal "true"

\end_inset

, gray level granulometries 
\begin_inset CommandInset citation
LatexCommand citep
key "Devaux2014"
literal "true"

\end_inset

 or the description of binary microstructures 
\begin_inset CommandInset citation
LatexCommand citep
key "Silva2015"
literal "true"

\end_inset

.
\end_layout

\begin_layout Section
Scripting MorphoLibJ 
\end_layout

\begin_layout Standard
One advantage of this organization of the library and the use of public
 static methods is that it allows very easy and fast prototyping of morphologica
l algorithms and pipelines.
 
\end_layout

\begin_layout Subsection
Segmentation pipeline prototype
\end_layout

\begin_layout Standard
Let's see an example in a complete Beanshell script that takes the active
 2D or 3D image and finds a reasonable segmentation combining a set of morpholog
ical operations (gradient, extended minima and watershed):
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

// @ImagePlus imp
\end_layout

\begin_layout Plain Layout

 
\end_layout

\begin_layout Plain Layout

// ImageJ imports
\end_layout

\begin_layout Plain Layout

import ij.IJ;
\end_layout

\begin_layout Plain Layout

import ij.ImagePlus;
\end_layout

\begin_layout Plain Layout

import ij.ImageStack;
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// MorphoLibJ imports
\end_layout

\begin_layout Plain Layout

import inra.ijpb.binary.BinaryImages;
\end_layout

\begin_layout Plain Layout

import inra.ijpb.morphology.MinimaAndMaxima3D;
\end_layout

\begin_layout Plain Layout

import inra.ijpb.morphology.Morphology;
\end_layout

\begin_layout Plain Layout

import inra.ijpb.morphology.Strel3D;
\end_layout

\begin_layout Plain Layout

import inra.ijpb.watershed.Watershed;
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

// create structuring element (cube of radius 1)
\end_layout

\begin_layout Plain Layout

strel = Strel3D.Shape.CUBE.fromRadius( 1 );
\end_layout

\begin_layout Plain Layout

// apply morphological gradient to input image
\end_layout

\begin_layout Plain Layout

image = Morphology.gradient( imp.getImageStack(), strel );
\end_layout

\begin_layout Plain Layout

// find regional minima on gradient image with dynamic value of 30 and 6-connect
ivity
\end_layout

\begin_layout Plain Layout

regionalMinima = MinimaAndMaxima3D.extendedMinima( image, 30, 6 );
\end_layout

\begin_layout Plain Layout

// impose minima on gradient image
\end_layout

\begin_layout Plain Layout

imposedMinima = MinimaAndMaxima3D.imposeMinima( image, regionalMinima, 6
 );
\end_layout

\begin_layout Plain Layout

// label minima using connected components (32-bit output)
\end_layout

\begin_layout Plain Layout

labeledMinima = BinaryImages.componentsLabeling( regionalMinima, 6, 32 );
\end_layout

\begin_layout Plain Layout

// apply marker-based watershed using the labeled minima on the minima-imposed
 
\end_layout

\begin_layout Plain Layout

// gradient image (the "true" value indicates the use of dams in the output)
\end_layout

\begin_layout Plain Layout

resultStack = Watershed.computeWatershed( imposedMinima, labeledMinima, 6,
 true );
\end_layout

\begin_layout Plain Layout

  
\end_layout

\begin_layout Plain Layout

// create image with watershed result
\end_layout

\begin_layout Plain Layout

resultImage = new ImagePlus( "watershed", resultStack );
\end_layout

\begin_layout Plain Layout

// assign right calibration
\end_layout

\begin_layout Plain Layout

resultImage.setCalibration( imp.getCalibration() );
\end_layout

\begin_layout Plain Layout

// and show it
\end_layout

\begin_layout Plain Layout

resultImage.show();
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Label visualization in 3D viewer
\end_layout

\begin_layout Standard
Making use of MorphoLibJ's label methods and the ImageJ 3D Viewer's visualizatio
n tools it is quite simple to create a script to display each label of an
 image as 3D surfaces of the corresponding colors provided by the image
 look-up table:
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,captionpos=b,commentstyle={\color{mygreen}},keywordstyle={\color{blue}},language=Java,numbers=left,showstringspaces=false,stringstyle={\color{magenta}}"
inline false
status open

\begin_layout Plain Layout

// @ImagePlus imp   
\end_layout

\begin_layout Plain Layout

import inra.ijpb.label.LabelImages; 
\end_layout

\begin_layout Plain Layout

import ij3d.Image3DUniverse; 
\end_layout

\begin_layout Plain Layout

import ij3d.ContentConstants; 
\end_layout

\begin_layout Plain Layout

import org.scijava.vecmath.Color3f; 
\end_layout

\begin_layout Plain Layout

import ij.IJ; 
\end_layout

\begin_layout Plain Layout

import isosurface.SmoothControl;   
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// set to true to display messages in log window 
\end_layout

\begin_layout Plain Layout

verbose = false;   
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// set display range to 0-255 so the displayed colors 
\end_layout

\begin_layout Plain Layout

// correspond to the LUT values 
\end_layout

\begin_layout Plain Layout

imp.setDisplayRange( 0, 255 ); imp.updateAndDraw();   
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// calculate array of all labels in image 
\end_layout

\begin_layout Plain Layout

labels = LabelImages.findAllLabels( imp );   
\end_layout

\begin_layout Plain Layout

// create 3d universe
\end_layout

\begin_layout Plain Layout

univ = new Image3DUniverse(); 
\end_layout

\begin_layout Plain Layout

univ.show();   
\end_layout

\begin_layout Plain Layout

// read LUT from input image 
\end_layout

\begin_layout Plain Layout

lut = imp.getLuts()[0];   
\end_layout

\begin_layout Plain Layout

// add all labels different from zero (background) 
\end_layout

\begin_layout Plain Layout

// to 3d universe 
\end_layout

\begin_layout Plain Layout

for( i=0; i<labels.length; i++ ) 
\end_layout

\begin_layout Plain Layout

{        
\end_layout

\begin_layout Plain Layout

	if( labels[ i ] > 0 )     
\end_layout

\begin_layout Plain Layout

	{         
\end_layout

\begin_layout Plain Layout

		labelToKeep = new int[ 1 ];         
\end_layout

\begin_layout Plain Layout

		labelToKeep[ 0 ] = labels[ i ];         
\end_layout

\begin_layout Plain Layout

		if( verbose )             
\end_layout

\begin_layout Plain Layout

		IJ.log( "Reconstructing label " + labels[ i ] + "..." );         
\end_layout

\begin_layout Plain Layout

		
\end_layout

\begin_layout Plain Layout

		// create new image containing only that label         
\end_layout

\begin_layout Plain Layout

		labelImp = LabelImages.keepLabels( imp, labelToKeep );         
\end_layout

\begin_layout Plain Layout

		// convert image to 8-bit         
\end_layout

\begin_layout Plain Layout

		IJ.run( labelImp, "8-bit", "" );                   
\end_layout

\begin_layout Plain Layout

		// use LUT label color         
\end_layout

\begin_layout Plain Layout

		color = new Color3f( new java.awt.Color( lut.getRed( labels[ i ] ),     
        
\end_layout

\begin_layout Plain Layout

							lut.getGreen( labels[ i ] ),             
\end_layout

\begin_layout Plain Layout

							lut.getBlue( labels[ i ] ) ) );                       
\end_layout

\begin_layout Plain Layout

		if ( verbose )             
\end_layout

\begin_layout Plain Layout

			IJ.log( "RGB( " + lut.getRed( labels[ i ] ) +", "
\end_layout

\begin_layout Plain Layout

							+ lut.getGreen( labels[ i ] )                 
\end_layout

\begin_layout Plain Layout

							+ ", " + lut.getBlue( labels[ i ] ) + ")" );           
\end_layout

\begin_layout Plain Layout

		channels = new boolean[3];         
\end_layout

\begin_layout Plain Layout

		channels[ 0 ] = false;         
\end_layout

\begin_layout Plain Layout

		channels[ 1 ] = false;         
\end_layout

\begin_layout Plain Layout

		channels[ 2 ] = false;                   
\end_layout

\begin_layout Plain Layout

		// add label image with corresponding color as an isosurface         
\end_layout

\begin_layout Plain Layout

		univ.addContent( labelImp, color, "label-"+labels[i], 0, channels, 2, ContentCo
nstants.SURFACE);     
\end_layout

\begin_layout Plain Layout

	} 
\end_layout

\begin_layout Plain Layout

}   
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

// launch smooth control 
\end_layout

\begin_layout Plain Layout

sc = new SmoothControl( univ );
\end_layout

\end_inset


\end_layout

\begin_layout Standard
At the end of the script a dialog is shown to smooth the surfaces at will.
 Each label is added to the 3D scene independently with the name "label-X"
 where X is its label value.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename images/MorphoLibJ-visualize-labels-in-3d-viewer.png
	lyxscale 25
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
From left to right: input label image, script output, smoothed label surfaces
 and example of individually translated surfaces in the 3D viewer.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Chapter
Applications
\end_layout

\begin_layout Section
Segmentation and analysis of Arabidospis early embryo
\end_layout

\begin_layout Plain Layout
[morphological filtering : directional ?]
\end_layout

\begin_layout Plain Layout
[detection of minima by extended min]
\end_layout

\begin_layout Plain Layout
[watershed -> set of labels]
\end_layout

\begin_layout Plain Layout
[manual edition of labels]
\end_layout

\begin_layout Plain Layout
[morphometry of individual particles]
\end_layout

\begin_layout Plain Layout
[create 3D result image of parametric mapping]
\end_layout

\begin_layout Section
Analysis of hemp fibre morphology
\end_layout

\begin_layout Plain Layout
[geodesic diameter, tortuosity of particles]
\end_layout

\begin_layout Section
Characterization of dairy matrix microstructure
\end_layout

\begin_layout Plain Layout
[computation of tortuosity for binary microstructure, granulometry, area
 and boundary length densities]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "bibliography"
options "bibtotoc,apalike2"

\end_inset


\end_layout

\begin_layout Chapter
\start_of_appendix
List of operators
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="32" columns="10">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Plugin Name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
bin.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
RGB
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
GUI
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Page
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Image filtering
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Morphological filters 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Morphological-Filters"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Morphological filters (3D)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Morphological-Filters-3D"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Directional filters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Directional-Filters"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Grayscale Attribute Filtering
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Attribute-Filtering"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Grayscale Attribute Filtering 3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Attribute-Filtering"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Morphological Reconstruction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Morphological-Reconstruction"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Morphological Reconstruction (3D)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Morphological-Reconstruction"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Interactive Morphological Reconstruction
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Interactive-Morphological-Reconstruction"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Interactive Morphological Reconstruction 3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Interactive-Morphological-Reconstruction-3d"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Kill Borders
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Morphological-Reconstruction-Grayscale"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fill Holes (Binary / Gray)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Morphological-Reconstruction-Grayscale"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Segmentation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Classic Watershed
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Classic-Watershed"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Marker-controlled Watershed
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Marker-Controlled-Watershed"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Interactive Marker-controlled Watershed
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Interactive-Marker-controlled-WS"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Morphological Segmentation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Morphological-Segmentation-Plugin"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Minima and Maxima
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Regional Min & Max
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Regional-Extrema"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Regional Min & Max 3D 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Regional-Extrema"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Extended Min & Max
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Extended-Extrema"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Extended Min & Max 3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Extended-Extrema"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Impose Min & Max
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Extrema-Imposition"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Impose Min & Max 3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Extrema-Imposition"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Utilities
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Extend Borders
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary Overlay
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binary/Labels Overlay
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Overlay-Binary-Or-Label-Image"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Draw Label Values
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Draw-Labels-As-Overlay"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Image processing operators for grayscale and intensity images.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="38" columns="10">
<features tabularvalignment="middle">
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Plugin Name
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
bin.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
RGB
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
2D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
GUI
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Page
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Binary Images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Connected Components Labeling
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Connected-Components-Labeling"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Chamfer Distance Map
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Chamfer-Distance-Map"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Chamfer Distance Map 3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Chamfer-Distance-Map-3d"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Geodesic Distance Map
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Geodesic-Distance-Map"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Interactive Geodesic Distance Map
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Interactive-Geodesic-Distance-Map"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Geodesic Distance Map 3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Geodesic-Distance-Map-3d"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Distance Transform Watershed
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Distance-Transform-Watershed"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Distance Transform Watershed 3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Distance-Transform-Watershed-3d"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Convexify
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Convexify"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Remove Largest Region
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Binary-Images-Selection"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Keep Largest Region
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Binary-Images-Selection"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Area Opening
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Size-Opening"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Size Opening 2D/3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Size-Opening"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Label Images
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Set Label Map
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Set-Label-Map"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Labels To RGB
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Set-Label-Map"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Draw Labels As Overlay
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "fig:Label-Images-Visualization"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Assign Measure To Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Set-Label-Map"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label Edition
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Label-Edition-plugin"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label Morphological Filters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "fig:Morphological-Filtering-Label"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Remap Labels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Remap-Labels"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fill Label Holes
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Remap-Labels"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Expand Labels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Crop-Label"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Remove Border Labels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Label-Images-Selection"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Replace / Remove Label(s)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Label-Images-Selection"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Merge Labels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Select Label(s)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "subsec:Label-Images-Selection"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Crop Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Crop-Label"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Remove Largest Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Crop-Label"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Keep Largest Label
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Crop-Label"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label Size Filtering
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "op:Label-Size-Filtering"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Region Adjacency Graph
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Region-Adjacency-Graph"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Region Boundaries Labeling
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Region-Adjacency-Graph"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Label Boundaries
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "sec:Region-Adjacency-Graph"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Select Neighbor Labels
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
n.a.
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset CommandInset ref
LatexCommand pageref
reference "fig:Extract-Neighbor-Labels"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Image processing operators for binary and label images.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Computation of equivalent ellipsoid coefficients
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "chap:Equivalent-Ellipsoid-Computation"

\end_inset


\end_layout

\begin_layout Standard
It is often convenient to represent the results of second order moments
 (section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Region-Analysis-3D"
plural "false"
caps "false"
noprefix "false"

\end_inset

) as an 
\series bold
equivalent ellipsoid 
\series default
that has the same orientation and the same eigen values as the structure
 of interest.
 The equivalent ellipsoid can be completely characterised by nine coefficients:
\end_layout

\begin_layout Itemize
the three coordinates of the centroid
\end_layout

\begin_layout Itemize
the three radius 
\begin_inset Formula $r_{1},r_{2},r_{3}$
\end_inset

, with 
\begin_inset Formula $r_{1}>r_{2}>r_{3}$
\end_inset

, corresponding to the lengths of each semi-axis
\end_layout

\begin_layout Itemize
a 3D orientation, that can be represented by three Euler angles.
\end_layout

\begin_layout Section
Notations
\end_layout

\begin_layout Standard
We consider euclidean spaces of dimension 3.
 Let 
\begin_inset Formula $X$
\end_inset

 be the a 3D set representing the structure of interest.
\end_layout

\begin_layout Subsection
Moments
\end_layout

\begin_layout Standard
In 3D, the 
\series bold
moments
\series default
 
\begin_inset Formula $m_{pqr}$
\end_inset

 of order 
\begin_inset Formula $(p,q,r)$
\end_inset

 are defined as:
\begin_inset Formula 
\begin{align}
m_{pqr} & =\int\int\int I_{X}(x,y,z)x^{p}y^{q}z^{r}\cdot dx\cdot dy\cdot dz\label{eq:Moment-of-X-3D-1}
\end{align}

\end_inset

where 
\begin_inset Formula $I_{X}(x,y,z)$
\end_inset

 is the indicator function of the set 
\begin_inset Formula $X$
\end_inset

, taking value 1 if the specified point is within the set 
\begin_inset Formula $X$
\end_inset

, and 
\begin_inset Formula $0$
\end_inset

 otherwise.
 The moment 
\begin_inset Formula $m_{000}$
\end_inset

 corresponds to the 
\series bold
volume
\series default
 of the structure.
 The 
\series bold
centered moments 
\series default
are expressed as:
\begin_inset Formula 
\begin{align}
\mu_{pqr} & =\int\int\int I_{X}(x,y,z)\left(x-x_{c}\right)^{p}\left(y-y_{c}\right)^{q}\left(z-z_{c}\right)^{r}\cdot dx\cdot dy\cdot dz\label{eq:Centered-Moment-of-X-3D}
\end{align}

\end_inset

where 
\begin_inset Formula $(x_{c},y_{c},z_{c})=(\frac{m_{100}}{m_{000}},\frac{m_{010}}{m_{000}},\frac{m_{001}}{m_{000}})$
\end_inset

 is the 
\series bold
centroid
\series default
 of 
\begin_inset Formula $X$
\end_inset

.
 The matrix of second order moments is the symmetric 
\begin_inset Formula $3\times3$
\end_inset

 matrix that combines all the centered second order moments:
\begin_inset Formula 
\[
\boldsymbol{M}=\left[\begin{array}{ccc}
\mu_{200} & \mu_{110} & \mu_{101}\\
\mu_{110} & \mu_{020} & \mu_{011}\\
\mu_{101} & \mu_{011} & \mu_{002}
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Subsection
Eigen values decomposition
\end_layout

\begin_layout Standard
The matrix 
\begin_inset Formula $\boldsymbol{M}$
\end_inset

 can be factorized using eigen value decomposition:
\begin_inset Formula 
\begin{align*}
\boldsymbol{M} & =\boldsymbol{Q}\boldsymbol{\Lambda}\boldsymbol{Q}^{t}
\end{align*}

\end_inset

where
\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{Q}$
\end_inset

 is a 
\begin_inset Formula $3\times3$
\end_inset

 orthogonal matrix whose 
\begin_inset Formula $i$
\end_inset

-th column is the eigenvector 
\begin_inset Formula $q_{i}$
\end_inset

 of 
\begin_inset Formula $\boldsymbol{M}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\boldsymbol{\Lambda}$
\end_inset

 is a diagonal 
\begin_inset Formula $3\times3$
\end_inset

 matrix whose diagonal elements are the corresponding eigen values, 
\begin_inset Formula $\Lambda_{ii}=\lambda_{i}$
\end_inset

.
\end_layout

\begin_layout Standard
Eigen values are ordered in decreasing order.
 The matrix 
\begin_inset Formula $\boldsymbol{Q}$
\end_inset

 can be used to extract the orientation of the main axes of the structure
 (section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Equivalent-Ellipsoid-Angles"
plural "false"
caps "false"
noprefix "false"

\end_inset

), whereas the eigen values 
\begin_inset Formula $\lambda_{i}$
\end_inset

 can be related to the particle dimensions along these axes (section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Equivalent-Ellipsoid-Radius"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
\end_layout

\begin_layout Section
Computation of angles
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Equivalent-Ellipsoid-Angles"

\end_inset


\end_layout

\begin_layout Standard
This section largely follows the document of Greg Slabaugh 
\begin_inset CommandInset citation
LatexCommand citep
key "Slabaugh_1999"
literal "false"

\end_inset

 for obtaining Euler angles from a rotation matrix.
 We mostly follow his notations.
 Another useful reference may be 
\begin_inset CommandInset citation
LatexCommand citet
key "Shoemake_1994_GraphicsGemIV"
literal "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Rotation matrices
\end_layout

\begin_layout Standard
A rotation of 
\begin_inset Formula $\psi$
\end_inset

 radians about the 
\begin_inset Formula $x$
\end_inset

-axis is noted by:
\begin_inset Formula 
\begin{align*}
\boldsymbol{R}_{x}(\psi) & =\left[\begin{array}{ccc}
1 & 0 & 0\\
0 & \cos\psi & -\sin\psi\\
0 & \sin\psi & \cos\psi
\end{array}\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Similarily, a rotation of 
\begin_inset Formula $\theta$
\end_inset

 radians about the 
\begin_inset Formula $y$
\end_inset

-axis is noted by:
\begin_inset Formula 
\begin{align*}
\boldsymbol{R}_{y}(\theta) & =\left[\begin{array}{ccc}
\cos\theta & 0 & \sin\theta\\
0 & 1 & 0\\
-\sin\theta & 0 & \cos\theta
\end{array}\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Finally, a rotation of 
\begin_inset Formula $\varphi$
\end_inset

 radians about the 
\begin_inset Formula $z$
\end_inset

-axis is noted by:
\begin_inset Formula 
\begin{align*}
\boldsymbol{R}_{z}(\varphi) & =\left[\begin{array}{ccc}
\cos\varphi & -\sin\varphi & 0\\
\sin\varphi & \cos\varphi & 0\\
0 & 0 & 1
\end{array}\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
A general rotation matrix may have the following form:
\begin_inset Formula 
\[
\boldsymbol{R}=\left[\begin{array}{ccc}
R_{11} & R_{12} & R_{13}\\
R_{21} & R_{22} & R_{23}\\
R_{31} & R_{32} & R_{33}
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
Such a matrix can be represented by a sequence of three successive rotations
 around the main axes.
 As matrix multiplication does not commute, the order of the axes one rotates
 about will affect the result.
 In MorphoLibJ, we follow the choice of G.
 Slabaugh and consider rotation first about the 
\begin_inset Formula $x$
\end_inset

-axis, then about the 
\begin_inset Formula $y$
\end_inset

-axis, and finally about the 
\begin_inset Formula $z$
\end_inset

-axis.
 Then, the angles 
\begin_inset Formula $\psi$
\end_inset

, 
\begin_inset Formula $\theta$
\end_inset

 and 
\begin_inset Formula $\varphi$
\end_inset

 correspond to Euler angles.
 Angle 
\begin_inset Formula $\psi$
\end_inset

 corresponds to the 
\begin_inset Quotes eld
\end_inset

roll
\begin_inset Quotes erd
\end_inset

, angle 
\begin_inset Formula $\theta$
\end_inset

 to the 
\begin_inset Quotes eld
\end_inset

pitch
\begin_inset Quotes erd
\end_inset

, and angle 
\begin_inset Formula $\varphi$
\end_inset

 to the 
\begin_inset Quotes eld
\end_inset

yaw
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
The global rotation matrix can be written as follow:
\begin_inset Formula 
\begin{align*}
\boldsymbol{R} & =\boldsymbol{R}_{z}(\varphi)\cdot\boldsymbol{R}_{y}(\theta)\cdot\boldsymbol{R}_{x}(\psi)\\
 & =\left[\begin{array}{ccc}
\cos\theta\cos\varphi & \sin\psi\sin\theta\cos\varphi-\cos\psi\sin\varphi & \cos\psi\sin\theta\cos\varphi+\sin\psi\sin\varphi\\
\cos\theta\sin\varphi & \sin\psi\sin\theta\sin\varphi+\cos\psi\cos\varphi & \cos\psi\sin\theta\sin\varphi-\sin\psi\cos\varphi\\
-\sin\theta & \sin\psi\cos\theta & \cos\psi\cos\theta
\end{array}\right]
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The problem is now to identify the three Euler angles 
\begin_inset Formula $\psi$
\end_inset

, 
\begin_inset Formula $\theta$
\end_inset

 and 
\begin_inset Formula $\varphi$
\end_inset

 from the matrix coefficients.
 This results in nine equations.
\end_layout

\begin_layout Subsection
Elevation
\end_layout

\begin_layout Standard
We start considering the elevation 
\begin_inset Formula $\theta$
\end_inset

, or 
\begin_inset Quotes eld
\end_inset

pitch
\begin_inset Quotes erd
\end_inset

.
 From element 
\begin_inset Formula $R_{31}$
\end_inset

 of the matrix, one finds
\begin_inset Formula 
\begin{align*}
R_{31} & =-\sin\theta
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
One identifies 
\begin_inset Formula $\theta$
\end_inset

 with the following
\begin_inset Formula 
\begin{align*}
\theta & =-\sin^{-1}(R_{31})
\end{align*}

\end_inset

by keeping the value of 
\begin_inset Formula $\theta\in[-\frac{\pi}{2};\frac{\pi}{2}]$
\end_inset

 to remove ambiguity.
 The case 
\begin_inset Formula $R_{31}=\pm1$
\end_inset

 will be considered later.
 In practice, we replace the 
\begin_inset Formula $\sin^{-1}$
\end_inset

 function by the 
\begin_inset Formula $\text{atan2}$
\end_inset

 function for better numerical stability.
\end_layout

\begin_layout Standard
Compared to the document of Slabaugh, keeping 
\begin_inset Formula $\theta\in[-\frac{\pi}{2};\frac{\pi}{2}]$
\end_inset

 removes the sign ambiguity of 
\begin_inset Formula $\cos\theta$
\end_inset

, and therefore simplifies the remaining computations.
\end_layout

\begin_layout Subsection
Roll
\end_layout

\begin_layout Standard
The possible values of the roll 
\begin_inset Formula $\psi$
\end_inset

 around the 
\begin_inset Formula $x$
\end_inset

-axis can be found by
\begin_inset Formula 
\begin{align*}
\frac{R_{32}}{R_{33}} & =\tan\psi
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
This lead to the value of 
\begin_inset Formula $\psi$
\end_inset

 as
\begin_inset Formula 
\begin{align*}
\psi & =\text{atan2}(R_{32},R_{33})
\end{align*}

\end_inset

where 
\begin_inset Formula $\text{atan2}(y,x)$
\end_inset

 is the arc tangent function of the two variables 
\begin_inset Formula $y$
\end_inset

 and 
\begin_inset Formula $x$
\end_inset

 that extends the 
\begin_inset Formula $\text{atan}$
\end_inset

 function to the all four quadrants.
 The function 
\begin_inset Formula $\text{atan2}$
\end_inset

 is available in most programming languages.
\end_layout

\begin_layout Subsection
Azimut
\end_layout

\begin_layout Standard
The azimut 
\begin_inset Formula $\varphi$
\end_inset

, or 
\begin_inset Quotes eld
\end_inset

yaw
\begin_inset Quotes erd
\end_inset

, can be obtained from 
\begin_inset Formula 
\begin{align*}
\frac{R_{21}}{R_{11}} & =\tan\varphi\\
\varphi & =\text{atan2}(R_{21},R_{11})
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
Special case of 
\begin_inset Formula $\cos\theta=0$
\end_inset


\end_layout

\begin_layout Standard
When the matrix element 
\begin_inset Formula $R_{31}=\pm1$
\end_inset

, we have 
\begin_inset Formula $\theta=\pm\pi/2$
\end_inset

: the main axis of the ellipsoid is aligned with the 
\begin_inset Formula $z$
\end_inset

-axis.
 Developping the terms 
\begin_inset Formula $R_{12}$
\end_inset

, 
\begin_inset Formula $R_{13}$
\end_inset

, 
\begin_inset Formula $R_{22}$
\end_inset

, and 
\begin_inset Formula $R_{23}$
\end_inset

 shows that the values of 
\begin_inset Formula $\psi$
\end_inset

 and 
\begin_inset Formula $\varphi$
\end_inset

 are linked, and an infinite number of solutions exists 
\begin_inset CommandInset citation
LatexCommand citep
key "Slabaugh_1999"
literal "false"

\end_inset

.
 This phenomenon is called 
\emph on
Gimbal lock
\emph default
.
 A convenient way to obtain a single valid solution is to set the value
 for the azimut 
\begin_inset Formula $\varphi$
\end_inset

 arbitrarily to 
\begin_inset Formula $0$
\end_inset

, and compute 
\begin_inset Formula $\psi$
\end_inset

 from 
\begin_inset Formula $R_{\text{12}}$
\end_inset

 and 
\begin_inset Formula $R_{13}$
\end_inset

.
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\theta=\pi/2$
\end_inset

 then 
\begin_inset Formula 
\begin{align*}
R_{12} & =\sin\psi\cos\varphi-\cos\psi\sin\varphi=\sin(\psi-\varphi)\\
R_{13} & =\cos\psi\cos\varphi-\sin\psi\sin\varphi=\cos(\psi-\varphi)\\
R_{22} & =\sin\psi\sin\varphi-\cos\psi\cos\varphi=\cos(\psi-\varphi)=R_{13}\\
R_{23} & =\cos\psi\sin\varphi-\sin\psi\cos\varphi=-\sin(\psi-\varphi)=-R_{12}
\end{align*}

\end_inset

leading to
\begin_inset Formula 
\begin{align*}
\psi & =\varphi+\text{atan2}(R_{12},R_{13})
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\theta=-\pi/2$
\end_inset

, similar development leads to:
\begin_inset Formula 
\begin{align*}
\psi & =-\varphi+\text{atan2}(-R_{12},-R_{13})
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Pseudocode?
\end_layout

\end_inset


\end_layout

\begin_layout Section
Computation of ellipsoid radius
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Equivalent-Ellipsoid-Radius"

\end_inset


\end_layout

\begin_layout Standard
Let us suppose that the ellipsoid is centered and aligned with the main
 axes.
 From centering, we have 
\begin_inset Formula $m_{pqr}=\mu_{pqr}$
\end_inset

.
 For integration, it is more convenient to use spherical coordinates 
\begin_inset Formula $(\rho,\theta,\varphi)$
\end_inset

, corresponding to the distance to the origin, to the inclination with the
 vertical, and to the azimuth (these notations are different from the ones
 used for Euler angles).
 This corresponds to:
\begin_inset Formula 
\begin{align*}
x & =\rho\cdot r_{1}\cdot\cos\varphi\cdot\sin\theta\\
y & =\rho\cdot r_{2}\cdot\sin\varphi\cdot\sin\theta\\
z & =\rho\cdot r_{3}\cdot\cos\theta
\end{align*}

\end_inset

with 
\begin_inset Formula $\rho\in[0;+\infty[$
\end_inset

, 
\begin_inset Formula $\varphi\in[0;2\pi]$
\end_inset

 and 
\begin_inset Formula $\theta\in[0;\pi]$
\end_inset

.
\end_layout

\begin_layout Standard
The Jacobian matrix of the transformation is as follow (see example 3 in
 
\begin_inset Quotes eld
\end_inset

Jacobian matrix and determinant
\begin_inset Quotes erd
\end_inset

 on Wikipedia
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant
\backslash
#Example_3:_spherical-Cartesian_transformation
\end_layout

\end_inset


\end_layout

\end_inset

):
\begin_inset Formula 
\[
J_{\Phi}(x,y,z)=\left[\begin{array}{ccc}
\frac{\partial x}{\partial\rho} & \frac{\partial x}{\partial\theta} & \frac{\partial x}{\partial\varphi}\\
\frac{\partial y}{\partial\rho} & \frac{\partial y}{\partial\theta} & \frac{\partial y}{\partial\varphi}\\
\frac{\partial z}{\partial\rho} & \frac{\partial z}{\partial\theta} & \frac{\partial z}{\partial\varphi}
\end{array}\right]=\left[\begin{array}{ccc}
r_{1}\cos\varphi\sin\theta & \rho r_{1}\cos\varphi\cos\theta & -\rho r_{1}\sin\varphi\sin\theta\\
r_{2}\sin\varphi\sin\theta & \rho r_{2}\sin\varphi\cos\theta & \rho r_{2}\cos\varphi\sin\theta\\
r_{2}\cos\theta & -\rho r_{3}\sin\theta & 0
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
The determinant equals 
\begin_inset Formula $\rho^{2}\sin\theta$
\end_inset

 if 
\begin_inset Formula $r_{1}=r_{2}=r_{3}=1$
\end_inset

.
 Introducing 
\begin_inset Formula $a$
\end_inset

, 
\begin_inset Formula $b$
\end_inset

 and 
\begin_inset Formula $c$
\end_inset

 gives a determinant equal to 
\begin_inset Formula $r_{1}r_{2}r_{3}\rho^{2}\sin\theta$
\end_inset

.
 Then the moment integral is given by:
\begin_inset Formula 
\begin{equation}
\mu_{pqr}=r_{1}r_{2}r_{3}\int_{0}^{2\pi}\int_{0}^{\pi}\int_{0}^{1}\left(\rho\cos\varphi\sin\theta\right)^{p}\left(\rho\sin\varphi\sin\theta\right)^{q}\left(\rho\cos\theta\right)^{r}\cdot\rho^{2}\sin\theta\cdot d\rho\cdot d\theta\cdot d\varphi
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Volume moment
\end_layout

\begin_layout Standard
It is easy to check that the moment 
\begin_inset Formula $m_{000}$
\end_inset

 corresponds to the volume of the ellipsoid (equal to 
\begin_inset Formula $\frac{4\pi}{3}r_{1}r_{2}r_{3}$
\end_inset

):
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
m_{000} & =r_{1}r_{2}r_{3}\int_{0}^{2\pi}\int_{0}^{\pi}\int_{0}^{1}\rho^{2}\sin\theta\cdot d\rho\cdot d\theta\cdot d\varphi\\
 & =\frac{r_{1}r_{2}r_{3}}{3}\int_{0}^{2\pi}\int_{0}^{\pi}\sin\theta\cdot d\theta\cdot d\varphi=\frac{abc}{3}\int_{0}^{2\pi}(-\cos\pi+\cos0)\cdot d\varphi\\
 & =\frac{2}{3}r_{1}r_{2}r_{3}\int_{0}^{2\pi}d\varphi=\frac{4\pi}{3}r_{1}r_{2}r_{3}
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection
Moment m200
\end_layout

\begin_layout Standard
When considering centered ellipsoid aligned with principal axes, the eigen
 values 
\begin_inset Formula $\lambda_{i}$
\end_inset

 simply correspond to the moments 
\begin_inset Formula $\mu_{200}$
\end_inset

, 
\begin_inset Formula $\mu_{020}$
\end_inset

 and 
\begin_inset Formula $\mu_{002}$
\end_inset

.
 Let us focus on the moment 
\begin_inset Formula $\mu_{200}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\mu_{200} & =r_{1}r_{2}r_{3}\int_{0}^{2\pi}\int_{0}^{\pi}\int_{0}^{1}\left(r_{1}\rho\cos\varphi\sin\theta\right)^{2}\rho^{2}\sin\theta\cdot d\rho\cdot d\theta\cdot d\varphi\\
 & =r_{1}^{3}r_{2}r_{3}\int_{0}^{2\pi}\int_{0}^{\pi}\int_{0}^{1}\rho^{4}d\rho\cdot\cos^{2}\varphi\sin^{3}\theta\cdot d\theta\cdot d\varphi\\
 & =\frac{r_{1}^{3}r_{2}r_{3}}{5}\int_{0}^{2\pi}\int_{0}^{\pi}\sin^{3}\theta\cdot d\theta\cdot\cos^{2}\varphi\cdot d\varphi
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The integral over 
\begin_inset Formula $\theta$
\end_inset

 can be developed using the linearisation of 
\begin_inset Formula $\sin^{3}\theta=\frac{3}{4}\sin\theta-\frac{1}{4}\sin\left(3\theta\right)$
\end_inset

:
\begin_inset Formula 
\begin{align*}
\int_{0}^{\pi}\sin^{3}\theta d\theta & =\int_{0}^{\pi}\left(\frac{3}{4}\sin\theta-\frac{1}{4}\sin\left(3\theta\right)\right)d\theta\\
 & =-\frac{3}{4}\left(\cos\pi-\cos0\right)-\frac{-1}{12}\left(\cos3\pi-\cos0\right)\\
 & =\frac{3}{2}-\frac{1}{6}=\frac{4}{3}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Coming back to moment integral:
\begin_inset Formula 
\begin{align*}
\mu_{200} & =\frac{r_{1}^{3}r_{2}r_{3}}{5}\frac{4}{3}\int_{0}^{2\pi}\cos^{2}\varphi\cdot d\varphi==\frac{r_{1}^{3}r_{2}r_{3}}{5}\frac{4}{3}\int_{0}^{2\pi}\frac{1}{2}+\frac{1}{2}\cos\left(2\varphi\right)d\varphi\\
 & =\frac{r_{1}^{3}r_{2}r_{3}}{5}\frac{4}{3}\frac{1}{2}\left(2\pi-0\right)=\frac{4\pi}{3}\frac{r_{1}^{3}r_{2}r_{3}}{5}\\
 & =\frac{r_{1}^{2}}{5}m_{000}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
Then, the central moments are expressed as:
\begin_inset Formula 
\begin{align*}
\lambda_{1}=\mu_{200} & =\frac{r_{1}^{2}}{5}m_{000}\\
\lambda_{2}=\mu_{020} & =\frac{r_{2}^{2}}{5}m_{000}\\
\lambda_{3}=\mu_{002} & =\frac{r_{3}^{2}}{5}m_{000}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
We therefore have 
\begin_inset Formula $\lambda_{i}=\frac{r_{i}^{2}}{5}m_{000}$
\end_inset

, leading to:
\begin_inset Formula 
\begin{align}
r_{i} & =\sqrt{\frac{5\cdot\lambda_{i}}{m_{000}}}
\end{align}

\end_inset


\end_layout

\end_body
\end_document
